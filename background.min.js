!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";var n=[],r=t.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,c={},l=c.toString,h=c.hasOwnProperty,f=h.toString,p=f.call(Object),d={};function y(t,e){var n=(e=e||r).createElement("script");n.text=t,e.head.appendChild(n).parentNode.removeChild(n)}var m="3.2.1",g=function(t,e){return new g.fn.init(t,e)},v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,b=/^-ms-/,w=/-([a-z])/g,_=function(t,e){return e.toUpperCase()};function T(t){var e=!!t&&"length"in t&&t.length,n=g.type(t);return"function"!==n&&!g.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}g.fn=g.prototype={jquery:m,constructor:g,length:0,toArray:function(){return o.call(this)},get:function(t){return null==t?o.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=g.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return g.each(this,t)},map:function(t){return this.pushStack(g.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},g.extend=g.fn.extend=function(){var t,e,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||g.isFunction(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(t=arguments[s]))for(e in t)n=a[e],a!==(r=t[e])&&(c&&r&&(g.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&g.isPlainObject(n)?n:{},a[e]=g.extend(c,o,r)):void 0!==r&&(a[e]=r));return a},g.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===g.type(t)},isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=g.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==l.call(t)||(e=i(t))&&(n=h.call(e,"constructor")&&e.constructor,"function"!=typeof n||f.call(n)!==p))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?c[l.call(t)]||"object":typeof t},globalEval:function(t){y(t)},camelCase:function(t){return t.replace(b,"ms-").replace(w,_)},each:function(t,e){var n,r=0;if(T(t))for(n=t.length;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(v,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(T(Object(t))?g.merge(n,"string"==typeof t?[t]:t):s.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:u.call(e,t,n)},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,o=t.length,a=!n;i<o;i++)!e(t[i],i)!==a&&r.push(t[i]);return r},map:function(t,e,n){var r,i,o=0,s=[];if(T(t))for(r=t.length;o<r;o++)null!=(i=e(t[o],o,n))&&s.push(i);else for(o in t)null!=(i=e(t[o],o,n))&&s.push(i);return a.apply([],s)},guid:1,proxy:function(t,e){var n,r,i;if("string"==typeof e&&(n=t[e],e=t,t=n),g.isFunction(t))return r=o.call(arguments,2),(i=function(){return t.apply(e||this,r.concat(o.call(arguments)))}).guid=t.guid=t.guid||g.guid++,i},now:Date.now,support:d}),"function"==typeof Symbol&&(g.fn[Symbol.iterator]=n[Symbol.iterator]),g.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){c["[object "+e+"]"]=e.toLowerCase()});var E=function(t){var e,n,r,i,o,a,s,u,c,l,h,f,p,d,y,m,g,v,b,w="sizzle"+1*new Date,_=t.document,T=0,E=0,S=at(),C=at(),I=at(),N=function(t,e){return t===e&&(h=!0),0},A={}.hasOwnProperty,k=[],D=k.pop,R=k.push,x=k.push,O=k.slice,P=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},M="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",U="\\["+L+"*("+F+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+L+"*\\]",q=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+U+")*)|.*)\\)|)",V=new RegExp(L+"+","g"),j=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),B=new RegExp("^"+L+"*,"+L+"*"),W=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),K=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),Q=new RegExp(q),H=new RegExp("^"+F+"$"),G={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+M+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},z=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,X=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,Z=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),tt=function(t,e,n){var r="0x"+e-65536;return r!=r||n?e:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},et=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,nt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},rt=function(){f()},it=vt(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{x.apply(k=O.call(_.childNodes),_.childNodes),k[_.childNodes.length].nodeType}catch(t){x={apply:k.length?function(t,e){R.apply(t,O.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}function ot(t,e,r,i){var o,s,c,l,h,d,g,v=e&&e.ownerDocument,T=e?e.nodeType:9;if(r=r||[],"string"!=typeof t||!t||1!==T&&9!==T&&11!==T)return r;if(!i&&((e?e.ownerDocument||e:_)!==p&&f(e),e=e||p,y)){if(11!==T&&(h=J.exec(t)))if(o=h[1]){if(9===T){if(!(c=e.getElementById(o)))return r;if(c.id===o)return r.push(c),r}else if(v&&(c=v.getElementById(o))&&b(e,c)&&c.id===o)return r.push(c),r}else{if(h[2])return x.apply(r,e.getElementsByTagName(t)),r;if((o=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return x.apply(r,e.getElementsByClassName(o)),r}if(n.qsa&&!I[t+" "]&&(!m||!m.test(t))){if(1!==T)v=e,g=t;else if("object"!==e.nodeName.toLowerCase()){for((l=e.getAttribute("id"))?l=l.replace(et,nt):e.setAttribute("id",l=w),s=(d=a(t)).length;s--;)d[s]="#"+l+" "+gt(d[s]);g=d.join(","),v=$.test(t)&&yt(e.parentNode)||e}if(g)try{return x.apply(r,v.querySelectorAll(g)),r}catch(t){}finally{l===w&&e.removeAttribute("id")}}}return u(t.replace(j,"$1"),e,r,i)}function at(){var t=[];return function e(n,i){return t.push(n+" ")>r.cacheLength&&delete e[t.shift()],e[n+" "]=i}}function st(t){return t[w]=!0,t}function ut(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ct(t,e){for(var n=t.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=e}function lt(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ht(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function pt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&it(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function dt(t){return st(function(e){return e=+e,st(function(n,r){for(var i,o=t([],n.length,e),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function yt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=ot.support={},o=ot.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},f=ot.setDocument=function(t){var e,i,a=t?t.ownerDocument||t:_;return a!==p&&9===a.nodeType&&a.documentElement?(d=(p=a).documentElement,y=!o(p),_!==p&&(i=p.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",rt,!1):i.attachEvent&&i.attachEvent("onunload",rt)),n.attributes=ut(function(t){return t.className="i",!t.getAttribute("className")}),n.getElementsByTagName=ut(function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length}),n.getElementsByClassName=X.test(p.getElementsByClassName),n.getById=ut(function(t){return d.appendChild(t).id=w,!p.getElementsByName||!p.getElementsByName(w).length}),n.getById?(r.filter.ID=function(t){var e=t.replace(Z,tt);return function(t){return t.getAttribute("id")===e}},r.find.ID=function(t,e){if(void 0!==e.getElementById&&y){var n=e.getElementById(t);return n?[n]:[]}}):(r.filter.ID=function(t){var e=t.replace(Z,tt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},r.find.ID=function(t,e){if(void 0!==e.getElementById&&y){var n,r,i,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(i=e.getElementsByName(t),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&y)return e.getElementsByClassName(t)},g=[],m=[],(n.qsa=X.test(p.querySelectorAll))&&(ut(function(t){d.appendChild(t).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+L+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+L+"*(?:value|"+M+")"),t.querySelectorAll("[id~="+w+"-]").length||m.push("~="),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]")}),ut(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+L+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),d.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=X.test(v=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ut(function(t){n.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),g.push("!=",q)}),m=m.length&&new RegExp(m.join("|")),g=g.length&&new RegExp(g.join("|")),e=X.test(d.compareDocumentPosition),b=e||X.test(d.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},N=e?function(t,e){if(t===e)return h=!0,0;var r=!t.compareDocumentPosition-!e.compareDocumentPosition;return r||(1&(r=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===r?t===p||t.ownerDocument===_&&b(_,t)?-1:e===p||e.ownerDocument===_&&b(_,e)?1:l?P(l,t)-P(l,e):0:4&r?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,r=0,i=t.parentNode,o=e.parentNode,a=[t],s=[e];if(!i||!o)return t===p?-1:e===p?1:i?-1:o?1:l?P(l,t)-P(l,e):0;if(i===o)return lt(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?lt(a[r],s[r]):a[r]===_?-1:s[r]===_?1:0},p):p},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&f(t),e=e.replace(K,"='$1']"),n.matchesSelector&&y&&!I[e+" "]&&(!g||!g.test(e))&&(!m||!m.test(e)))try{var r=v.call(t,e);if(r||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return r}catch(t){}return ot(e,p,null,[t]).length>0},ot.contains=function(t,e){return(t.ownerDocument||t)!==p&&f(t),b(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!==p&&f(t);var i=r.attrHandle[e.toLowerCase()],o=i&&A.call(r.attrHandle,e.toLowerCase())?i(t,e,!y):void 0;return void 0!==o?o:n.attributes||!y?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},ot.escape=function(t){return(t+"").replace(et,nt)},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,r=[],i=0,o=0;if(h=!n.detectDuplicates,l=!n.sortStable&&t.slice(0),t.sort(N),h){for(;e=t[o++];)e===t[o]&&(i=r.push(o));for(;i--;)t.splice(r[i],1)}return l=null,t},i=ot.getText=function(t){var e,n="",r=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=i(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[r++];)n+=i(e);return n},(r=ot.selectors={cacheLength:50,createPseudo:st,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(Z,tt),t[3]=(t[3]||t[4]||t[5]||"").replace(Z,tt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return G.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&Q.test(n)&&(e=a(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(Z,tt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|"+L+")"+t+"("+L+"|$)"))&&S(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(r){var i=ot.attr(r,t);return null==i?"!="===e:!e||(i+="","="===e?i===n:"!="===e?i!==n:"^="===e?n&&0===i.indexOf(n):"*="===e?n&&i.indexOf(n)>-1:"$="===e?n&&i.slice(-n.length)===n:"~="===e?(" "+i.replace(V," ")+" ").indexOf(n)>-1:"|="===e&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,r,i){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,u){var c,l,h,f,p,d,y=o!==a?"nextSibling":"previousSibling",m=e.parentNode,g=s&&e.nodeName.toLowerCase(),v=!u&&!s,b=!1;if(m){if(o){for(;y;){for(f=e;f=f[y];)if(s?f.nodeName.toLowerCase()===g:1===f.nodeType)return!1;d=y="only"===t&&!d&&"nextSibling"}return!0}if(d=[a?m.firstChild:m.lastChild],a&&v){for(b=(p=(c=(l=(h=(f=m)[w]||(f[w]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]||[])[0]===T&&c[1])&&c[2],f=p&&m.childNodes[p];f=++p&&f&&f[y]||(b=p=0)||d.pop();)if(1===f.nodeType&&++b&&f===e){l[t]=[T,p,b];break}}else if(v&&(b=p=(c=(l=(h=(f=e)[w]||(f[w]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]||[])[0]===T&&c[1]),!1===b)for(;(f=++p&&f&&f[y]||(b=p=0)||d.pop())&&((s?f.nodeName.toLowerCase()!==g:1!==f.nodeType)||!++b||(v&&((l=(h=f[w]||(f[w]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]=[T,b]),f!==e)););return(b-=i)===r||b%r==0&&b/r>=0}}},PSEUDO:function(t,e){var n,i=r.pseudos[t]||r.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return i[w]?i(e):i.length>1?(n=[t,t,"",e],r.setFilters.hasOwnProperty(t.toLowerCase())?st(function(t,n){for(var r,o=i(t,e),a=o.length;a--;)t[r=P(t,o[a])]=!(n[r]=o[a])}):function(t){return i(t,0,n)}):i}},pseudos:{not:st(function(t){var e=[],n=[],r=s(t.replace(j,"$1"));return r[w]?st(function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}}),has:st(function(t){return function(e){return ot(t,e).length>0}}),contains:st(function(t){return t=t.replace(Z,tt),function(e){return(e.textContent||e.innerText||i(e)).indexOf(t)>-1}}),lang:st(function(t){return H.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(Z,tt).toLowerCase(),function(e){var n;do{if(n=y?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===d},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:pt(!1),disabled:pt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!r.pseudos.empty(t)},header:function(t){return Y.test(t.nodeName)},input:function(t){return z.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:dt(function(){return[0]}),last:dt(function(t,e){return[e-1]}),eq:dt(function(t,e,n){return[n<0?n+e:n]}),even:dt(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:dt(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:dt(function(t,e,n){for(var r=n<0?n+e:n;--r>=0;)t.push(r);return t}),gt:dt(function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t})}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[e]=ht(e);for(e in{submit:!0,reset:!0})r.pseudos[e]=ft(e);function mt(){}function gt(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function vt(t,e,n){var r=e.dir,i=e.next,o=i||r,a=n&&"parentNode"===o,s=E++;return e.first?function(e,n,i){for(;e=e[r];)if(1===e.nodeType||a)return t(e,n,i);return!1}:function(e,n,u){var c,l,h,f=[T,s];if(u){for(;e=e[r];)if((1===e.nodeType||a)&&t(e,n,u))return!0}else for(;e=e[r];)if(1===e.nodeType||a)if(l=(h=e[w]||(e[w]={}))[e.uniqueID]||(h[e.uniqueID]={}),i&&i===e.nodeName.toLowerCase())e=e[r]||e;else{if((c=l[o])&&c[0]===T&&c[1]===s)return f[2]=c[2];if(l[o]=f,f[2]=t(e,n,u))return!0}return!1}}function bt(t){return t.length>1?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function wt(t,e,n,r,i){for(var o,a=[],s=0,u=t.length,c=null!=e;s<u;s++)(o=t[s])&&(n&&!n(o,r,i)||(a.push(o),c&&e.push(s)));return a}function _t(t,e,n,r,i,o){return r&&!r[w]&&(r=_t(r)),i&&!i[w]&&(i=_t(i,o)),st(function(o,a,s,u){var c,l,h,f=[],p=[],d=a.length,y=o||function(t,e,n){for(var r=0,i=e.length;r<i;r++)ot(t,e[r],n);return n}(e||"*",s.nodeType?[s]:s,[]),m=!t||!o&&e?y:wt(y,f,t,s,u),g=n?i||(o?t:d||r)?[]:a:m;if(n&&n(m,g,s,u),r)for(c=wt(g,p),r(c,[],s,u),l=c.length;l--;)(h=c[l])&&(g[p[l]]=!(m[p[l]]=h));if(o){if(i||t){if(i){for(c=[],l=g.length;l--;)(h=g[l])&&c.push(m[l]=h);i(null,g=[],c,u)}for(l=g.length;l--;)(h=g[l])&&(c=i?P(o,h):f[l])>-1&&(o[c]=!(a[c]=h))}}else g=wt(g===a?g.splice(d,g.length):g),i?i(null,a,g,u):x.apply(a,g)})}function Tt(t){for(var e,n,i,o=t.length,a=r.relative[t[0].type],s=a||r.relative[" "],u=a?1:0,l=vt(function(t){return t===e},s,!0),h=vt(function(t){return P(e,t)>-1},s,!0),f=[function(t,n,r){var i=!a&&(r||n!==c)||((e=n).nodeType?l(t,n,r):h(t,n,r));return e=null,i}];u<o;u++)if(n=r.relative[t[u].type])f=[vt(bt(f),n)];else{if((n=r.filter[t[u].type].apply(null,t[u].matches))[w]){for(i=++u;i<o&&!r.relative[t[i].type];i++);return _t(u>1&&bt(f),u>1&&gt(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(j,"$1"),n,u<i&&Tt(t.slice(u,i)),i<o&&Tt(t=t.slice(i)),i<o&&gt(t))}f.push(n)}return bt(f)}function Et(t,e){var n=e.length>0,i=t.length>0,o=function(o,a,s,u,l){var h,d,m,g=0,v="0",b=o&&[],w=[],_=c,E=o||i&&r.find.TAG("*",l),S=T+=null==_?1:Math.random()||.1,C=E.length;for(l&&(c=a===p||a||l);v!==C&&null!=(h=E[v]);v++){if(i&&h){for(d=0,a||h.ownerDocument===p||(f(h),s=!y);m=t[d++];)if(m(h,a||p,s)){u.push(h);break}l&&(T=S)}n&&((h=!m&&h)&&g--,o&&b.push(h))}if(g+=v,n&&v!==g){for(d=0;m=e[d++];)m(b,w,a,s);if(o){if(g>0)for(;v--;)b[v]||w[v]||(w[v]=D.call(u));w=wt(w)}x.apply(u,w),l&&!o&&w.length>0&&g+e.length>1&&ot.uniqueSort(u)}return l&&(T=S,c=_),b};return n?st(o):o}return mt.prototype=r.filters=r.pseudos,r.setFilters=new mt,a=ot.tokenize=function(t,e){var n,i,o,a,s,u,c,l=C[t+" "];if(l)return e?0:l.slice(0);for(s=t,u=[],c=r.preFilter;s;){for(a in n&&!(i=B.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=W.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(j," ")}),s=s.slice(n.length)),r.filter)!(i=G[a].exec(s))||c[a]&&!(i=c[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return e?s.length:s?ot.error(t):C(t,u).slice(0)},s=ot.compile=function(t,e){var n,r=[],i=[],o=I[t+" "];if(!o){for(e||(e=a(t)),n=e.length;n--;)(o=Tt(e[n]))[w]?r.push(o):i.push(o);(o=I(t,Et(i,r))).selector=t}return o},u=ot.select=function(t,e,n,i){var o,u,c,l,h,f="function"==typeof t&&t,p=!i&&a(t=f.selector||t);if(n=n||[],1===p.length){if((u=p[0]=p[0].slice(0)).length>2&&"ID"===(c=u[0]).type&&9===e.nodeType&&y&&r.relative[u[1].type]){if(!(e=(r.find.ID(c.matches[0].replace(Z,tt),e)||[])[0]))return n;f&&(e=e.parentNode),t=t.slice(u.shift().value.length)}for(o=G.needsContext.test(t)?0:u.length;o--&&(c=u[o],!r.relative[l=c.type]);)if((h=r.find[l])&&(i=h(c.matches[0].replace(Z,tt),$.test(u[0].type)&&yt(e.parentNode)||e))){if(u.splice(o,1),!(t=i.length&&gt(u)))return x.apply(n,i),n;break}}return(f||s(t,p))(i,e,!y,n,!e||$.test(t)&&yt(e.parentNode)||e),n},n.sortStable=w.split("").sort(N).join("")===w,n.detectDuplicates=!!h,f(),n.sortDetached=ut(function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))}),ut(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ct("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),n.attributes&&ut(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ct("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ut(function(t){return null==t.getAttribute("disabled")})||ct(M,function(t,e,n){var r;if(!n)return!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null}),ot}(t);g.find=E,g.expr=E.selectors,g.expr[":"]=g.expr.pseudos,g.uniqueSort=g.unique=E.uniqueSort,g.text=E.getText,g.isXMLDoc=E.isXML,g.contains=E.contains,g.escapeSelector=E.escape;var S=function(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&g(t).is(n))break;r.push(t)}return r},C=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},I=g.expr.match.needsContext;function N(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,k=/^.[^:#\[\.,]*$/;function D(t,e,n){return g.isFunction(e)?g.grep(t,function(t,r){return!!e.call(t,r,t)!==n}):e.nodeType?g.grep(t,function(t){return t===e!==n}):"string"!=typeof e?g.grep(t,function(t){return u.call(e,t)>-1!==n}):k.test(e)?g.filter(e,t,n):(e=g.filter(e,t),g.grep(t,function(t){return u.call(e,t)>-1!==n&&1===t.nodeType}))}g.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?g.find.matchesSelector(r,t)?[r]:[]:g.find.matches(t,g.grep(e,function(t){return 1===t.nodeType}))},g.fn.extend({find:function(t){var e,n,r=this.length,i=this;if("string"!=typeof t)return this.pushStack(g(t).filter(function(){for(e=0;e<r;e++)if(g.contains(i[e],this))return!0}));for(n=this.pushStack([]),e=0;e<r;e++)g.find(t,i[e],n);return r>1?g.uniqueSort(n):n},filter:function(t){return this.pushStack(D(this,t||[],!1))},not:function(t){return this.pushStack(D(this,t||[],!0))},is:function(t){return!!D(this,"string"==typeof t&&I.test(t)?g(t):t||[],!1).length}});var R,x=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(g.fn.init=function(t,e,n){var i,o;if(!t)return this;if(n=n||R,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:x.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof g?e[0]:e,g.merge(this,g.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:r,!0)),A.test(i[1])&&g.isPlainObject(e))for(i in e)g.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(o=r.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):g.isFunction(t)?void 0!==n.ready?n.ready(t):t(g):g.makeArray(t,this)}).prototype=g.fn,R=g(r);var O=/^(?:parents|prev(?:Until|All))/,P={children:!0,contents:!0,next:!0,prev:!0};function M(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}g.fn.extend({has:function(t){var e=g(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(g.contains(this,e[t]))return!0})},closest:function(t,e){var n,r=0,i=this.length,o=[],a="string"!=typeof t&&g(t);if(!I.test(t))for(;r<i;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&g.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?g.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?u.call(g(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(g.uniqueSort(g.merge(this.get(),g(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),g.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return S(t,"parentNode")},parentsUntil:function(t,e,n){return S(t,"parentNode",n)},next:function(t){return M(t,"nextSibling")},prev:function(t){return M(t,"previousSibling")},nextAll:function(t){return S(t,"nextSibling")},prevAll:function(t){return S(t,"previousSibling")},nextUntil:function(t,e,n){return S(t,"nextSibling",n)},prevUntil:function(t,e,n){return S(t,"previousSibling",n)},siblings:function(t){return C((t.parentNode||{}).firstChild,t)},children:function(t){return C(t.firstChild)},contents:function(t){return N(t,"iframe")?t.contentDocument:(N(t,"template")&&(t=t.content||t),g.merge([],t.childNodes))}},function(t,e){g.fn[t]=function(n,r){var i=g.map(this,e,n);return"Until"!==t.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=g.filter(r,i)),this.length>1&&(P[t]||g.uniqueSort(i),O.test(t)&&i.reverse()),this.pushStack(i)}});var L=/[^\x20\t\r\n\f]+/g;function F(t){return t}function U(t){throw t}function q(t,e,n,r){var i;try{t&&g.isFunction(i=t.promise)?i.call(t).done(e).fail(n):t&&g.isFunction(i=t.then)?i.call(t,e,n):e.apply(void 0,[t].slice(r))}catch(t){n.apply(void 0,[t])}}g.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return g.each(t.match(L)||[],function(t,n){e[n]=!0}),e}(t):g.extend({},t);var e,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||t.once,r=e=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&t.stopOnFalse&&(s=o.length,n=!1);t.memory||(n=!1),e=!1,i&&(o=n?[]:"")},c={add:function(){return o&&(n&&!e&&(s=o.length-1,a.push(n)),function e(n){g.each(n,function(n,r){g.isFunction(r)?t.unique&&c.has(r)||o.push(r):r&&r.length&&"string"!==g.type(r)&&e(r)})}(arguments),n&&!e&&u()),this},remove:function(){return g.each(arguments,function(t,e){for(var n;(n=g.inArray(e,o,n))>-1;)o.splice(n,1),n<=s&&s--}),this},has:function(t){return t?g.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||e||(o=n=""),this},locked:function(){return!!i},fireWith:function(t,n){return i||(n=[t,(n=n||[]).slice?n.slice():n],a.push(n),e||u()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},g.extend({Deferred:function(e){var n=[["notify","progress",g.Callbacks("memory"),g.Callbacks("memory"),2],["resolve","done",g.Callbacks("once memory"),g.Callbacks("once memory"),0,"resolved"],["reject","fail",g.Callbacks("once memory"),g.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return i.then(null,t)},pipe:function(){var t=arguments;return g.Deferred(function(e){g.each(n,function(n,r){var i=g.isFunction(t[r[4]])&&t[r[4]];o[r[1]](function(){var t=i&&i.apply(this,arguments);t&&g.isFunction(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[r[0]+"With"](this,i?[t]:arguments)})}),t=null}).promise()},then:function(e,r,i){var o=0;function a(e,n,r,i){return function(){var s=this,u=arguments,c=function(){var t,c;if(!(e<o)){if((t=r.apply(s,u))===n.promise())throw new TypeError("Thenable self-resolution");c=t&&("object"==typeof t||"function"==typeof t)&&t.then,g.isFunction(c)?i?c.call(t,a(o,n,F,i),a(o,n,U,i)):(o++,c.call(t,a(o,n,F,i),a(o,n,U,i),a(o,n,F,n.notifyWith))):(r!==F&&(s=void 0,u=[t]),(i||n.resolveWith)(s,u))}},l=i?c:function(){try{c()}catch(t){g.Deferred.exceptionHook&&g.Deferred.exceptionHook(t,l.stackTrace),e+1>=o&&(r!==U&&(s=void 0,u=[t]),n.rejectWith(s,u))}};e?l():(g.Deferred.getStackHook&&(l.stackTrace=g.Deferred.getStackHook()),t.setTimeout(l))}}return g.Deferred(function(t){n[0][3].add(a(0,t,g.isFunction(i)?i:F,t.notifyWith)),n[1][3].add(a(0,t,g.isFunction(e)?e:F)),n[2][3].add(a(0,t,g.isFunction(r)?r:U))}).promise()},promise:function(t){return null!=t?g.extend(t,i):i}},o={};return g.each(n,function(t,e){var a=e[2],s=e[5];i[e[1]]=a.add,s&&a.add(function(){r=s},n[3-t][2].disable,n[0][2].lock),a.add(e[3].fire),o[e[0]]=function(){return o[e[0]+"With"](this===o?void 0:this,arguments),this},o[e[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(t){var e=arguments.length,n=e,r=Array(n),i=o.call(arguments),a=g.Deferred(),s=function(t){return function(n){r[t]=this,i[t]=arguments.length>1?o.call(arguments):n,--e||a.resolveWith(r,i)}};if(e<=1&&(q(t,a.done(s(n)).resolve,a.reject,!e),"pending"===a.state()||g.isFunction(i[n]&&i[n].then)))return a.then();for(;n--;)q(i[n],s(n),a.reject);return a.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;g.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&V.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},g.readyException=function(e){t.setTimeout(function(){throw e})};var j=g.Deferred();function B(){r.removeEventListener("DOMContentLoaded",B),t.removeEventListener("load",B),g.ready()}g.fn.ready=function(t){return j.then(t).catch(function(t){g.readyException(t)}),this},g.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--g.readyWait:g.isReady)||(g.isReady=!0,!0!==t&&--g.readyWait>0||j.resolveWith(r,[g]))}}),g.ready.then=j.then,"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll?t.setTimeout(g.ready):(r.addEventListener("DOMContentLoaded",B),t.addEventListener("load",B));var W=function(t,e,n,r,i,o,a){var s=0,u=t.length,c=null==n;if("object"===g.type(n))for(s in i=!0,n)W(t,e,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,g.isFunction(r)||(a=!0),c&&(a?(e.call(t,r),e=null):(c=e,e=function(t,e,n){return c.call(g(t),n)})),e))for(;s<u;s++)e(t[s],n,a?r:r.call(t[s],s,e(t[s],n)));return i?t:c?e.call(t):u?e(t[0],n):o},K=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function Q(){this.expando=g.expando+Q.uid++}Q.uid=1,Q.prototype={cache:function(t){var e=t[this.expando];return e||(e={},K(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var r,i=this.cache(t);if("string"==typeof e)i[g.camelCase(e)]=n;else for(r in e)i[g.camelCase(r)]=e[r];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][g.camelCase(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r=t[this.expando];if(void 0!==r){if(void 0!==e){Array.isArray(e)?e=e.map(g.camelCase):e=(e=g.camelCase(e))in r?[e]:e.match(L)||[],n=e.length;for(;n--;)delete r[e[n]]}(void 0===e||g.isEmptyObject(r))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!g.isEmptyObject(e)}};var H=new Q,G=new Q,z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Y=/[A-Z]/g;function X(t,e,n){var r;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(Y,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:z.test(t)?JSON.parse(t):t)}(n)}catch(t){}G.set(t,e,n)}else n=void 0;return n}g.extend({hasData:function(t){return G.hasData(t)||H.hasData(t)},data:function(t,e,n){return G.access(t,e,n)},removeData:function(t,e){G.remove(t,e)},_data:function(t,e,n){return H.access(t,e,n)},_removeData:function(t,e){H.remove(t,e)}}),g.fn.extend({data:function(t,e){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(i=G.get(o),1===o.nodeType&&!H.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(0===(r=a[n].name).indexOf("data-")&&(r=g.camelCase(r.slice(5)),X(o,r,i[r])));H.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each(function(){G.set(this,t)}):W(this,function(e){var n;if(o&&void 0===e){if(void 0!==(n=G.get(o,t)))return n;if(void 0!==(n=X(o,t)))return n}else this.each(function(){G.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){G.remove(this,t)})}}),g.extend({queue:function(t,e,n){var r;if(t)return e=(e||"fx")+"queue",r=H.get(t,e),n&&(!r||Array.isArray(n)?r=H.access(t,e,g.makeArray(n)):r.push(n)),r||[]},dequeue:function(t,e){e=e||"fx";var n=g.queue(t,e),r=n.length,i=n.shift(),o=g._queueHooks(t,e);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,function(){g.dequeue(t,e)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return H.get(t,n)||H.access(t,n,{empty:g.Callbacks("once memory").add(function(){H.remove(t,[e+"queue",n])})})}}),g.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?g.queue(this[0],t):void 0===e?this:this.each(function(){var n=g.queue(this,t,e);g._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&g.dequeue(this,t)})},dequeue:function(t){return this.each(function(){g.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,r=1,i=g.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=H.get(o[a],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(e)}});var J=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,$=new RegExp("^(?:([+-])=|)("+J+")([a-z%]*)$","i"),Z=["Top","Right","Bottom","Left"],tt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&g.contains(t.ownerDocument,t)&&"none"===g.css(t,"display")},et=function(t,e,n,r){var i,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];for(o in i=n.apply(t,r||[]),e)t.style[o]=a[o];return i};function nt(t,e,n,r){var i,o=1,a=20,s=r?function(){return r.cur()}:function(){return g.css(t,e,"")},u=s(),c=n&&n[3]||(g.cssNumber[e]?"":"px"),l=(g.cssNumber[e]||"px"!==c&&+u)&&$.exec(g.css(t,e));if(l&&l[3]!==c){c=c||l[3],n=n||[],l=+u||1;do{l/=o=o||".5",g.style(t,e,l+c)}while(o!==(o=s()/u)&&1!==o&&--a)}return n&&(l=+l||+u||0,i=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=c,r.start=l,r.end=i)),i}var rt={};function it(t){var e,n=t.ownerDocument,r=t.nodeName,i=rt[r];return i||(e=n.body.appendChild(n.createElement(r)),i=g.css(e,"display"),e.parentNode.removeChild(e),"none"===i&&(i="block"),rt[r]=i,i)}function ot(t,e){for(var n,r,i=[],o=0,a=t.length;o<a;o++)(r=t[o]).style&&(n=r.style.display,e?("none"===n&&(i[o]=H.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&tt(r)&&(i[o]=it(r))):"none"!==n&&(i[o]="none",H.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(t[o].style.display=i[o]);return t}g.fn.extend({show:function(){return ot(this,!0)},hide:function(){return ot(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){tt(this)?g(this).show():g(this).hide()})}});var at=/^(?:checkbox|radio)$/i,st=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ut=/^$|\/(?:java|ecma)script/i,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function lt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&N(t,e)?g.merge([t],n):n}function ht(t,e){for(var n=0,r=t.length;n<r;n++)H.set(t[n],"globalEval",!e||H.get(e[n],"globalEval"))}ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td;var ft=/<|&#?\w+;/;function pt(t,e,n,r,i){for(var o,a,s,u,c,l,h=e.createDocumentFragment(),f=[],p=0,d=t.length;p<d;p++)if((o=t[p])||0===o)if("object"===g.type(o))g.merge(f,o.nodeType?[o]:o);else if(ft.test(o)){for(a=a||h.appendChild(e.createElement("div")),s=(st.exec(o)||["",""])[1].toLowerCase(),u=ct[s]||ct._default,a.innerHTML=u[1]+g.htmlPrefilter(o)+u[2],l=u[0];l--;)a=a.lastChild;g.merge(f,a.childNodes),(a=h.firstChild).textContent=""}else f.push(e.createTextNode(o));for(h.textContent="",p=0;o=f[p++];)if(r&&g.inArray(o,r)>-1)i&&i.push(o);else if(c=g.contains(o.ownerDocument,o),a=lt(h.appendChild(o),"script"),c&&ht(a),n)for(l=0;o=a[l++];)ut.test(o.type||"")&&n.push(o);return h}!function(){var t=r.createDocumentFragment().appendChild(r.createElement("div")),e=r.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),d.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",d.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var dt=r.documentElement,yt=/^key/,mt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,gt=/^([^.]*)(?:\.(.+)|)/;function vt(){return!0}function bt(){return!1}function wt(){try{return r.activeElement}catch(t){}}function _t(t,e,n,r,i,o){var a,s;if("object"==typeof e){for(s in"string"!=typeof n&&(r=r||n,n=void 0),e)_t(t,s,n,r,e[s],o);return t}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=bt;else if(!i)return t;return 1===o&&(a=i,(i=function(t){return g().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=g.guid++)),t.each(function(){g.event.add(this,e,i,r,n)})}g.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,c,l,h,f,p,d,y,m=H.get(t);if(m)for(n.handler&&(n=(o=n).handler,i=o.selector),i&&g.find.matchesSelector(dt,i),n.guid||(n.guid=g.guid++),(u=m.events)||(u=m.events={}),(a=m.handle)||(a=m.handle=function(e){return void 0!==g&&g.event.triggered!==e.type?g.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(L)||[""]).length;c--;)p=y=(s=gt.exec(e[c])||[])[1],d=(s[2]||"").split(".").sort(),p&&(h=g.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,h=g.event.special[p]||{},l=g.extend({type:p,origType:y,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&g.expr.match.needsContext.test(i),namespace:d.join(".")},o),(f=u[p])||((f=u[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,r,d,a)||t.addEventListener&&t.addEventListener(p,a)),h.add&&(h.add.call(t,l),l.handler.guid||(l.handler.guid=n.guid)),i?f.splice(f.delegateCount++,0,l):f.push(l),g.event.global[p]=!0)},remove:function(t,e,n,r,i){var o,a,s,u,c,l,h,f,p,d,y,m=H.hasData(t)&&H.get(t);if(m&&(u=m.events)){for(c=(e=(e||"").match(L)||[""]).length;c--;)if(p=y=(s=gt.exec(e[c])||[])[1],d=(s[2]||"").split(".").sort(),p){for(h=g.event.special[p]||{},f=u[p=(r?h.delegateType:h.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)l=f[o],!i&&y!==l.origType||n&&n.guid!==l.guid||s&&!s.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(f.splice(o,1),l.selector&&f.delegateCount--,h.remove&&h.remove.call(t,l));a&&!f.length&&(h.teardown&&!1!==h.teardown.call(t,d,m.handle)||g.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)g.event.remove(t,p+e[c],n,r,!0);g.isEmptyObject(u)&&H.remove(t,"handle events")}},dispatch:function(t){var e,n,r,i,o,a,s=g.event.fix(t),u=new Array(arguments.length),c=(H.get(this,"events")||{})[s.type]||[],l=g.event.special[s.type]||{};for(u[0]=s,e=1;e<arguments.length;e++)u[e]=arguments[e];if(s.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,s)){for(a=g.event.handlers.call(this,s,c),e=0;(i=a[e++])&&!s.isPropagationStopped();)for(s.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(o.namespace)||(s.handleObj=o,s.data=o.data,void 0!==(r=((g.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,u))&&!1===(s.result=r)&&(s.preventDefault(),s.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,s),s.result}},handlers:function(t,e){var n,r,i,o,a,s=[],u=e.delegateCount,c=t.target;if(u&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=e[n]).selector+" "]&&(a[i]=r.needsContext?g(i,this).index(c)>-1:g.find(i,this,null,[c]).length),a[i]&&o.push(r);o.length&&s.push({elem:c,handlers:o})}return c=this,u<e.length&&s.push({elem:c,handlers:e.slice(u)}),s},addProp:function(t,e){Object.defineProperty(g.Event.prototype,t,{enumerable:!0,configurable:!0,get:g.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[g.expando]?t:new g.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==wt()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===wt()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&N(this,"input"))return this.click(),!1},_default:function(t){return N(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},g.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},g.Event=function(t,e){return this instanceof g.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?vt:bt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&g.extend(this,e),this.timeStamp=t&&t.timeStamp||g.now(),void(this[g.expando]=!0)):new g.Event(t,e)},g.Event.prototype={constructor:g.Event,isDefaultPrevented:bt,isPropagationStopped:bt,isImmediatePropagationStopped:bt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=vt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=vt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=vt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},g.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&yt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&mt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},g.event.addProp),g.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){g.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=t.relatedTarget,i=t.handleObj;return r&&(r===this||g.contains(this,r))||(t.type=i.origType,n=i.handler.apply(this,arguments),t.type=e),n}}}),g.fn.extend({on:function(t,e,n,r){return _t(this,t,e,n,r)},one:function(t,e,n,r){return _t(this,t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,g(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=bt),this.each(function(){g.event.remove(this,t,n,e)})}});var Tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Et=/<script|<style|<link/i,St=/checked\s*(?:[^=]|=\s*.checked.)/i,Ct=/^true\/(.*)/,It=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Nt(t,e){return N(t,"table")&&N(11!==e.nodeType?e:e.firstChild,"tr")&&g(">tbody",t)[0]||t}function At(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function kt(t){var e=Ct.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function Dt(t,e){var n,r,i,o,a,s,u,c;if(1===e.nodeType){if(H.hasData(t)&&(o=H.access(t),a=H.set(e,o),c=o.events))for(i in delete a.handle,a.events={},c)for(n=0,r=c[i].length;n<r;n++)g.event.add(e,i,c[i][n]);G.hasData(t)&&(s=G.access(t),u=g.extend({},s),G.set(e,u))}}function Rt(t,e){var n=e.nodeName.toLowerCase();"input"===n&&at.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function xt(t,e,n,r){e=a.apply([],e);var i,o,s,u,c,l,h=0,f=t.length,p=f-1,m=e[0],v=g.isFunction(m);if(v||f>1&&"string"==typeof m&&!d.checkClone&&St.test(m))return t.each(function(i){var o=t.eq(i);v&&(e[0]=m.call(this,i,o.html())),xt(o,e,n,r)});if(f&&(o=(i=pt(e,t[0].ownerDocument,!1,t,r)).firstChild,1===i.childNodes.length&&(i=o),o||r)){for(u=(s=g.map(lt(i,"script"),At)).length;h<f;h++)c=i,h!==p&&(c=g.clone(c,!0,!0),u&&g.merge(s,lt(c,"script"))),n.call(t[h],c,h);if(u)for(l=s[s.length-1].ownerDocument,g.map(s,kt),h=0;h<u;h++)c=s[h],ut.test(c.type||"")&&!H.access(c,"globalEval")&&g.contains(l,c)&&(c.src?g._evalUrl&&g._evalUrl(c.src):y(c.textContent.replace(It,""),l))}return t}function Ot(t,e,n){for(var r,i=e?g.filter(e,t):t,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||g.cleanData(lt(r)),r.parentNode&&(n&&g.contains(r.ownerDocument,r)&&ht(lt(r,"script")),r.parentNode.removeChild(r));return t}g.extend({htmlPrefilter:function(t){return t.replace(Tt,"<$1></$2>")},clone:function(t,e,n){var r,i,o,a,s=t.cloneNode(!0),u=g.contains(t.ownerDocument,t);if(!(d.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||g.isXMLDoc(t)))for(a=lt(s),r=0,i=(o=lt(t)).length;r<i;r++)Rt(o[r],a[r]);if(e)if(n)for(o=o||lt(t),a=a||lt(s),r=0,i=o.length;r<i;r++)Dt(o[r],a[r]);else Dt(t,s);return(a=lt(s,"script")).length>0&&ht(a,!u&&lt(t,"script")),s},cleanData:function(t){for(var e,n,r,i=g.event.special,o=0;void 0!==(n=t[o]);o++)if(K(n)){if(e=n[H.expando]){if(e.events)for(r in e.events)i[r]?g.event.remove(n,r):g.removeEvent(n,r,e.handle);n[H.expando]=void 0}n[G.expando]&&(n[G.expando]=void 0)}}}),g.fn.extend({detach:function(t){return Ot(this,t,!0)},remove:function(t){return Ot(this,t)},text:function(t){return W(this,function(t){return void 0===t?g.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return xt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Nt(this,t).appendChild(t)})},prepend:function(){return xt(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Nt(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return xt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return xt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(g.cleanData(lt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return g.clone(this,t,e)})},html:function(t){return W(this,function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Et.test(t)&&!ct[(st.exec(t)||["",""])[1].toLowerCase()]){t=g.htmlPrefilter(t);try{for(;n<r;n++)1===(e=this[n]||{}).nodeType&&(g.cleanData(lt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return xt(this,arguments,function(e){var n=this.parentNode;g.inArray(this,t)<0&&(g.cleanData(lt(this)),n&&n.replaceChild(e,this))},t)}}),g.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){g.fn[t]=function(t){for(var n,r=[],i=g(t),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),g(i[a])[e](n),s.apply(r,n.get());return this.pushStack(r)}});var Pt=/^margin/,Mt=new RegExp("^("+J+")(?!px)[a-z%]+$","i"),Lt=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)};function Ft(t,e,n){var r,i,o,a,s=t.style;return(n=n||Lt(t))&&(""!==(a=n.getPropertyValue(e)||n[e])||g.contains(t.ownerDocument,t)||(a=g.style(t,e)),!d.pixelMarginRight()&&Mt.test(a)&&Pt.test(e)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Ut(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}!function(){function e(){if(u){u.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",u.innerHTML="",dt.appendChild(s);var e=t.getComputedStyle(u);n="1%"!==e.top,a="2px"===e.marginLeft,i="4px"===e.width,u.style.marginRight="50%",o="4px"===e.marginRight,dt.removeChild(s),u=null}}var n,i,o,a,s=r.createElement("div"),u=r.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",d.clearCloneStyle="content-box"===u.style.backgroundClip,s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",s.appendChild(u),g.extend(d,{pixelPosition:function(){return e(),n},boxSizingReliable:function(){return e(),i},pixelMarginRight:function(){return e(),o},reliableMarginLeft:function(){return e(),a}}))}();var qt=/^(none|table(?!-c[ea]).+)/,Vt=/^--/,jt={position:"absolute",visibility:"hidden",display:"block"},Bt={letterSpacing:"0",fontWeight:"400"},Wt=["Webkit","Moz","ms"],Kt=r.createElement("div").style;function Qt(t){var e=g.cssProps[t];return e||(e=g.cssProps[t]=function(t){if(t in Kt)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=Wt.length;n--;)if((t=Wt[n]+e)in Kt)return t}(t)||t),e}function Ht(t,e,n){var r=$.exec(e);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):e}function Gt(t,e,n,r,i){var o,a=0;for(o=n===(r?"border":"content")?4:"width"===e?1:0;o<4;o+=2)"margin"===n&&(a+=g.css(t,n+Z[o],!0,i)),r?("content"===n&&(a-=g.css(t,"padding"+Z[o],!0,i)),"margin"!==n&&(a-=g.css(t,"border"+Z[o]+"Width",!0,i))):(a+=g.css(t,"padding"+Z[o],!0,i),"padding"!==n&&(a+=g.css(t,"border"+Z[o]+"Width",!0,i)));return a}function zt(t,e,n){var r,i=Lt(t),o=Ft(t,e,i),a="border-box"===g.css(t,"boxSizing",!1,i);return Mt.test(o)?o:(r=a&&(d.boxSizingReliable()||o===t.style[e]),"auto"===o&&(o=t["offset"+e[0].toUpperCase()+e.slice(1)]),(o=parseFloat(o)||0)+Gt(t,e,n||(a?"border":"content"),r,i)+"px")}function Yt(t,e,n,r,i){return new Yt.prototype.init(t,e,n,r,i)}g.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Ft(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,o,a,s=g.camelCase(e),u=Vt.test(e),c=t.style;return u||(e=Qt(s)),a=g.cssHooks[e]||g.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(i=a.get(t,!1,r))?i:c[e]:("string"===(o=typeof n)&&(i=$.exec(n))&&i[1]&&(n=nt(t,e,i),o="number"),void(null!=n&&n==n&&("number"===o&&(n+=i&&i[3]||(g.cssNumber[s]?"":"px")),d.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,r))||(u?c.setProperty(e,n):c[e]=n))))}},css:function(t,e,n,r){var i,o,a,s=g.camelCase(e);return Vt.test(e)||(e=Qt(s)),(a=g.cssHooks[e]||g.cssHooks[s])&&"get"in a&&(i=a.get(t,!0,n)),void 0===i&&(i=Ft(t,e,r)),"normal"===i&&e in Bt&&(i=Bt[e]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),g.each(["height","width"],function(t,e){g.cssHooks[e]={get:function(t,n,r){if(n)return!qt.test(g.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?zt(t,e,r):et(t,jt,function(){return zt(t,e,r)})},set:function(t,n,r){var i,o=r&&Lt(t),a=r&&Gt(t,e,r,"border-box"===g.css(t,"boxSizing",!1,o),o);return a&&(i=$.exec(n))&&"px"!==(i[3]||"px")&&(t.style[e]=n,n=g.css(t,e)),Ht(0,n,a)}}}),g.cssHooks.marginLeft=Ut(d.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Ft(t,"marginLeft"))||t.getBoundingClientRect().left-et(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),g.each({margin:"",padding:"",border:"Width"},function(t,e){g.cssHooks[t+e]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[t+Z[r]+e]=o[r]||o[r-2]||o[0];return i}},Pt.test(t)||(g.cssHooks[t+e].set=Ht)}),g.fn.extend({css:function(t,e){return W(this,function(t,e,n){var r,i,o={},a=0;if(Array.isArray(e)){for(r=Lt(t),i=e.length;a<i;a++)o[e[a]]=g.css(t,e[a],!1,r);return o}return void 0!==n?g.style(t,e,n):g.css(t,e)},t,e,arguments.length>1)}}),g.Tween=Yt,Yt.prototype={constructor:Yt,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||g.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(g.cssNumber[n]?"":"px")},cur:function(){var t=Yt.propHooks[this.prop];return t&&t.get?t.get(this):Yt.propHooks._default.get(this)},run:function(t){var e,n=Yt.propHooks[this.prop];return this.options.duration?this.pos=e=g.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yt.propHooks._default.set(this),this}},Yt.prototype.init.prototype=Yt.prototype,Yt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=g.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){g.fx.step[t.prop]?g.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[g.cssProps[t.prop]]&&!g.cssHooks[t.prop]?t.elem[t.prop]=t.now:g.style(t.elem,t.prop,t.now+t.unit)}}},Yt.propHooks.scrollTop=Yt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},g.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},g.fx=Yt.prototype.init,g.fx.step={};var Xt,Jt,$t=/^(?:toggle|show|hide)$/,Zt=/queueHooks$/;function te(){Jt&&(!1===r.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(te):t.setTimeout(te,g.fx.interval),g.fx.tick())}function ee(){return t.setTimeout(function(){Xt=void 0}),Xt=g.now()}function ne(t,e){var n,r=0,i={height:t};for(e=e?1:0;r<4;r+=2-e)i["margin"+(n=Z[r])]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function re(t,e,n){for(var r,i=(ie.tweeners[e]||[]).concat(ie.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,e,t))return r}function ie(t,e,n){var r,i,o=0,a=ie.prefilters.length,s=g.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var e=Xt||ee(),n=Math.max(0,c.startTime+c.duration-e),r=1-(n/c.duration||0),o=0,a=c.tweens.length;o<a;o++)c.tweens[o].run(r);return s.notifyWith(t,[c,r,n]),r<1&&a?n:(a||s.notifyWith(t,[c,1,0]),s.resolveWith(t,[c]),!1)},c=s.promise({elem:t,props:g.extend({},e),opts:g.extend(!0,{specialEasing:{},easing:g.easing._default},n),originalProperties:e,originalOptions:n,startTime:Xt||ee(),duration:n.duration,tweens:[],createTween:function(e,n){var r=g.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(r),r},stop:function(e){var n=0,r=e?c.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)c.tweens[n].run(1);return e?(s.notifyWith(t,[c,1,0]),s.resolveWith(t,[c,e])):s.rejectWith(t,[c,e]),this}}),l=c.props;for(function(t,e){var n,r,i,o,a;for(n in t)if(i=e[r=g.camelCase(n)],o=t[n],Array.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),(a=g.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete t[r],o)n in t||(t[n]=o[n],e[n]=i);else e[r]=i}(l,c.opts.specialEasing);o<a;o++)if(r=ie.prefilters[o].call(c,t,l,c.opts))return g.isFunction(r.stop)&&(g._queueHooks(c.elem,c.opts.queue).stop=g.proxy(r.stop,r)),r;return g.map(l,re,c),g.isFunction(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),g.fx.timer(g.extend(u,{elem:t,anim:c,queue:c.opts.queue})),c}g.Animation=g.extend(ie,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return nt(n.elem,t,$.exec(e),n),n}]},tweener:function(t,e){g.isFunction(t)?(e=t,t=["*"]):t=t.match(L);for(var n,r=0,i=t.length;r<i;r++)n=t[r],ie.tweeners[n]=ie.tweeners[n]||[],ie.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var r,i,o,a,s,u,c,l,h="width"in e||"height"in e,f=this,p={},d=t.style,y=t.nodeType&&tt(t),m=H.get(t,"fxshow");for(r in n.queue||(null==(a=g._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,f.always(function(){f.always(function(){a.unqueued--,g.queue(t,"fx").length||a.empty.fire()})})),e)if(i=e[r],$t.test(i)){if(delete e[r],o=o||"toggle"===i,i===(y?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;y=!0}p[r]=m&&m[r]||g.style(t,r)}if((u=!g.isEmptyObject(e))||!g.isEmptyObject(p))for(r in h&&1===t.nodeType&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],null==(c=m&&m.display)&&(c=H.get(t,"display")),"none"===(l=g.css(t,"display"))&&(c?l=c:(ot([t],!0),c=t.style.display||c,l=g.css(t,"display"),ot([t]))),("inline"===l||"inline-block"===l&&null!=c)&&"none"===g.css(t,"float")&&(u||(f.done(function(){d.display=c}),null==c&&(l=d.display,c="none"===l?"":l)),d.display="inline-block")),n.overflow&&(d.overflow="hidden",f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]})),u=!1,p)u||(m?"hidden"in m&&(y=m.hidden):m=H.access(t,"fxshow",{display:c}),o&&(m.hidden=!y),y&&ot([t],!0),f.done(function(){for(r in y||ot([t]),H.remove(t,"fxshow"),p)g.style(t,r,p[r])})),u=re(y?m[r]:0,r,f),r in m||(m[r]=u.start,y&&(u.end=u.start,u.start=0))}],prefilter:function(t,e){e?ie.prefilters.unshift(t):ie.prefilters.push(t)}}),g.speed=function(t,e,n){var r=t&&"object"==typeof t?g.extend({},t):{complete:n||!n&&e||g.isFunction(t)&&t,duration:t,easing:n&&e||e&&!g.isFunction(e)&&e};return g.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in g.fx.speeds?r.duration=g.fx.speeds[r.duration]:r.duration=g.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){g.isFunction(r.old)&&r.old.call(this),r.queue&&g.dequeue(this,r.queue)},r},g.fn.extend({fadeTo:function(t,e,n,r){return this.filter(tt).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){var i=g.isEmptyObject(t),o=g.speed(e,n,r),a=function(){var e=ie(this,g.extend({},t),o);(i||H.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",o=g.timers,a=H.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&Zt.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1));!e&&n||g.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=H.get(this),r=n[t+"queue"],i=n[t+"queueHooks"],o=g.timers,a=r?r.length:0;for(n.finish=!0,g.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete n.finish})}}),g.each(["toggle","show","hide"],function(t,e){var n=g.fn[e];g.fn[e]=function(t,r,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(ne(e,!0),t,r,i)}}),g.each({slideDown:ne("show"),slideUp:ne("hide"),slideToggle:ne("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){g.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}}),g.timers=[],g.fx.tick=function(){var t,e=0,n=g.timers;for(Xt=g.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||g.fx.stop(),Xt=void 0},g.fx.timer=function(t){g.timers.push(t),g.fx.start()},g.fx.interval=13,g.fx.start=function(){Jt||(Jt=!0,te())},g.fx.stop=function(){Jt=null},g.fx.speeds={slow:600,fast:200,_default:400},g.fn.delay=function(e,n){return e=g.fx&&g.fx.speeds[e]||e,n=n||"fx",this.queue(n,function(n,r){var i=t.setTimeout(n,e);r.stop=function(){t.clearTimeout(i)}})},function(){var t=r.createElement("input"),e=r.createElement("select").appendChild(r.createElement("option"));t.type="checkbox",d.checkOn=""!==t.value,d.optSelected=e.selected,(t=r.createElement("input")).value="t",t.type="radio",d.radioValue="t"===t.value}();var oe,ae=g.expr.attrHandle;g.fn.extend({attr:function(t,e){return W(this,g.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){g.removeAttr(this,t)})}}),g.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?g.prop(t,e,n):(1===o&&g.isXMLDoc(t)||(i=g.attrHooks[e.toLowerCase()]||(g.expr.match.bool.test(e)?oe:void 0)),void 0!==n?null===n?void g.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):i&&"get"in i&&null!==(r=i.get(t,e))?r:null==(r=g.find.attr(t,e))?void 0:r)},attrHooks:{type:{set:function(t,e){if(!d.radioValue&&"radio"===e&&N(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,r=0,i=e&&e.match(L);if(i&&1===t.nodeType)for(;n=i[r++];)t.removeAttribute(n)}}),oe={set:function(t,e,n){return!1===e?g.removeAttr(t,n):t.setAttribute(n,n),n}},g.each(g.expr.match.bool.source.match(/\w+/g),function(t,e){var n=ae[e]||g.find.attr;ae[e]=function(t,e,r){var i,o,a=e.toLowerCase();return r||(o=ae[a],ae[a]=i,i=null!=n(t,e,r)?a:null,ae[a]=o),i}});var se=/^(?:input|select|textarea|button)$/i,ue=/^(?:a|area)$/i;function ce(t){return(t.match(L)||[]).join(" ")}function le(t){return t.getAttribute&&t.getAttribute("class")||""}g.fn.extend({prop:function(t,e){return W(this,g.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[g.propFix[t]||t]})}}),g.extend({prop:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&g.isXMLDoc(t)||(e=g.propFix[e]||e,i=g.propHooks[e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=g.find.attr(t,"tabindex");return e?parseInt(e,10):se.test(t.nodeName)||ue.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),d.optSelected||(g.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),g.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){g.propFix[this.toLowerCase()]=this}),g.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(g.isFunction(t))return this.each(function(e){g(this).addClass(t.call(this,e,le(this)))});if("string"==typeof t&&t)for(e=t.match(L)||[];n=this[u++];)if(i=le(n),r=1===n.nodeType&&" "+ce(i)+" "){for(a=0;o=e[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ce(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(g.isFunction(t))return this.each(function(e){g(this).removeClass(t.call(this,e,le(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(L)||[];n=this[u++];)if(i=le(n),r=1===n.nodeType&&" "+ce(i)+" "){for(a=0;o=e[a++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");i!==(s=ce(r))&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):g.isFunction(t)?this.each(function(n){g(this).toggleClass(t.call(this,n,le(this),e),e)}):this.each(function(){var e,r,i,o;if("string"===n)for(r=0,i=g(this),o=t.match(L)||[];e=o[r++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else void 0!==t&&"boolean"!==n||((e=le(this))&&H.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":H.get(this,"__className__")||""))})},hasClass:function(t){var e,n,r=0;for(e=" "+t+" ";n=this[r++];)if(1===n.nodeType&&(" "+ce(le(n))+" ").indexOf(e)>-1)return!0;return!1}});var he=/\r/g;g.fn.extend({val:function(t){var e,n,r,i=this[0];return arguments.length?(r=g.isFunction(t),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?t.call(this,n,g(this).val()):t)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=g.map(i,function(t){return null==t?"":t+""})),(e=g.valHooks[this.type]||g.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))})):i?(e=g.valHooks[i.type]||g.valHooks[i.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(he,""):null==n?"":n:void 0}}),g.extend({valHooks:{option:{get:function(t){var e=g.find.attr(t,"value");return null!=e?e:ce(g.text(t))}},select:{get:function(t){var e,n,r,i=t.options,o=t.selectedIndex,a="select-one"===t.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!N(n.parentNode,"optgroup"))){if(e=g(n).val(),a)return e;s.push(e)}return s},set:function(t,e){for(var n,r,i=t.options,o=g.makeArray(e),a=i.length;a--;)((r=i[a]).selected=g.inArray(g.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),g.each(["radio","checkbox"],function(){g.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=g.inArray(g(t).val(),e)>-1}},d.checkOn||(g.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var fe=/^(?:focusinfocus|focusoutblur)$/;g.extend(g.event,{trigger:function(e,n,i,o){var a,s,u,c,l,f,p,d=[i||r],y=h.call(e,"type")?e.type:e,m=h.call(e,"namespace")?e.namespace.split("."):[];if(s=u=i=i||r,3!==i.nodeType&&8!==i.nodeType&&!fe.test(y+g.event.triggered)&&(y.indexOf(".")>-1&&(m=y.split("."),y=m.shift(),m.sort()),l=y.indexOf(":")<0&&"on"+y,(e=e[g.expando]?e:new g.Event(y,"object"==typeof e&&e)).isTrigger=o?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:g.makeArray(n,[e]),p=g.event.special[y]||{},o||!p.trigger||!1!==p.trigger.apply(i,n))){if(!o&&!p.noBubble&&!g.isWindow(i)){for(c=p.delegateType||y,fe.test(c+y)||(s=s.parentNode);s;s=s.parentNode)d.push(s),u=s;u===(i.ownerDocument||r)&&d.push(u.defaultView||u.parentWindow||t)}for(a=0;(s=d[a++])&&!e.isPropagationStopped();)e.type=a>1?c:p.bindType||y,(f=(H.get(s,"events")||{})[e.type]&&H.get(s,"handle"))&&f.apply(s,n),(f=l&&s[l])&&f.apply&&K(s)&&(e.result=f.apply(s,n),!1===e.result&&e.preventDefault());return e.type=y,o||e.isDefaultPrevented()||p._default&&!1!==p._default.apply(d.pop(),n)||!K(i)||l&&g.isFunction(i[y])&&!g.isWindow(i)&&((u=i[l])&&(i[l]=null),g.event.triggered=y,i[y](),g.event.triggered=void 0,u&&(i[l]=u)),e.result}},simulate:function(t,e,n){var r=g.extend(new g.Event,n,{type:t,isSimulated:!0});g.event.trigger(r,null,e)}}),g.fn.extend({trigger:function(t,e){return this.each(function(){g.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return g.event.trigger(t,e,n,!0)}}),g.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){g.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),g.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),d.focusin="onfocusin"in t,d.focusin||g.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){g.event.simulate(e,t.target,g.event.fix(t))};g.event.special[e]={setup:function(){var r=this.ownerDocument||this,i=H.access(r,e);i||r.addEventListener(t,n,!0),H.access(r,e,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=H.access(r,e)-1;i?H.access(r,e,i):(r.removeEventListener(t,n,!0),H.remove(r,e))}}});var pe=t.location,de=g.now(),ye=/\?/;g.parseXML=function(e){var n;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||g.error("Invalid XML: "+e),n};var me=/\[\]$/,ge=/\r?\n/g,ve=/^(?:submit|button|image|reset|file)$/i,be=/^(?:input|select|textarea|keygen)/i;function we(t,e,n,r){var i;if(Array.isArray(e))g.each(e,function(e,i){n||me.test(t)?r(t,i):we(t+"["+("object"==typeof i&&null!=i?e:"")+"]",i,n,r)});else if(n||"object"!==g.type(e))r(t,e);else for(i in e)we(t+"["+i+"]",e[i],n,r)}g.param=function(t,e){var n,r=[],i=function(t,e){var n=g.isFunction(e)?e():e;r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(t)||t.jquery&&!g.isPlainObject(t))g.each(t,function(){i(this.name,this.value)});else for(n in t)we(n,t[n],e,i);return r.join("&")},g.fn.extend({serialize:function(){return g.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=g.prop(this,"elements");return t?g.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!g(this).is(":disabled")&&be.test(this.nodeName)&&!ve.test(t)&&(this.checked||!at.test(t))}).map(function(t,e){var n=g(this).val();return null==n?null:Array.isArray(n)?g.map(n,function(t){return{name:e.name,value:t.replace(ge,"\r\n")}}):{name:e.name,value:n.replace(ge,"\r\n")}}).get()}});var _e=/%20/g,Te=/#.*$/,Ee=/([?&])_=[^&]*/,Se=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ce=/^(?:GET|HEAD)$/,Ie=/^\/\//,Ne={},Ae={},ke="*/".concat("*"),De=r.createElement("a");function Re(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,o=e.toLowerCase().match(L)||[];if(g.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}function xe(t,e,n,r){var i={},o=t===Ae;function a(s){var u;return i[s]=!0,g.each(t[s]||[],function(t,s){var c=s(e,n,r);return"string"!=typeof c||o||i[c]?o?!(u=c):void 0:(e.dataTypes.unshift(c),a(c),!1)}),u}return a(e.dataTypes[0])||!i["*"]&&a("*")}function Oe(t,e){var n,r,i=g.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r||(r={}))[n]=e[n]);return r&&g.extend(!0,t,r),t}De.href=pe.href,g.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:pe.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(pe.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ke,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":g.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Oe(Oe(t,g.ajaxSettings),e):Oe(g.ajaxSettings,t)},ajaxPrefilter:Re(Ne),ajaxTransport:Re(Ae),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0),n=n||{};var i,o,a,s,u,c,l,h,f,p,d=g.ajaxSetup({},n),y=d.context||d,m=d.context&&(y.nodeType||y.jquery)?g(y):g.event,v=g.Deferred(),b=g.Callbacks("once memory"),w=d.statusCode||{},_={},T={},E="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(l){if(!s)for(s={};e=Se.exec(a);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return l?a:null},setRequestHeader:function(t,e){return null==l&&(t=T[t.toLowerCase()]=T[t.toLowerCase()]||t,_[t]=e),this},overrideMimeType:function(t){return null==l&&(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(l)S.always(t[S.status]);else for(e in t)w[e]=[w[e],t[e]];return this},abort:function(t){var e=t||E;return i&&i.abort(e),C(0,e),this}};if(v.promise(S),d.url=((e||d.url||pe.href)+"").replace(Ie,pe.protocol+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(L)||[""],null==d.crossDomain){c=r.createElement("a");try{c.href=d.url,c.href=c.href,d.crossDomain=De.protocol+"//"+De.host!=c.protocol+"//"+c.host}catch(t){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=g.param(d.data,d.traditional)),xe(Ne,d,n,S),l)return S;for(f in(h=g.event&&d.global)&&0==g.active++&&g.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Ce.test(d.type),o=d.url.replace(Te,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(_e,"+")):(p=d.url.slice(o.length),d.data&&(o+=(ye.test(o)?"&":"?")+d.data,delete d.data),!1===d.cache&&(o=o.replace(Ee,"$1"),p=(ye.test(o)?"&":"?")+"_="+de+++p),d.url=o+p),d.ifModified&&(g.lastModified[o]&&S.setRequestHeader("If-Modified-Since",g.lastModified[o]),g.etag[o]&&S.setRequestHeader("If-None-Match",g.etag[o])),(d.data&&d.hasContent&&!1!==d.contentType||n.contentType)&&S.setRequestHeader("Content-Type",d.contentType),S.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+ke+"; q=0.01":""):d.accepts["*"]),d.headers)S.setRequestHeader(f,d.headers[f]);if(d.beforeSend&&(!1===d.beforeSend.call(y,S,d)||l))return S.abort();if(E="abort",b.add(d.complete),S.done(d.success),S.fail(d.error),i=xe(Ae,d,n,S)){if(S.readyState=1,h&&m.trigger("ajaxSend",[S,d]),l)return S;d.async&&d.timeout>0&&(u=t.setTimeout(function(){S.abort("timeout")},d.timeout));try{l=!1,i.send(_,C)}catch(t){if(l)throw t;C(-1,t)}}else C(-1,"No Transport");function C(e,n,r,s){var c,f,p,_,T,E=n;l||(l=!0,u&&t.clearTimeout(u),i=void 0,a=s||"",S.readyState=e>0?4:0,c=e>=200&&e<300||304===e,r&&(_=function(t,e,n){for(var r,i,o,a,s=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||t.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(d,S,r)),_=function(t,e,n,r){var i,o,a,s,u,c={},l=t.dataTypes.slice();if(l[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(o=l.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=l.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=c[u+" "+o]||c["* "+o]))for(i in c)if((s=i.split(" "))[1]===o&&(a=c[u+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[i]:!0!==c[i]&&(o=s[0],l.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}(d,_,S,c),c?(d.ifModified&&((T=S.getResponseHeader("Last-Modified"))&&(g.lastModified[o]=T),(T=S.getResponseHeader("etag"))&&(g.etag[o]=T)),204===e||"HEAD"===d.type?E="nocontent":304===e?E="notmodified":(E=_.state,f=_.data,c=!(p=_.error))):(p=E,!e&&E||(E="error",e<0&&(e=0))),S.status=e,S.statusText=(n||E)+"",c?v.resolveWith(y,[f,E,S]):v.rejectWith(y,[S,E,p]),S.statusCode(w),w=void 0,h&&m.trigger(c?"ajaxSuccess":"ajaxError",[S,d,c?f:p]),b.fireWith(y,[S,E]),h&&(m.trigger("ajaxComplete",[S,d]),--g.active||g.event.trigger("ajaxStop")))}return S},getJSON:function(t,e,n){return g.get(t,e,n,"json")},getScript:function(t,e){return g.get(t,void 0,e,"script")}}),g.each(["get","post"],function(t,e){g[e]=function(t,n,r,i){return g.isFunction(n)&&(i=i||r,r=n,n=void 0),g.ajax(g.extend({url:t,type:e,dataType:i,data:n,success:r},g.isPlainObject(t)&&t))}}),g._evalUrl=function(t){return g.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},g.fn.extend({wrapAll:function(t){var e;return this[0]&&(g.isFunction(t)&&(t=t.call(this[0])),e=g(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return g.isFunction(t)?this.each(function(e){g(this).wrapInner(t.call(this,e))}):this.each(function(){var e=g(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=g.isFunction(t);return this.each(function(n){g(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){g(this).replaceWith(this.childNodes)}),this}}),g.expr.pseudos.hidden=function(t){return!g.expr.pseudos.visible(t)},g.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},g.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var Pe={0:200,1223:204},Me=g.ajaxSettings.xhr();d.cors=!!Me&&"withCredentials"in Me,d.ajax=Me=!!Me,g.ajaxTransport(function(e){var n,r;if(d.cors||Me&&!e.crossDomain)return{send:function(i,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(a,i[a]);n=function(t){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Pe[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&t.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(e.hasContent&&e.data||null)}catch(t){if(n)throw t}},abort:function(){n&&n()}}}),g.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),g.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return g.globalEval(t),t}}}),g.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),g.ajaxTransport("script",function(t){var e,n;if(t.crossDomain)return{send:function(i,o){e=g("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&o("error"===t.type?404:200,t.type)}),r.head.appendChild(e[0])},abort:function(){n&&n()}}});var Le=[],Fe=/(=)\?(?=&|$)|\?\?/;g.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Le.pop()||g.expando+"_"+de++;return this[t]=!0,t}}),g.ajaxPrefilter("json jsonp",function(e,n,r){var i,o,a,s=!1!==e.jsonp&&(Fe.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fe.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=g.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Fe,"$1"+i):!1!==e.jsonp&&(e.url+=(ye.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||g.error(i+" was not called"),a[0]},e.dataTypes[0]="json",o=t[i],t[i]=function(){a=arguments},r.always(function(){void 0===o?g(t).removeProp(i):t[i]=o,e[i]&&(e.jsonpCallback=n.jsonpCallback,Le.push(i)),a&&g.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),d.createHTMLDocument=function(){var t=r.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),g.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(d.createHTMLDocument?((i=(e=r.implementation.createHTMLDocument("")).createElement("base")).href=r.location.href,e.head.appendChild(i)):e=r),a=!n&&[],(o=A.exec(t))?[e.createElement(o[1])]:(o=pt([t],e,a),a&&a.length&&g(a).remove(),g.merge([],o.childNodes)));var i,o,a},g.fn.load=function(t,e,n){var r,i,o,a=this,s=t.indexOf(" ");return s>-1&&(r=ce(t.slice(s)),t=t.slice(0,s)),g.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),a.length>0&&g.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(r?g("<div>").append(g.parseHTML(t)).find(r):t)}).always(n&&function(t,e){a.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},g.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){g.fn[e]=function(t){return this.on(e,t)}}),g.expr.pseudos.animated=function(t){return g.grep(g.timers,function(e){return t===e.elem}).length},g.offset={setOffset:function(t,e,n){var r,i,o,a,s,u,c=g.css(t,"position"),l=g(t),h={};"static"===c&&(t.style.position="relative"),s=l.offset(),o=g.css(t,"top"),u=g.css(t,"left"),("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1?(a=(r=l.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),g.isFunction(e)&&(e=e.call(t,n,g.extend({},s))),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+i),"using"in e?e.using.call(t,h):l.css(h)}},g.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){g.offset.setOffset(this,t,e)});var e,n,r,i,o=this[0];return o?o.getClientRects().length?(r=o.getBoundingClientRect(),n=(e=o.ownerDocument).documentElement,i=e.defaultView,{top:r.top+i.pageYOffset-n.clientTop,left:r.left+i.pageXOffset-n.clientLeft}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n=this[0],r={top:0,left:0};return"fixed"===g.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),N(t[0],"html")||(r=t.offset()),r={top:r.top+g.css(t[0],"borderTopWidth",!0),left:r.left+g.css(t[0],"borderLeftWidth",!0)}),{top:e.top-r.top-g.css(n,"marginTop",!0),left:e.left-r.left-g.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===g.css(t,"position");)t=t.offsetParent;return t||dt})}}),g.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;g.fn[t]=function(r){return W(this,function(t,r,i){var o;return g.isWindow(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===i?o?o[e]:t[r]:void(o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):t[r]=i)},t,r,arguments.length)}}),g.each(["top","left"],function(t,e){g.cssHooks[e]=Ut(d.pixelPosition,function(t,n){if(n)return n=Ft(t,e),Mt.test(n)?g(t).position()[e]+"px":n})}),g.each({Height:"height",Width:"width"},function(t,e){g.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,r){g.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return W(this,function(e,n,i){var o;return g.isWindow(e)?0===r.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===i?g.css(e,n,s):g.style(e,n,i,s)},e,a?i:void 0,a)}})}),g.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),g.holdReady=function(t){t?g.readyWait++:g.ready(!0)},g.isArray=Array.isArray,g.parseJSON=JSON.parse,g.nodeName=N,"function"==typeof define&&define.amd&&define("jquery",[],function(){return g});var Ue=t.jQuery,qe=t.$;return g.noConflict=function(e){return t.$===g&&(t.$=qe),e&&t.jQuery===g&&(t.jQuery=Ue),g},e||(t.jQuery=t.$=g),g}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).firebase=e()}(this,function(){"use strict";!function(t){if(!t.fetch){var e="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,r="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in t,o="ArrayBuffer"in t;if(o)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=function(t){return t&&DataView.prototype.isPrototypeOf(t)},u=ArrayBuffer.isView||function(t){return t&&-1<a.indexOf(Object.prototype.toString.call(t))};d.prototype.append=function(t,e){t=h(t),e=f(e);var n=this.map[t];this.map[t]=n?n+","+e:e},d.prototype.delete=function(t){delete this.map[h(t)]},d.prototype.get=function(t){return t=h(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(h(t))},d.prototype.set=function(t,e){this.map[h(t)]=f(e)},d.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},d.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),p(t)},d.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),p(t)},d.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),p(t)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},b.call(w.prototype),b.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},T.error=function(){var t=new T(null,{status:0,statusText:""});return t.type="error",t};var l=[301,302,303,307,308];T.redirect=function(t,e){if(-1===l.indexOf(e))throw new RangeError("Invalid status code");return new T(null,{status:e,headers:{location:t}})},t.Headers=d,t.Request=w,t.Response=T,t.fetch=function(t,e){return new Promise(function(n,i){var o=new w(t,e),a=new XMLHttpRequest;a.onload=function(){var t,e,r={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new d,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new T(i,r))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&r&&(a.responseType="blob"),o.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),a.send(void 0===o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}function h(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function f(t){return"string"!=typeof t&&(t=String(t)),t}function p(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function d(t){this.map={},t instanceof d?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function y(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function m(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function g(t){var e=new FileReader,n=m(e);return e.readAsArrayBuffer(t),n}function v(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t)if("string"==typeof t)this._bodyText=t;else if(r&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(i&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(o&&r&&s(t))this._bodyArrayBuffer=v(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!o||!ArrayBuffer.prototype.isPrototypeOf(t)&&!u(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var t=y(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var t,e,n,r=y(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,n=m(e=new FileReader),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function w(t,e){var n,r,i=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=(r=(n=e.method||this.method||"GET").toUpperCase(),-1<c.indexOf(r)?r:n),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function _(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function T(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:void 0);var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}function n(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})}var r=setTimeout;function i(){}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(t,this)}function a(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(n){return void u(e.promise,n)}s(e.promise,r)}else(1===t._state?s:u)(e.promise,t._value)})):t._deferreds.push(e)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void h((r=n,i=e,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){u(t,e)}var r,i}function u(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function l(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function h(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,u(e,t))})}catch(t){if(n)return;n=!0,u(e,t)}}o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(i);return a(this,new l(t,e,n)),n},o.prototype.finally=n,o.all=function(t){return new o(function(e,n){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var i=r.length;function o(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){o(t,e)},n)}r[t]=a,0==--i&&e(r)}catch(a){n(a)}}for(var a=0;a<r.length;a++)o(a,r[a])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},o._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){r(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var f=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")}();"Promise"in f?f.Promise.prototype.finally||(f.Promise.prototype.finally=n):f.Promise=o;var p,d,y,m=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},g=function(t,e,n){if(m(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},v=function(t){try{return!!t()}catch(t){return!0}},b={}.toString,w=function(t){return b.call(t).slice(8,-1)},_="".split,T=v(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==w(t)?_.call(t,""):Object(t)}:Object,E=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},S=function(t){return Object(E(t))},C=Math.ceil,I=Math.floor,N=function(t){return isNaN(t=+t)?0:(0<t?I:C)(t)},A=Math.min,k=function(t){return 0<t?A(N(t),9007199254740991):0},D=function(t){return"object"==typeof t?null!==t:"function"==typeof t},R=Array.isArray||function(t){return"Array"==w(t)},x="object"==typeof window&&window&&window.Math==Math?window:"object"==typeof self&&self&&self.Math==Math?self:Function("return this")(),O=!v(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),P=x.document,M=D(P)&&D(P.createElement),L=function(t){return M?P.createElement(t):{}},F=!O&&!v(function(){return 7!=Object.defineProperty(L("div"),"a",{get:function(){return 7}}).a}),U=function(t){if(!D(t))throw TypeError(String(t)+" is not an object");return t},q=function(t,e){if(!D(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!D(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!D(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!D(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},V=Object.defineProperty,j={f:O?V:function(t,e,n){if(U(t),e=q(e,!0),U(n),F)try{return V(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},B=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},W=O?function(t,e,n){return j.f(t,e,B(1,n))}:function(t,e,n){return t[e]=n,t},K=function(t,e){try{W(x,t,e)}catch(n){x[t]=e}return e},Q=!1,H=e(function(t){var e="__core-js_shared__",n=x[e]||K(e,{});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.0.1",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),G=0,z=Math.random(),Y=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++G+z).toString(36))},X=!v(function(){return!String(Symbol())}),J=H("wks"),$=x.Symbol,Z=function(t){return J[t]||(J[t]=X&&$[t]||(X?$:Y)("Symbol."+t))},tt=Z("species"),et=function(t,e){var n;return R(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!R(n.prototype)?D(n)&&null===(n=n[tt])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)},nt=function(t,e){var n=1==t,r=2==t,i=3==t,o=4==t,a=6==t,s=5==t||a,u=e||et;return function(e,c,l){for(var h,f,p=S(e),d=T(p),y=g(c,l,3),m=k(d.length),v=0,b=n?u(e,m):r?u(e,0):void 0;v<m;v++)if((s||v in d)&&(f=y(h=d[v],v,p),t))if(n)b[v]=f;else if(f)switch(t){case 3:return!0;case 5:return h;case 6:return v;case 2:b.push(h)}else if(o)return!1;return a?-1:i||o?o:b}},rt={}.propertyIsEnumerable,it=Object.getOwnPropertyDescriptor,ot={f:it&&!rt.call({1:2},1)?function(t){var e=it(this,t);return!!e&&e.enumerable}:rt},at=function(t){return T(E(t))},st={}.hasOwnProperty,ut=function(t,e){return st.call(t,e)},ct=Object.getOwnPropertyDescriptor,lt={f:O?ct:function(t,e){if(t=at(t),e=q(e,!0),F)try{return ct(t,e)}catch(t){}if(ut(t,e))return B(!ot.f.call(t,e),t[e])}},ht=H("native-function-to-string",Function.toString),ft=x.WeakMap,pt="function"==typeof ft&&/native code/.test(ht.call(ft)),dt=H("keys"),yt=function(t){return dt[t]||(dt[t]=Y(t))},mt={},gt=x.WeakMap;if(pt){var vt=new gt,bt=vt.get,wt=vt.has,_t=vt.set;p=function(t,e){return _t.call(vt,t,e),e},d=function(t){return bt.call(vt,t)||{}},y=function(t){return wt.call(vt,t)}}else{var Tt=yt("state");mt[Tt]=!0,p=function(t,e){return W(t,Tt,e),e},d=function(t){return ut(t,Tt)?t[Tt]:{}},y=function(t){return ut(t,Tt)}}var Et={set:p,get:d,has:y,enforce:function(t){return y(t)?d(t):p(t,{})},getterFor:function(t){return function(e){var n;if(!D(e)||(n=d(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},St=e(function(t){var e=Et.get,n=Et.enforce,r=String(ht).split("toString");H("inspectSource",function(t){return ht.call(t)}),(t.exports=function(t,e,i,o){var a=!!o&&!!o.unsafe,s=!!o&&!!o.enumerable,u=!!o&&!!o.noTargetGet;"function"==typeof i&&("string"!=typeof e||ut(i,"name")||W(i,"name",e),n(i).source=r.join("string"==typeof e?e:"")),t!==x?(a?!u&&t[e]&&(s=!0):delete t[e],s?t[e]=i:W(t,e,i)):s?t[e]=i:K(e,i)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||ht.call(this)})}),Ct=Math.max,It=Math.min,Nt=(!1,function(t,e,n){var r,i,o=at(t),a=k(o.length),s=(r=a,(i=N(n))<0?Ct(i+r,0):It(i,r));for(0;s<a;s++)if(s in o&&o[s]===e)return s||0;return-1}),At=function(t,e){var n,r=at(t),i=0,o=[];for(n in r)!ut(mt,n)&&ut(r,n)&&o.push(n);for(;e.length>i;)ut(r,n=e[i++])&&(~Nt(o,n)||o.push(n));return o},kt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Dt=kt.concat("length","prototype"),Rt={f:Object.getOwnPropertyNames||function(t){return At(t,Dt)}},xt={f:Object.getOwnPropertySymbols},Ot=x.Reflect,Pt=Ot&&Ot.ownKeys||function(t){var e=Rt.f(U(t)),n=xt.f;return n?e.concat(n(t)):e},Mt=function(t,e){for(var n=Pt(e),r=j.f,i=lt.f,o=0;o<n.length;o++){var a=n[o];ut(t,a)||r(t,a,i(e,a))}},Lt=/#|\.prototype\./,Ft=function(t,e){var n=qt[Ut(t)];return n==jt||n!=Vt&&("function"==typeof e?v(e):!!e)},Ut=Ft.normalize=function(t){return String(t).replace(Lt,".").toLowerCase()},qt=Ft.data={},Vt=Ft.NATIVE="N",jt=Ft.POLYFILL="P",Bt=Ft,Wt=lt.f,Kt=function(t,e){var n,r,i,o,a,s=t.target,u=t.global,c=t.stat;if(n=u?x:c?x[s]||K(s,{}):(x[s]||{}).prototype)for(r in e){if(o=e[r],i=t.noTargetGet?(a=Wt(n,r))&&a.value:n[r],!Bt(u?r:s+(c?".":"#")+r,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;Mt(o,i)}(t.sham||i&&i.sham)&&W(o,"sham",!0),St(n,r,o,t)}},Qt=Object.keys||function(t){return At(t,kt)},Ht=O?Object.defineProperties:function(t,e){U(t);for(var n,r=Qt(e),i=r.length,o=0;o<i;)j.f(t,n=r[o++],e[n]);return t},Gt=x.document,zt=Gt&&Gt.documentElement,Yt=yt("IE_PROTO"),Xt="prototype",Jt=function(){},$t=function(){var t,e=L("iframe"),n=kt.length;for(e.style.display="none",zt.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),$t=t.F;n--;)delete $t[Xt][kt[n]];return $t()},Zt=Object.create||function(t,e){var n;return null!==t?(Jt[Xt]=U(t),n=new Jt,Jt[Xt]=null,n[Yt]=t):n=$t(),void 0===e?n:Ht(n,e)};mt[Yt]=!0;var te=Z("unscopables"),ee=Array.prototype;null==ee[te]&&W(ee,te,Zt(null));var ne=function(t){ee[te][t]=!0},re=nt(5),ie="find",oe=!0;ie in[]&&Array(1)[ie](function(){oe=!1}),Kt({target:"Array",proto:!0,forced:oe},{find:function(t){return re(this,t,1<arguments.length?arguments[1]:void 0)}}),ne(ie);var ae=Function.call,se=function(t,e,n){return g(ae,x[t].prototype[e],n)},ue=(se("Array","find"),nt(6)),ce="findIndex",le=!0;ce in[]&&Array(1)[ce](function(){le=!1}),Kt({target:"Array",proto:!0,forced:le},{findIndex:function(t){return ue(this,t,1<arguments.length?arguments[1]:void 0)}}),ne(ce),se("Array","findIndex");var he,fe,pe,de=!v(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),ye=yt("IE_PROTO"),me=Object.prototype,ge=de?Object.getPrototypeOf:function(t){return t=S(t),ut(t,ye)?t[ye]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?me:null},ve=Z("iterator"),be=!1;[].keys&&("next"in(pe=[].keys())?(fe=ge(ge(pe)))!==Object.prototype&&(he=fe):be=!0),null==he&&(he={}),ut(he,ve)||W(he,ve,function(){return this});var we={IteratorPrototype:he,BUGGY_SAFARI_ITERATORS:be},_e=j.f,Te=Z("toStringTag"),Ee=function(t,e,n){t&&!ut(t=n?t:t.prototype,Te)&&_e(t,Te,{configurable:!0,value:e})},Se={},Ce=we.IteratorPrototype,Ie=function(){return this},Ne=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(n){}return function(n,r){return function(t,e){if(U(t),!D(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(n,r),e?t.call(n,r):n.__proto__=r,n}}():void 0),Ae=Z("iterator"),ke=we.IteratorPrototype,De=we.BUGGY_SAFARI_ITERATORS,Re="values",xe="entries",Oe=function(){return this},Pe=function(t,e,n,r,i,o,a){var s,u,c;u=r,c=e+" Iterator",(s=n).prototype=Zt(Ce,{next:B(1,u)}),Ee(s,c,!1),Se[c]=Ie;var l,h,f,p=function(t){if(t===i&&v)return v;if(!De&&t in m)return m[t];switch(t){case"keys":case Re:case xe:return function(){return new n(this,t)}}return function(){return new n(this)}},d=e+" Iterator",y=!1,m=t.prototype,g=m[Ae]||m["@@iterator"]||i&&m[i],v=!De&&g||p(i),b="Array"==e&&m.entries||g;if(b&&(l=ge(b.call(new t)),ke!==Object.prototype&&l.next&&(ge(l)!==ke&&(Ne?Ne(l,ke):"function"!=typeof l[Ae]&&W(l,Ae,Oe)),Ee(l,d,!0))),i==Re&&g&&g.name!==Re&&(y=!0,v=function(){return g.call(this)}),m[Ae]!==v&&W(m,Ae,v),Se[e]=v,i)if(h={values:p(Re),keys:o?v:p("keys"),entries:p(xe)},a)for(f in h)!De&&!y&&f in m||St(m,f,h[f]);else Kt({target:e,proto:!0,forced:De||y},h);return h},Me="String Iterator",Le=Et.set,Fe=Et.getterFor(Me);Pe(String,"String",function(t){Le(this,{type:Me,string:String(t),index:0})},function(){var t,e,n,r,i,o,a,s=Fe(this),u=s.string,c=s.index;return c>=u.length?{value:void 0,done:!0}:(e=c,!0,i=String(E(u)),o=N(e),a=i.length,t=o<0||a<=o?"":(n=i.charCodeAt(o))<55296||56319<n||o+1===a||(r=i.charCodeAt(o+1))<56320||57343<r?i.charAt(o):i.slice(o,o+2),s.index+=t.length,{value:t,done:!1})});var Ue=Z("iterator"),qe=!1;try{var Ve=0;({next:function(){return{done:!!Ve++}},return:function(){qe=!0}})[Ue]=function(){return this}}catch(yo){}var je=function(t,e){if(!e&&!qe)return!1;var n=!1;try{var r={};r[Ue]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},Be=function(t,e,n,r){try{return r?e(U(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&U(i.call(t)),e}},We=Z("iterator"),Ke=Array.prototype,Qe=function(t){return void 0!==t&&(Se.Array===t||Ke[We]===t)},He=function(t,e,n){var r=q(e);r in t?j.f(t,r,B(0,n)):t[r]=n},Ge=Z("toStringTag"),ze="Arguments"==w(function(){return arguments}()),Ye=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Ge))?n:ze?w(e):"Object"==(r=w(e))&&"function"==typeof e.callee?"Arguments":r},Xe=Z("iterator"),Je=function(t){if(null!=t)return t[Xe]||t["@@iterator"]||Se[Ye(t)]},$e=!je(function(t){});Kt({target:"Array",stat:!0,forced:$e},{from:function(t){var e,n,r,i,o=S(t),a="function"==typeof this?this:Array,s=arguments.length,u=1<s?arguments[1]:void 0,c=void 0!==u,l=0,h=Je(o);if(c&&(u=g(u,2<s?arguments[2]:void 0,2)),null==h||a==Array&&Qe(h))for(n=new a(e=k(o.length));l<e;l++)He(n,l,c?u(o[l],l):o[l]);else for(i=h.call(o),n=new a;!(r=i.next()).done;l++)He(n,l,c?Be(i,u,[r.value,l],!0):r.value);return n.length=l,n}});var Ze=x,tn=(Ze.Array.from,Object.assign),en=!tn||v(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=tn({},t)[n]||Qt(tn({},e)).join("")!=r})?function(t,e){for(var n=S(t),r=arguments.length,i=1,o=xt.f,a=ot.f;i<r;)for(var s,u=T(arguments[i++]),c=o?Qt(u).concat(o(u)):Qt(u),l=c.length,h=0;h<l;)a.call(u,s=c[h++])&&(n[s]=u[s]);return n}:tn;Kt({target:"Object",stat:!0,forced:Object.assign!==en},{assign:en}),Ze.Object.assign;var nn=ot.f,rn=function(t,e){for(var n,r=at(t),i=Qt(r),o=i.length,a=0,s=[];a<o;)nn.call(r,n=i[a++])&&s.push(e?[n,r[n]]:r[n]);return s};Kt({target:"Object",stat:!0},{entries:function(t){return rn(t,!0)}}),Ze.Object.entries,Kt({target:"Object",stat:!0},{values:function(t){return rn(t)}}),Ze.Object.values;var on=Z("match"),an=Z("match"),sn="startsWith",un=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[an]=!1,"/./"[t](e)}catch(t){}}return!1}(sn),cn=""[sn];Kt({target:"String",proto:!0,forced:!un},{startsWith:function(t){var e=function(t,e,n){if(D(r=e)&&(void 0!==(i=r[on])?i:"RegExp"==w(r)))throw TypeError("String.prototype."+n+" doesn't accept regex");var r,i;return String(E(t))}(this,t,sn),n=k(Math.min(1<arguments.length?arguments[1]:void 0,e.length)),r=String(t);return cn?cn.call(e,r,n):e.slice(n,n+r.length)===r}}),se("String","startsWith"),Kt({target:"String",proto:!0},{repeat:"".repeat||function(t){var e=String(E(this)),n="",r=N(t);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;0<r;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}}),se("String","repeat");var ln=Z("species"),hn=Z("isConcatSpreadable"),fn=9007199254740991,pn="Maximum allowed index exceeded",dn=!v(function(){var t=[];return t[hn]=!1,t.concat()[0]!==t}),yn=("concat",!v(function(){var t=[];return(t.constructor={})[ln]=function(){return{foo:1}},1!==t.concat(Boolean).foo})),mn=function(t){if(!D(t))return!1;var e=t[hn];return void 0!==e?!!e:R(t)};Kt({target:"Array",proto:!0,forced:!dn||!yn},{concat:function(t){var e,n,r,i,o,a=S(this),s=et(a,0),u=0;for(e=-1,r=arguments.length;e<r;e++)if(o=-1===e?a:arguments[e],mn(o)){if(i=k(o.length),fn<u+i)throw TypeError(pn);for(n=0;n<i;n++,u++)n in o&&He(s,u,o[n])}else{if(fn<=u)throw TypeError(pn);He(s,u++,o)}return s.length=u,s}});var gn={};gn[Z("toStringTag")]="z";var vn="[object z]"!==String(gn)?function(){return"[object "+Ye(this)+"]"}:gn.toString,bn=Object.prototype;vn!==bn.toString&&St(bn,"toString",vn,{unsafe:!0});var wn={f:Z},_n=j.f,Tn=function(t){var e=Ze.Symbol||(Ze.Symbol={});ut(e,t)||_n(e,t,{value:wn.f(t)})},En=Rt.f,Sn={}.toString,Cn="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],In={f:function(t){return Cn&&"[object Window]"==Sn.call(t)?function(t){try{return En(t)}catch(t){return Cn.slice()}}(t):En(at(t))}},Nn=yt("hidden"),An="Symbol",kn=Et.set,Dn=Et.getterFor(An),Rn=lt.f,xn=j.f,On=In.f,Pn=x.Symbol,Mn=x.JSON,Ln=Mn&&Mn.stringify,Fn="prototype",Un=Z("toPrimitive"),qn=ot.f,Vn=H("symbol-registry"),jn=H("symbols"),Bn=H("op-symbols"),Wn=H("wks"),Kn=Object[Fn],Qn=x.QObject,Hn=!Qn||!Qn[Fn]||!Qn[Fn].findChild,Gn=O&&v(function(){return 7!=Zt(xn({},"a",{get:function(){return xn(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=Rn(Kn,e);r&&delete Kn[e],xn(t,e,n),r&&t!==Kn&&xn(Kn,e,r)}:xn,zn=function(t,e){var n=jn[t]=Zt(Pn[Fn]);return kn(n,{type:An,tag:t,description:e}),O||(n.description=e),n},Yn=X&&"symbol"==typeof Pn.iterator?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Pn},Xn=function(t,e,n){return t===Kn&&Xn(Bn,e,n),U(t),e=q(e,!0),U(n),ut(jn,e)?(n.enumerable?(ut(t,Nn)&&t[Nn][e]&&(t[Nn][e]=!1),n=Zt(n,{enumerable:B(0,!1)})):(ut(t,Nn)||xn(t,Nn,B(1,{})),t[Nn][e]=!0),Gn(t,e,n)):xn(t,e,n)},Jn=function(t,e){U(t);for(var n,r=function(t){var e=Qt(t),n=xt.f;if(n)for(var r,i=n(t),o=ot.f,a=0;i.length>a;)o.call(t,r=i[a++])&&e.push(r);return e}(e=at(e)),i=0,o=r.length;i<o;)Xn(t,n=r[i++],e[n]);return t},$n=function(t){var e=qn.call(this,t=q(t,!0));return!(this===Kn&&ut(jn,t)&&!ut(Bn,t))&&(!(e||!ut(this,t)||!ut(jn,t)||ut(this,Nn)&&this[Nn][t])||e)},Zn=function(t,e){if(t=at(t),e=q(e,!0),t!==Kn||!ut(jn,e)||ut(Bn,e)){var n=Rn(t,e);return!n||!ut(jn,e)||ut(t,Nn)&&t[Nn][e]||(n.enumerable=!0),n}},tr=function(t){for(var e,n=On(at(t)),r=[],i=0;n.length>i;)ut(jn,e=n[i++])||ut(mt,e)||r.push(e);return r},er=function(t){for(var e,n=t===Kn,r=On(n?Bn:at(t)),i=[],o=0;r.length>o;)!ut(jn,e=r[o++])||n&&!ut(Kn,e)||i.push(jn[e]);return i};X||(St((Pn=function(){if(this instanceof Pn)throw TypeError("Symbol is not a constructor");var t=void 0===arguments[0]?void 0:String(arguments[0]),e=Y(t),n=function(t){this===Kn&&n.call(Bn,t),ut(this,Nn)&&ut(this[Nn],e)&&(this[Nn][e]=!1),Gn(this,e,B(1,t))};return O&&Hn&&Gn(Kn,e,{configurable:!0,set:n}),zn(e,t)})[Fn],"toString",function(){return Dn(this).tag}),ot.f=$n,j.f=Xn,lt.f=Zn,Rt.f=In.f=tr,xt.f=er,O&&(xn(Pn[Fn],"description",{configurable:!0,get:function(){return Dn(this).description}}),St(Kn,"propertyIsEnumerable",$n,{unsafe:!0})),wn.f=function(t){return zn(Z(t),t)}),Kt({global:!0,wrap:!0,forced:!X,sham:!X},{Symbol:Pn});for(var nr=Qt(Wn),rr=0;nr.length>rr;)Tn(nr[rr++]);Kt({target:An,stat:!0,forced:!X},{for:function(t){return ut(Vn,t+="")?Vn[t]:Vn[t]=Pn(t)},keyFor:function(t){if(!Yn(t))throw TypeError(t+" is not a symbol");for(var e in Vn)if(Vn[e]===t)return e},useSetter:function(){Hn=!0},useSimple:function(){Hn=!1}}),Kt({target:"Object",stat:!0,forced:!X,sham:!O},{create:function(t,e){return void 0===e?Zt(t):Jn(Zt(t),e)},defineProperty:Xn,defineProperties:Jn,getOwnPropertyDescriptor:Zn}),Kt({target:"Object",stat:!0,forced:!X},{getOwnPropertyNames:tr,getOwnPropertySymbols:er}),Mn&&Kt({target:"JSON",stat:!0,forced:!X||v(function(){var t=Pn();return"[null]"!=Ln([t])||"{}"!=Ln({a:t})||"{}"!=Ln(Object(t))})},{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(D(e)||void 0!==t)&&!Yn(t))return R(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Yn(e))return e}),r[1]=e,Ln.apply(Mn,r)}}),Pn[Fn][Un]||W(Pn[Fn],Un,Pn[Fn].valueOf),Ee(Pn,An),mt[Nn]=!0,Tn("asyncIterator");var ir=j.f,or=x.Symbol;if(O&&"function"==typeof or&&(!("description"in or.prototype)||void 0!==or().description)){var ar={},sr=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof sr?new or(t):void 0===t?or():or(t);return""===t&&(ar[e]=!0),e};Mt(sr,or);var ur=sr.prototype=or.prototype;ur.constructor=sr;var cr=ur.toString,lr="Symbol(test)"==String(or("test")),hr=/^Symbol\((.*)\)[^)]+$/;ir(ur,"description",{configurable:!0,get:function(){var t=D(this)?this.valueOf():this,e=cr.call(t);if(ut(ar,t))return"";var n=lr?e.slice(7,-1):e.replace(hr,"$1");return""===n?void 0:n}}),Kt({global:!0,forced:!0},{Symbol:sr})}Tn("hasInstance"),Tn("isConcatSpreadable"),Tn("iterator"),Tn("match"),Tn("replace"),Tn("search"),Tn("species"),Tn("split"),Tn("toPrimitive"),Tn("toStringTag"),Tn("unscopables"),Ee(Math,"Math",!0),Ee(x.JSON,"JSON",!0),Ze.Symbol,Tn("dispose"),Tn("observable"),Tn("patternMatch");var fr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},pr="Array Iterator",dr=Et.set,yr=Et.getterFor(pr),mr=Pe(Array,"Array",function(t,e){dr(this,{type:pr,target:at(t),index:0,kind:e})},function(){var t=yr(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?{value:t.target=void 0,done:!0}:"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}},"values");Se.Arguments=Se.Array,ne("keys"),ne("values"),ne("entries");var gr=Z("iterator"),vr=Z("toStringTag"),br=mr.values;for(var wr in fr){var _r=x[wr],Tr=_r&&_r.prototype;if(Tr){if(Tr[gr]!==br)try{W(Tr,gr,br)}catch(yo){Tr[gr]=br}if(Tr[vr]||W(Tr,vr,wr),fr[wr])for(var Er in mr)if(Tr[Er]!==mr[Er])try{W(Tr,Er,mr[Er])}catch(yo){Tr[Er]=mr[Er]}}}wn.f("iterator");var Sr=!v(function(){return Object.isExtensible(Object.preventExtensions({}))}),Cr=e(function(t){var e=Y("meta"),n=j.f,r=0,i=Object.isExtensible||function(){return!0},o=function(t){n(t,e,{value:{objectID:"O"+ ++r,weakData:{}}})},a=t.exports={REQUIRED:!1,fastKey:function(t,n){if(!D(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!ut(t,e)){if(!i(t))return"F";if(!n)return"E";o(t)}return t[e].objectID},getWeakData:function(t,n){if(!ut(t,e)){if(!i(t))return!0;if(!n)return!1;o(t)}return t[e].weakData},onFreeze:function(t){return Sr&&a.REQUIRED&&i(t)&&!ut(t,e)&&o(t),t}};mt[e]=!0}),Ir=(Cr.REQUIRED,Cr.fastKey,Cr.getWeakData,Cr.onFreeze,e(function(t){var e={};(t.exports=function(t,n,r,i,o){var a,s,u,c,l,h=g(n,r,i?2:1);if(o)a=t;else{if("function"!=typeof(s=Je(t)))throw TypeError("Target is not iterable");if(Qe(s)){for(u=0,c=k(t.length);u<c;u++)if((i?h(U(l=t[u])[0],l[1]):h(t[u]))===e)return e;return}a=s.call(t)}for(;!(l=a.next()).done;)if(Be(a,h,l.value,i)===e)return e}).BREAK=e})),Nr=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t},Ar=function(t,e,n,r,i){var o=x[t],a=o&&o.prototype,s=o,u=r?"set":"add",c={},l=function(t){var e=a[t];St(a,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(i&&!D(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return i&&!D(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(i&&!D(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})};if(Bt(t,"function"!=typeof o||!(i||a.forEach&&!v(function(){(new o).entries().next()}))))s=n.getConstructor(e,t,r,u),Cr.REQUIRED=!0;else if(Bt(t,!0)){var h=new s,f=h[u](i?{}:-0,1)!=h,p=v(function(){h.has(1)}),d=je(function(t){new o(t)}),y=!i&&v(function(){for(var t=new o,e=5;e--;)t[u](e,e);return!t.has(-0)});d||(((s=e(function(e,n){Nr(e,s,t);var i,a,c,l,h=(i=new o,a=s,(l=e.constructor)!==a&&"function"==typeof l&&(c=l.prototype)!==a.prototype&&D(c)&&Ne&&Ne(i,c),i);return null!=n&&Ir(n,h[u],h,r),h})).prototype=a).constructor=s),(p||y)&&(l("delete"),l("has"),r&&l("get")),(y||f)&&l(u),i&&a.clear&&delete a.clear}return c[t]=s,Kt({global:!0,forced:s!=o},c),Ee(s,t),i||n.setStrong(s,t,r),s},kr=function(t,e,n){for(var r in e)St(t,r,e[r],n);return t},Dr=function(t){return"function"==typeof t?t:void 0},Rr=function(t,e){return arguments.length<2?Dr(Ze[t])||Dr(x[t]):Ze[t]&&Ze[t][e]||x[t]&&x[t][e]},xr=Z("species"),Or=j.f,Pr=Cr.fastKey,Mr=Et.set,Lr=Et.getterFor,Fr={getConstructor:function(t,e,n,r){var i=t(function(t,o){Nr(t,i,e),Mr(t,{type:e,index:Zt(null),first:void 0,last:void 0,size:0}),O||(t.size=0),null!=o&&Ir(o,t[r],t,n)}),o=Lr(e),a=function(t,e,n){var r,i,a=o(t),u=s(t,e);return u?u.value=n:(a.last=u={index:i=Pr(e,!0),key:e,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=u),r&&(r.next=u),O?a.size++:t.size++,"F"!==i&&(a.index[i]=u)),t},s=function(t,e){var n,r=o(t),i=Pr(e);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==e)return n};return kr(i.prototype,{clear:function(){for(var t=o(this),e=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete e[n.index],n=n.next;t.first=t.last=void 0,O?t.size=0:this.size=0},delete:function(t){var e=o(this),n=s(this,t);if(n){var r=n.next,i=n.previous;delete e.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),e.first==n&&(e.first=r),e.last==n&&(e.last=i),O?e.size--:this.size--}return!!n},forEach:function(t){for(var e,n=o(this),r=g(t,1<arguments.length?arguments[1]:void 0,3);e=e?e.next:n.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),kr(i.prototype,n?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return a(this,0===t?0:t,e)}}:{add:function(t){return a(this,t=0===t?0:t,t)}}),O&&Or(i.prototype,"size",{get:function(){return o(this).size}}),i},setStrong:function(t,e,n){var r,i,o=e+" Iterator",a=Lr(e),s=Lr(o);Pe(t,e,function(t,e){Mr(this,{type:o,target:t,state:a(t),kind:e,last:void 0})},function(){for(var t=s(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:t.target=void 0,done:!0}},n?"entries":"values",!n,!0),r=Rr(e),i=j.f,O&&r&&!r[xr]&&i(r,xr,{configurable:!0,get:function(){return this}})}},Ur=(Ar("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},Fr,!0),Ze.Map,function(t){var e,n,r,i,o=arguments[1];return m(this),(e=void 0!==o)&&m(o),null==t?new this:(n=[],e?(r=0,i=g(o,arguments[2],2),Ir(t,function(t){n.push(i(t,r++))})):Ir(t,n.push,n),new this(n))});Kt({target:"Map",stat:!0},{from:Ur});var qr=function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)};Kt({target:"Map",stat:!0},{of:qr});var Vr=function(){for(var t=U(this),e=m(t.delete),n=!0,r=0,i=arguments.length;r<i;r++)n=n&&e.call(t,arguments[r]);return!!n};Kt({target:"Map",proto:!0,real:!0,forced:Q},{deleteAll:function(){return Vr.apply(this,arguments)}});var jr=function(t){return Map.prototype.entries.call(t)};Kt({target:"Map",proto:!0,real:!0,forced:Q},{every:function(t){for(var e,n,r=U(this),i=jr(r),o=g(t,1<arguments.length?arguments[1]:void 0,3);!(e=i.next()).done;)if(!o((n=e.value)[1],n[0],r))return!1;return!0}});var Br=Z("species"),Wr=function(t,e){var n,r=U(t).constructor;return void 0===r||null==(n=U(r)[Br])?e:m(n)};Kt({target:"Map",proto:!0,real:!0,forced:Q},{filter:function(t){for(var e,n,r,i,o=U(this),a=jr(o),s=g(t,1<arguments.length?arguments[1]:void 0,3),u=new(Wr(o,Rr("Map"))),c=m(u.set);!(e=a.next()).done;)s(i=(n=e.value)[1],r=n[0],o)&&c.call(u,r,i);return u}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{find:function(t){for(var e,n,r,i=U(this),o=jr(i),a=g(t,1<arguments.length?arguments[1]:void 0,3);!(e=o.next()).done;)if(a(r=(n=e.value)[1],n[0],i))return r}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{findKey:function(t){for(var e,n,r,i=U(this),o=jr(i),a=g(t,1<arguments.length?arguments[1]:void 0,3);!(e=o.next()).done;)if(a((n=e.value)[1],r=n[0],i))return r}}),Kt({target:"Map",stat:!0,forced:Q},{groupBy:function(t,e){var n=new this;m(e);var r=m(n.has),i=m(n.get),o=m(n.set);return Ir(t,function(t){var a=e(t);r.call(n,a)?i.call(n,a).push(t):o.call(n,a,[t])}),n}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{includes:function(t){for(var e,n,r,i=U(this),o=jr(i);!(e=o.next()).done;)if((n=e.value[1])===(r=t)||n!=n&&r!=r)return!0;return!1}}),Kt({target:"Map",stat:!0,forced:Q},{keyBy:function(t,e){var n=new this;m(e);var r=m(n.set);return Ir(t,function(t){r.call(n,e(t),t)}),n}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{keyOf:function(t){for(var e,n,r=U(this),i=jr(r);!(e=i.next()).done;)if((n=e.value)[1]===t)return n[0]}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{mapKeys:function(t){for(var e,n,r,i=U(this),o=jr(i),a=g(t,1<arguments.length?arguments[1]:void 0,3),s=new(Wr(i,Rr("Map"))),u=m(s.set);!(e=o.next()).done;)n=e.value,u.call(s,a(r=n[1],n[0],i),r);return s}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{mapValues:function(t){for(var e,n,r,i=U(this),o=jr(i),a=g(t,1<arguments.length?arguments[1]:void 0,3),s=new(Wr(i,Rr("Map"))),u=m(s.set);!(e=o.next()).done;)n=e.value,u.call(s,r=n[0],a(n[1],r,i));return s}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{merge:function(t){for(var e=U(this),n=m(e.set),r=0;r<arguments.length;)Ir(arguments[r++],n,e,!0);return e}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{reduce:function(t){var e,n,r,i=U(this),o=jr(i);if(m(t),1<arguments.length)e=arguments[1];else{if((n=o.next()).done)throw TypeError("Reduce of empty map with no initial value");e=n.value[1]}for(;!(n=o.next()).done;)e=t(e,(r=n.value)[1],r[0],i);return e}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{some:function(t){for(var e,n,r=U(this),i=jr(r),o=g(t,1<arguments.length?arguments[1]:void 0,3);!(e=i.next()).done;)if(o((n=e.value)[1],n[0],r))return!0;return!1}}),Kt({target:"Map",proto:!0,real:!0,forced:Q},{update:function(t,e){var n=U(this);m(e);var r=n.has(t);if(!r&&arguments.length<3)throw TypeError("Updating absent value");var i=r?n.get(t):m(arguments[2])(t,n);return n.set(t,e(i,t,n)),n}}),Ar("Set",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},Fr),Ze.Set,Kt({target:"Set",stat:!0},{from:Ur}),Kt({target:"Set",stat:!0},{of:qr}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{addAll:function(){return function(){for(var t=U(this),e=m(t.add),n=0,r=arguments.length;n<r;n++)e.call(t,arguments[n]);return t}.apply(this,arguments)}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{deleteAll:function(){return Vr.apply(this,arguments)}});var Kr=function(t){return Set.prototype.values.call(t)};Kt({target:"Set",proto:!0,real:!0,forced:Q},{every:function(t){for(var e,n,r=U(this),i=Kr(r),o=g(t,1<arguments.length?arguments[1]:void 0,3);!(e=i.next()).done;)if(!o(n=e.value,n,r))return!1;return!0}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{difference:function(t){var e=U(this),n=new(Wr(e,Rr("Set")))(e),r=m(n.delete);return Ir(t,function(t){r.call(n,t)}),n}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{filter:function(t){for(var e,n,r=U(this),i=Kr(r),o=g(t,1<arguments.length?arguments[1]:void 0,3),a=new(Wr(r,Rr("Set"))),s=m(a.add);!(e=i.next()).done;)o(n=e.value,n,r)&&s.call(a,n);return a}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{find:function(t){for(var e,n,r=U(this),i=Kr(r),o=g(t,1<arguments.length?arguments[1]:void 0,3);!(e=i.next()).done;)if(o(n=e.value,n,r))return n}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{intersection:function(t){var e=U(this),n=new(Wr(e,Rr("Set"))),r=m(e.has),i=m(n.add);return Ir(t,function(t){r.call(e,t)&&i.call(n,t)}),n}});var Qr=Ir.BREAK;Kt({target:"Set",proto:!0,real:!0,forced:Q},{isDisjointFrom:function(t){var e=U(this),n=m(e.has);return Ir(t,function(t){if(!0===n.call(e,t))return Qr})!==Qr}});var Hr=Ir.BREAK;Kt({target:"Set",proto:!0,real:!0,forced:Q},{isSubsetOf:function(t){var e=function(t){var e=Je(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return U(e.call(t))}(this),n=U(t),r=n.has;return"function"!=typeof r&&(n=new(Rr("Set"))(t),r=m(n.has)),Ir(e,function(t){if(!1===r.call(n,t))return Hr},void 0,!1,!0)!==Hr}});var Gr=Ir.BREAK;Kt({target:"Set",proto:!0,real:!0,forced:Q},{isSupersetOf:function(t){var e=U(this),n=m(e.has);return Ir(t,function(t){if(!1===n.call(e,t))return Gr})!==Gr}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{join:function(t){for(var e,n=U(this),r=Kr(n),i=void 0===t?",":String(t),o=[];!(e=r.next()).done;)o.push(e.value);return o.join(i)}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{map:function(t){for(var e,n,r=U(this),i=Kr(r),o=g(t,1<arguments.length?arguments[1]:void 0,3),a=new(Wr(r,Rr("Set"))),s=m(a.add);!(e=i.next()).done;)s.call(a,o(n=e.value,n,r));return a}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{reduce:function(t){var e,n,r,i=U(this),o=Kr(i);if(m(t),1<arguments.length)e=arguments[1];else{if((n=o.next()).done)throw TypeError("Reduce of empty set with no initial value");e=n.value}for(;!(n=o.next()).done;)e=t(e,r=n.value,r,i);return e}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{some:function(t){for(var e,n,r=U(this),i=Kr(r),o=g(t,1<arguments.length?arguments[1]:void 0,3);!(e=i.next()).done;)if(o(n=e.value,n,r))return!0;return!1}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{symmetricDifference:function(t){var e=U(this),n=new(Wr(e,Rr("Set")))(e),r=m(n.delete),i=m(n.add);return Ir(t,function(t){r.call(n,t)||i.call(n,t)}),n}}),Kt({target:"Set",proto:!0,real:!0,forced:Q},{union:function(t){var e=U(this),n=new(Wr(e,Rr("Set")))(e);return Ir(t,m(n.add),n),n}});var zr=function(t,e){return(zr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Yr(t,e){function n(){this.constructor=t}zr(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Xr=function(){return(Xr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Jr(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function $r(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Zr(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function ti(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function ei(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ti(arguments[e]));return t}var ni={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},ri=function(t,e){if(!t)throw ii(e)},ii=function(t){return new Error("Firebase Database ("+ni.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},oi=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);e[n++]=i<128?i:(e[n++]=i<2048?i>>6|192:(55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,i>>6&63|128),63&i|128)}return e},ai=function(){function t(){this.byteToCharMap_=null,this.charToByteMap_=null,this.byteToCharMapWebSafe_=null,this.charToByteMapWebSafe_=null,this.ENCODED_VALS_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",this.HAS_NATIVE_SUPPORT="function"==typeof atob}return Object.defineProperty(t.prototype,"ENCODED_VALS",{get:function(){return this.ENCODED_VALS_BASE+"+/="},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ENCODED_VALS_WEBSAFE",{get:function(){return this.ENCODED_VALS_BASE+"-_."},enumerable:!0,configurable:!0}),t.prototype.encodeByteArray=function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},t.prototype.encodeString=function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(oi(t),e)},t.prototype.decodeString=function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(191<i&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},t.prototype.decodeStringToByteArray=function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},t.prototype.init_=function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}},t}(),si=function(t){try{return ui.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},ui=new ai;function ci(t){return li(void 0,t)}function li(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=li(t[n],e[n]));return t}var hi=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();function fi(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function pi(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fi())}function di(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function yi(){return!0===ni.NODE_ADMIN}var mi=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,gi.prototype.create),i}return Yr(e,t),e}(Error),gi=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o,a=r[0]||{},s=this.service+"/"+t,u=this.errors[t],c=u?(o=a,u.replace(vi,function(t,e){var n=o[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",l=this.serviceName+": "+c+" ("+s+").",h=new mi(s,l);try{for(var f=Zr(Object.keys(a)),p=f.next();!p.done;p=f.next()){var d=p.value;"_"!==d.slice(-1)&&(d in h&&console.warn('Overwriting FirebaseError base field "'+d+'" can cause unexpected behavior.'),h[d]=a[d])}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(e)throw e.error}}return h},t}(),vi=/\{\$([^}]+)}/g;function bi(t){return JSON.parse(t)}function wi(t){return JSON.stringify(t)}var _i=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=bi(si(o[0])||""),n=bi(si(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}};function Ti(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ei(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function Si(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ci(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}var Ii=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)a=r<40?r<20?(o=l^u&(c^l),1518500249):(o=u^c^l,1859775393):r<60?(o=u&c|l&(u|c),2400959708):(o=u^c^l,3395469782),i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;0<=i;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function Ni(t,e){var n=new Ai(t,e);return n.subscribe.bind(n)}var Ai=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){var n,r;if("object"!=typeof t||null===t)return!1;try{for(var i=Zr(["next","error","complete"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(a in t&&"function"==typeof t[a])return!0}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=ki),void 0===r.error&&(r.error=ki),void 0===r.complete&&(r.complete=ki);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function ki(){}var Di=function(t,e,n,r){var i;if(r<e?i="at least "+e:n<r&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function Ri(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+(r+" argument ")}function xi(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(Ri(t,e,r)+"must be a valid function.")}function Oi(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(Ri(t,e,r)+"must be a valid context object.")}var Pi,Mi,Li=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:55296<=r&&r<=56319?(e+=4,n++):e+=3}return e};function Fi(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function Ui(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Fi(arguments[e]));return t}(Mi=Pi||(Pi={}))[Mi.DEBUG=0]="DEBUG",Mi[Mi.VERBOSE=1]="VERBOSE",Mi[Mi.INFO=2]="INFO",Mi[Mi.WARN=3]="WARN",Mi[Mi.ERROR=4]="ERROR",Mi[Mi.SILENT=5]="SILENT";var qi,Vi=Pi.INFO,ji=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString();switch(e){case Pi.DEBUG:case Pi.VERBOSE:console.log.apply(console,Ui(["["+i+"]  "+t.name+":"],n));break;case Pi.INFO:console.info.apply(console,Ui(["["+i+"]  "+t.name+":"],n));break;case Pi.WARN:console.warn.apply(console,Ui(["["+i+"]  "+t.name+":"],n));break;case Pi.ERROR:console.error.apply(console,Ui(["["+i+"]  "+t.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},Bi=function(){function t(t){this.name=t,this._logLevel=Vi,this._logHandler=ji}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in Pi))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ui([this,Pi.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ui([this,Pi.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ui([this,Pi.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ui([this,Pi.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ui([this,Pi.ERROR],t))},t}(),Wi=((qi={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",qi["bad-app-name"]="Illegal App name: '{$appName}",qi["duplicate-app"]="Firebase App named '{$appName}' already exists",qi["app-deleted"]="Firebase App named '{$appName}' already deleted",qi["duplicate-service"]="Firebase service named '{$appName}' already registered",qi["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",qi),Ki=new gi("app","Firebase",Wi),Qi="[DEFAULT]",Hi=[],Gi=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=ci(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){Hi.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){Hi=Hi.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){var e,n,r,i;t.firebase_.INTERNAL.removeApp(t.name_);var o=[];try{for(var a=Zr(Object.keys(t.services_)),s=a.next();!s.done;s=a.next()){var u=s.value;try{for(var c=Zr(Object.keys(t.services_[u])),l=c.next();!l.done;l=c.next()){var h=l.value;o.push(t.services_[u][h])}}catch(n){r={error:n}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}}catch(n){e={error:n}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return Promise.all(o.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=Qi),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==Qi?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;li(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(Hi.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),Hi=[])},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Ki.create("app-deleted",{appName:this.name_})},t}();Gi.prototype.name&&Gi.prototype.options||Gi.prototype.delete||console.log("dc");var zi=new Bi("@firebase/app");if("object"==typeof self&&self.self===self&&void 0!==self.firebase){zi.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Yi=self.firebase.SDK_VERSION;Yi&&0<=Yi.indexOf("LITE")&&zi.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Xi=function t(){var e=function(t){var e={},n={},r={},i={__esModule:!0,initializeApp:function(n,r){(void 0===r&&(r={}),"object"!=typeof r||null===r)&&(r={name:r});var o=r;void 0===o.name&&(o.name=Qi);var a=o.name;if("string"!=typeof a||!a)throw Ki.create("bad-app-name",{appName:String(a)});if(Ti(e,a))throw Ki.create("duplicate-app",{appName:a});var u=new t(n,o,i);return s(e[a]=u,"create"),u},app:o,apps:null,SDK_VERSION:"6.3.0",INTERNAL:{registerService:function(e,s,u,c,l){if(void 0===l&&(l=!1),n[e])throw Ki.create("duplicate-service",{appName:e});function h(t){if(void 0===t&&(t=o()),"function"!=typeof t[e])throw Ki.create("invalid-app-argument",{appName:e});return t[e]()}return n[e]=s,c&&(r[e]=c,a().forEach(function(t){c("create",t)})),void 0!==u&&li(h,u),i[e]=h,t.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._getService.bind(this,e).apply(this,l?t:[])},h},removeApp:function(t){s(e[t],"delete"),delete e[t]},factories:n,useAsService:u}};function o(t){if(!Ti(e,t=t||Qi))throw Ki.create("no-app",{appName:t});return e[t]}function a(){return Object.keys(e).map(function(t){return e[t]})}function s(t,e){var i,o;try{for(var a=Zr(Object.keys(n)),s=a.next();!s.done;s=a.next()){var c=u(0,s.value);if(null===c)return;r[c]&&r[c](e,t)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}function u(t,e){return"serverAuth"===e?null:e}return i.default=i,Object.defineProperty(i,"apps",{get:a}),o.App=t,i}(Gi);return e.INTERNAL=Xr({},e.INTERNAL,{createFirebaseNamespace:t,extendNamespace:function(t){li(e,t)},createSubscribe:Ni,ErrorFactory:gi,deepExtend:li}),e}(),Ji=Xi.initializeApp;Xi.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}()&&zi.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and set "module"\n      to false and "main" to true:\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),Ji.apply(void 0,t)};var $i=Xi;(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},n="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function r(t){var e,n,r="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return r?r.call(t):{next:(e=t,n=0,function(){return n<e.length?{done:!1,value:e[n++]}:{done:!0}})}}!function(t,r){if(r){var i=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in i||(i[a]={}),i=i[a]}(r=r(o=i[t=t[t.length-1]]))!=o&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function i(){this.a=null}function o(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;i.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var a=n.setTimeout;i.prototype.c=function(t){a(t,0)},i.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},i.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.o),reject:t(this.g)}},e.prototype.o=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.u(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.l(t):this.h(t)}},e.prototype.l=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.v(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.m()},e.prototype.m=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new i;return e.prototype.u=function(t){var e=this.f();t.Ja(e.resolve,e.reject)},e.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(e){o(e)}}:e}var i,o,a=new e(function(t,e){i=t,o=e});return this.Ja(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ja=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=o,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=r(t),a=i.next();!a.done;a=i.next())o(a.value).Ja(e,n)})},e.all=function(t){var n=r(t),i=n.next();return i.done?o([]):new e(function(t,e){function r(e){return function(n){a[e]=n,0==--s&&t(a)}}for(var a=[],s=0;a.push(void 0),s++,o(i.value).Ja(r(a.length-1),e),!(i=n.next()).done;);})},e});var i=i||{},o=this;function a(t){return"string"==typeof t}function s(t){return"boolean"==typeof t}var u=/^[\w+\/_-]+[=]{0,2}$/,c=null;function l(){}function h(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function f(t){return null===t}function p(t){return"array"==h(t)}function d(t){var e=h(t);return"array"==e||"object"==e&&"number"==typeof t.length}function y(t){return"function"==h(t)}function m(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var g="closure_uid_"+(1e9*Math.random()>>>0),v=0;function b(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:w).apply(null,arguments)}function T(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now||function(){return+new Date};function S(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,(t.prototype.constructor=t).cd=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function C(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function I(t){if(Error.captureStackTrace)Error.captureStackTrace(this,I);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function N(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");I.call(this,n+t[r])}function A(t,e){throw new N("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function k(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function D(t,e){t.f(e),t.b<100&&(t.b++,e.next=t.a,t.a=e)}function R(){this.b=this.a=null}S(I,Error),I.prototype.name="CustomError",S(N,I),N.prototype.name="AssertionError",k.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var x=new k(function(){return new O},function(t){t.reset()});function O(){this.next=this.b=this.a=null}R.prototype.add=function(t,e){var n=x.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},O.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},O.prototype.reset=function(){this.next=this.b=this.a=null};var P=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(a(t))return a(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},M=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=a(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},L=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=a(t)?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},F=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=a(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function U(t,e){return 0<=P(t,e)}function q(t,e){var n;return(n=0<=(e=P(t,e)))&&Array.prototype.splice.call(t,e,1),n}function V(t,e){!function(t,e){for(var n=a(t)?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length})}function j(t){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var W,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Q=/&/g,H=/</g,G=/>/g,z=/"/g,Y=/'/g,X=/\x00/g,J=/[\x00&<>"']/;function $(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var tt=o.navigator;if(tt){var et=tt.userAgent;if(et){W=et;break t}}W=""}function nt(t){return $(W,t)}function rt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function it(t){for(var e in t)return!1;return!0}function ot(t){var e,n={};for(e in t)n[e]=t[e];return n}var at,st,ut="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ct(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ut.length;o++)n=ut[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function lt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function ht(t){return J.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(Q,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(H,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(G,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(z,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(Y,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(X,"&#0;"))),t}function ft(t){o.setTimeout(function(){throw t},0)}function pt(t,e){st||function(){if(o.Promise&&o.Promise.resolve){var t=o.Promise.resolve(void 0);st=function(){t.then(mt)}}else st=function(){var t=mt;!y(o.setImmediate)||o.Window&&o.Window.prototype&&!nt("Edge")&&o.Window.prototype.setImmediate==o.setImmediate?(at||(at=function(){var t=o.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!nt("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=_(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0===t||nt("Trident")||nt("MSIE"))return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){o.setTimeout(t,0)};var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}()),at(t)):o.setImmediate(t)}}(),dt||(st(),dt=!0),yt.add(t,e)}var dt=!1,yt=new R;function mt(){for(var t;n=e=void 0,n=null,(e=yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){ft(t)}D(x,t)}var e,n;dt=!1}function gt(t,e){if(this.a=vt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=l)try{var n=this;t.call(e,function(t){Dt(n,bt,t)},function(t){if(!(t instanceof Ft))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Dt(n,wt,t)})}catch(t){Dt(this,wt,t)}}var vt=0,bt=2,wt=3;function _t(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}_t.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Tt=new k(function(){return new _t},function(t){t.reset()});function Et(t,e,n){var r=Tt.get();return r.g=t,r.b=e,r.f=n,r}function St(t){if(t instanceof gt)return t;var e=new gt(l);return Dt(e,bt,t),e}function Ct(t){return new gt(function(e,n){n(t)})}function It(t,e,n){Rt(t,e,n,null)||pt(T(e,t))}function Nt(t){return new gt(function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Eb:!0,value:o}:{Eb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)It(t[o],T(i,o,!0),T(i,o,!1));else e(r)})}function At(t,e){t.b||t.a!=bt&&t.a!=wt||xt(t),t.f?t.f.next=e:t.b=e,t.f=e}function kt(t,e,n,r){var i=Et(null,null,null);return i.a=new gt(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(n){o(n)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Ft?o(e):t(i)}catch(e){o(e)}}:o}),At(i.a.c=t,i),i.a}function Dt(t,e,n){var r,i;t.a==vt&&(t===n&&(e=wt,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Rt(n,t.Lc,t.Mc,t)||(t.i=n,t.a=e,t.c=null,xt(t),e!=wt||n instanceof Ft||(i=n,(r=t).g=!0,pt(function(){r.g&&Lt.call(null,i)}))))}function Rt(t,e,n,r){if(t instanceof gt)return At(t,Et(e||l,n||null,r)),!0;if(C(t))return t.then(e,n,r),!0;if(m(t))try{var i=t.then;if(y(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(i,t))},o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function xt(t){t.h||(t.h=!0,pt(t.Wb,t))}function Ot(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Pt(t,e,n,r){if(n==wt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Mt(e,n,r);else try{e.c?e.g.call(e.f):Mt(e,n,r)}catch(t){Lt.call(null,t)}D(Tt,e)}function Mt(t,e,n){e==bt?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}gt.prototype.then=function(t,e,n){return kt(this,y(t)?t:null,y(e)?e:null,n)},gt.prototype.$goog_Thenable=!0,(t=gt.prototype).ia=function(t,e){return(t=Et(t,t,e)).c=!0,At(this,t),this},t.s=function(t,e){return kt(this,null,t,e)},t.cancel=function(t){this.a==vt&&pt(function(){!function t(e,n){if(e.a==vt)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==vt&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):Ot(r),Pt(r,o,wt,n)))}e.c=null}else Dt(e,wt,n)}(this,new Ft(t))},this)},t.Lc=function(t){this.a=vt,Dt(this,bt,t)},t.Mc=function(t){this.a=vt,Dt(this,wt,t)},t.Wb=function(){for(var t;t=Ot(this);)Pt(this,t,this.a,this.i);this.h=!1};var Lt=ft;function Ft(t){I.call(this,t)}function Ut(){this.qa=this.qa,this.ja=this.ja}S(Ft,I);var qt=0;function Vt(t){t.qa||(t.qa=!0,t.va(),0==qt)||t[g]||(t[g]=++v)}function jt(t){return jt[" "](t),t}Ut.prototype.qa=!(Ft.prototype.name="cancel"),Ut.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},jt[" "]=l;var Bt,Wt,Kt=nt("Opera"),Qt=nt("Trident")||nt("MSIE"),Ht=nt("Edge"),Gt=Ht||Qt,zt=nt("Gecko")&&!($(W.toLowerCase(),"webkit")&&!nt("Edge"))&&!(nt("Trident")||nt("MSIE"))&&!nt("Edge"),Yt=$(W.toLowerCase(),"webkit")&&!nt("Edge");function Xt(){var t=o.document;return t?t.documentMode:void 0}t:{var Jt="",$t=(Wt=W,zt?/rv:([^\);]+)(\)|;)/.exec(Wt):Ht?/Edge\/([\d\.]+)/.exec(Wt):Qt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Wt):Yt?/WebKit\/(\S+)/.exec(Wt):Kt?/(?:Version)[ \/]?(\S+)/.exec(Wt):void 0);if($t&&(Jt=$t?$t[1]:""),Qt){var Zt=Xt();if(null!=Zt&&Zt>parseFloat(Jt)){Bt=String(Zt);break t}}Bt=Jt}var te,ee={};function ne(t){return e=t,n=function(){for(var e=0,n=K(String(Bt)).split("."),r=K(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=Z(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==a[2].length,0==s[2].length)||Z(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e},r=ee,Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=n();var e,n,r}var re=o.document;te=re&&Qt?Xt()||("CSS1Compat"==re.compatMode?parseInt(Bt,10):5):void 0;var ie=Object.freeze||function(t){return t},oe=!Qt||9<=Number(te),ae=Qt&&!ne("9"),se=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{o.addEventListener("test",l,e),o.removeEventListener("test",l,e)}catch(t){}return t}();function ue(t,e){this.type=t,this.b=this.target=e,this.Kb=!0}function ce(t,e){if(ue.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(zt){t:{try{jt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,this.screenY=r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=a(t.pointerType)?t.pointerType:le[t.pointerType]||"",(this.a=t).defaultPrevented&&this.preventDefault()}}ue.prototype.preventDefault=function(){this.Kb=!1},S(ce,ue);var le=ie({2:"touch",3:"pen",4:"mouse"});ce.prototype.preventDefault=function(){ce.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ae)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}},ce.prototype.f=function(){return this.a};var he="closure_listenable_"+(1e6*Math.random()|0),fe=0;function pe(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Na=i,this.key=++fe,this.oa=this.Ia=!1}function de(t){t.oa=!0,t.listener=null,t.proxy=null,t.src=null,t.Na=null}function ye(t){this.src=t,this.a={},this.b=0}function me(t,e){var n=e.type;n in t.a&&q(t.a[n],e)&&(de(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function ge(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.oa&&o.listener==e&&o.capture==!!n&&o.Na==r)return i}return-1}ye.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ge(t,e,r,i);return-1<a?(e=t[a],n||(e.Ia=!1)):((e=new pe(e,this.src,o,!!r,i)).Ia=n,t.push(e)),e};var ve="closure_lm_"+(1e6*Math.random()|0),be={};function we(t,e,n,r,i){if(r&&r.once)Te(t,e,n,r,i);else if(p(e))for(var o=0;o<e.length;o++)we(t,e[o],n,r,i);else n=Re(n),t&&t[he]?Oe(t,e,n,m(r)?!!r.capture:!!r,i):_e(t,e,n,!1,r,i)}function _e(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a,s,u=m(i)?!!i.capture:!!i,c=ke(t);if(c||(t[ve]=c=new ye(t)),!(n=c.add(e,n,r,u,o)).proxy)if(a=Ae,r=s=oe?function(t){return a.call(s.src,s.listener,t)}:function(t){if(!(t=a.call(s.src,s.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)se||(i=u),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ce(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function Te(t,e,n,r,i){if(p(e))for(var o=0;o<e.length;o++)Te(t,e[o],n,r,i);else n=Re(n),t&&t[he]?Pe(t,e,n,m(r)?!!r.capture:!!r,i):_e(t,e,n,!0,r,i)}function Ee(t,e,n,r,i){if(p(e))for(var o=0;o<e.length;o++)Ee(t,e[o],n,r,i);else r=m(r)?!!r.capture:!!r,n=Re(n),t&&t[he]?(t=t.m,(e=String(e).toString())in t.a&&-1<(n=ge(o=t.a[e],n,r,i))&&(de(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=ke(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ge(e,n,r,i)),(n=-1<t?e[t]:null)&&Se(n))}function Se(t){if("number"!=typeof t&&t&&!t.oa){var e=t.src;if(e&&e[he])me(e.m,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ce(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ke(e))?(me(n,t),0==n.b&&(n.src=null,e[ve]=null)):de(t)}}}function Ce(t){return t in be?be[t]:be[t]="on"+t}function Ie(t,e,n,r){var i=!0;if((t=ke(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.oa&&(o=Ne(o,r),i=i&&!1!==o)}return i}function Ne(t,e){var n=t.listener,r=t.Na||t.src;return t.Ia&&Se(t),n.call(r,e)}function Ae(t,e){if(t.oa)return!0;if(oe)return Ne(t,new ce(e,this));if(!e)t:{e=["window","event"];for(var n=o,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new ce(r=e,this),n=!0,!(r.keyCode<0||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var a=Ie(r[i],t,!0,e);n=n&&a}for(i=0;i<r.length;i++)e.b=r[i],a=Ie(r[i],t,!1,e),n=n&&a}return n}function ke(t){return(t=t[ve])instanceof ye?t:null}var De="__closure_events_fn_"+(1e9*Math.random()>>>0);function Re(t){return y(t)?t:(t[De]||(t[De]=function(e){return t.handleEvent(e)}),t[De])}function xe(){Ut.call(this),this.m=new ye(this),(this.Pb=this).Wa=null}function Oe(t,e,n,r,i){t.m.add(String(e),n,!1,r,i)}function Pe(t,e,n,r,i){t.m.add(String(e),n,!0,r,i)}function Me(t,e,n,r){if(!(e=t.m.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.oa&&a.capture==n){var s=a.listener,u=a.Na||a.src;a.Ia&&me(t.m,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Kb}function Le(t,e,n){if(y(t))n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:o.setTimeout(t,e||0)}function Fe(t){var e=null;return new gt(function(n,r){-1==(e=Le(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).s(function(t){throw o.clearTimeout(e),t})}function Ue(t){if(t.S&&"function"==typeof t.S)return t.S();if(a(t))return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function qe(t){if(t.U&&"function"==typeof t.U)return t.U();if(!t.S||"function"!=typeof t.S){if(d(t)||a(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Ve(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ve)for(n=t.U(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function je(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(xe,Ut),xe.prototype[he]=!0,xe.prototype.addEventListener=function(t,e,n,r){we(this,t,e,n,r)},xe.prototype.removeEventListener=function(t,e,n,r){Ee(this,t,e,n,r)},xe.prototype.dispatchEvent=function(t){var e,n=this.Wa;if(n)for(e=[];n;n=n.Wa)e.push(n);n=this.Pb;var r=t.type||t;if(a(t))t=new ue(t,n);else if(t instanceof ue)t.target=t.target||n;else{var i=t;ct(t=new ue(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=Me(s,r,!0,t)&&i}if(i=Me(s=t.b=n,r,!0,t)&&i,i=Me(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Me(s=t.b=e[o],r,!1,t)&&i;return i},xe.prototype.va=function(){if(xe.qb.va.call(this),this.m){var t,e=this.m;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)de(n[r]);delete e.a[t],e.b--}}this.Wa=null},(t=Ve.prototype).S=function(){je(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.U=function(){return je(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Be(this.b,t)?this.b[t]:e},t.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.b=this.i=this.f="",this.m=null,this.g=this.c="",this.h=!1,t instanceof Ke?(this.h=void 0!==e?e:t.h,Qe(this,t.f),this.i=t.i,this.b=t.b,He(this,t.m),this.c=t.c,Ge(this,pn(t.a)),this.g=t.g):t&&(n=String(t).match(We))?(this.h=!!e,Qe(this,n[1]||"",!0),this.i=$e(n[2]||""),this.b=$e(n[3]||"",!0),He(this,n[4]),this.c=$e(n[5]||"",!0),Ge(this,n[6]||"",!0),this.g=$e(n[7]||"")):(this.h=!!e,this.a=new sn(null,this.h))}function Qe(t,e,n){t.f=n?$e(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function He(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ge(t,e,n){var r,i;e instanceof sn?(t.a=e,r=t.a,(i=t.h)&&!r.f&&(un(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=Ze(e,on)),t.a=new sn(e,t.h))}function ze(t,e,n){t.a.set(e,n)}function Ye(t,e){return t.a.get(e)}function Xe(t){return t instanceof Ke?new Ke(t):new Ke(t,void 0)}function Je(t,e){var n=new Ke(null,void 0);return Qe(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return a(t)?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ze(e,en,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Ze(n,an)),t.join("")},Ke.prototype.resolve=function(t){var e=new Ke(this),n=!!t.f;n?Qe(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.m;var r=t.c;if(n)He(e,t.m);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if($(i,"./")||$(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?Ge(e,pn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,an=/#/g;function sn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function un(t){t.a||(t.a=new Ve,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function cn(t){var e=qe(t);if(void 0===e)throw Error("Keys are undefined");var n=new sn(null,void 0);t=Ue(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];p(o)?fn(n,i,o):n.add(i,o)}return n}function ln(t,e){un(t),e=dn(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&je(t)))}function hn(t,e){return un(t),e=dn(t,e),Be(t.a.b,e)}function fn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(dn(t,e),B(n)),t.b+=n.length)}function pn(t){var e=new sn;return e.c=t.c,t.a&&(e.a=new Ve(t.a),e.b=t.b),e}function dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(t=sn.prototype).add=function(t,e){un(this),this.c=null,t=dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){un(this),this.a.forEach(function(n,r){M(n,function(n){t.call(e,n,r,this)},this)},this)},t.U=function(){un(this);for(var t=this.a.S(),e=this.a.U(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.S=function(t){un(this);var e=[];if(a(t))hn(this,t)&&(e=j(e,this.a.get(dn(this,t))));else{t=this.a.S();for(var n=0;n<t.length;n++)e=j(e,t[n])}return e},t.set=function(t,e){return un(this),this.c=null,hn(this,t=dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.S(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var yn=!Qt||9<=Number(te);function mn(t,e){this.a=t===bn&&e||"",this.b=vn}function gn(t){return t instanceof mn&&t.constructor===mn&&t.b===vn?t.a:(A("expected object of type Const, got '"+t+"'"),"type_error:Const")}mn.prototype.na=!0,mn.prototype.ma=function(){return this.a},mn.prototype.toString=function(){return"Const{"+this.a+"}"};var vn={},bn={};function wn(){this.a="",this.b=Cn}function _n(t){return t instanceof wn&&t.constructor===wn&&t.b===Cn?t.a:(A("expected object of type TrustedResourceUrl, got '"+t+"' of type "+h(t)),"type_error:TrustedResourceUrl")}function Tn(t,e){var n,r,i=gn(t);if(!Sn.test(i))throw Error("Invalid TrustedResourceUrl format: "+i);return n=t=i.replace(En,function(t,n){if(!Object.prototype.hasOwnProperty.call(e,n))throw Error('Found marker, "'+n+'", in format string, "'+i+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[n])instanceof mn?gn(t):encodeURIComponent(String(t))}),(r=new wn).a=n,r}wn.prototype.na=!0,wn.prototype.ma=function(){return this.a.toString()},wn.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var En=/%{(\w+)}/g,Sn=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^\/\\]|[^:\/\\%]+\/|[^:\/\\%]*[?#]|about:blank#)/i,Cn={};function In(){this.a="",this.b=Dn}function Nn(t){return t instanceof In&&t.constructor===In&&t.b===Dn?t.a:(A("expected object of type SafeUrl, got '"+t+"' of type "+h(t)),"type_error:SafeUrl")}In.prototype.na=!0,In.prototype.ma=function(){return this.a.toString()},In.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var An=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i;function kn(t){return t instanceof In?t:(t="object"==typeof t&&t.na?t.ma():String(t),An.test(t)||(t="about:invalid#zClosurez"),Rn(t))}var Dn={};function Rn(t){var e=new In;return e.a=t,e}function xn(){this.a="",this.b=On}Rn("about:blank"),xn.prototype.na=!0,xn.prototype.ma=function(){return this.a.toString()},xn.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var On={};function Pn(t){var e=new xn;return e.a=t,e}function Mn(t){var e=document;return a(t)?e.getElementById(t):t}function Ln(t,e){rt(e,function(e,n){e&&"object"==typeof e&&e.na&&(e=e.ma()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Fn.hasOwnProperty(n)?t.setAttribute(Fn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}Pn("<!DOCTYPE html>"),Pn(""),Pn("<br>");var Fn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Un(t){if(t&&"number"==typeof t.length){if(m(t))return"function"==typeof t.item||"string"==typeof t.item;if(y(t))return"function"==typeof t.item}return!1}function qn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(p(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),Wn(i,r),r.push(":"),t(e,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":Wn(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Vn,t,e),e.join("")}function Vn(){}var jn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Bn=/\uffff/.test("ï¿¿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Wn(t,e){e.push('"',t.replace(Bn,function(t){var e=jn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),jn[t]=e),e}),'"')}function Kn(){var t=cr();return Qt&&!!te&&11==te||/Edge\/\d+/.test(t)}function Qn(){return o.window&&o.window.location.href||self&&self.location&&self.location.href||""}function Hn(t,e){e=e||o.window;var n="about:blank";t&&(n=Nn(kn(t)).toString()),e.location.href=n}function Gn(t){return!!((t=(t||cr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function zn(t){t=t||o.window;try{t.close()}catch(t){}}function Yn(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=cr().toLowerCase(),r&&(e.target=r,$(n,"crios/")&&(e.target="_blank")),ar(cr())==ir&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof In?n:kn(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var a,s=i.join(",");if((nt("iPhone")&&!nt("iPod")&&!nt("iPad")||nt("iPad")||nt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(s=r.document.createElement("A"),e instanceof In||e instanceof In||(e="object"==typeof e&&e.na?e.ma():String(e),An.test(e)||(e="about:invalid#zClosurez"),e=Rn(e)),s.href=Nn(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=r.open("",n,s),t=Nn(e).toString(),s&&(Gt&&$(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t=Pn('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+ht(t)+'">'),s.document.write((a=t)instanceof xn&&a.constructor===xn&&a.b===On?a.a:(A("expected object of type SafeHtml, got '"+a+"' of type "+h(a)),"type_error:SafeHtml")),s.document.close())):(s=r.open(Nn(e).toString(),n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(t){}return s}var Xn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Jn=/^[^@]+@[^@]+$/;function $n(){var t=null;return new gt(function(e){"complete"==o.document.readyState?e():(t=function(){e()},Te(window,"load",t))}).s(function(e){throw Ee(window,"load",t),e})}function Zn(t){return t=t||cr(),!("file:"!==dr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function tr(){var t=o.window;try{return!(!t||t==t.top)}catch(t){return!1}}function er(){return void 0!==o.WorkerGlobalScope&&"function"==typeof o.importScripts}function nr(){return $i.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":$i.INTERNAL.hasOwnProperty("node")?"Node":er()?"Worker":"Browser"}function rr(){var t=nr();return"ReactNative"===t||"Node"===t}var ir="Firefox",or="Chrome";function ar(t){var e=t.toLowerCase();return $(e,"opera/")||$(e,"opr/")||$(e,"opios/")?"Opera":$(e,"iemobile")?"IEMobile":$(e,"msie")||$(e,"trident/")?"IE":$(e,"edge/")?"Edge":$(e,"firefox/")?ir:$(e,"silk/")?"Silk":$(e,"blackberry")?"Blackberry":$(e,"webos")?"Webos":!$(e,"safari/")||$(e,"chrome/")||$(e,"crios/")||$(e,"android")?!$(e,"chrome/")&&!$(e,"crios/")||$(e,"edge/")?$(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":or:"Safari"}var sr={Sc:"FirebaseCore-web",Uc:"FirebaseUI-web"};function ur(t,e){e=e||[];var n,r=[],i={};for(n in sr)i[sr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=nr())?r=ar(i=cr()):"Worker"===r&&(r=ar(i=cr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function cr(){return o.navigator&&o.navigator.userAgent||""}function lr(t,e){t=t.split("."),e=e||o;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function hr(){try{var t=o.localStorage,e=br();if(t)return t.setItem(e,"1"),t.removeItem(e),!Kn()||!!o.indexedDB}catch(t){return er()&&!!o.indexedDB}return!1}function fr(){return(pr()||"chrome-extension:"===dr()||Zn())&&!rr()&&hr()&&!er()}function pr(){return"http:"===dr()||"https:"===dr()}function dr(){return o.location&&o.location.protocol||null}function yr(t){return!Gn(t=t||cr())&&ar(t)!=ir}function mr(t){return void 0===t?null:qn(t)}function gr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function vr(t){if(null!==t)return JSON.parse(t)}function br(t){return t||Math.floor(1e9*Math.random()).toString()}function wr(t){return"Safari"!=ar(t=t||cr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function _r(){var t=o.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Tr(t,e){if(e<t)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=cr(),e=nr(),this.b=Gn(t)||"ReactNative"===e}function Er(){var t=o.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Sr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Cr(){return!(!lr("fireauth.oauthhelper",o)&&!lr("fireauth.iframe",o))}Tr.prototype.get=function(){var t=o.navigator;return!t||"boolean"!=typeof t.onLine||!pr()&&"chrome-extension:"!==dr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Ir,Nr={};function Ar(t){Nr[t]||(Nr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var kr={};Object.defineProperty(kr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(kr,"abcd",{configurable:!0,enumerable:!0,value:2}),Ir=2==kr.abcd}catch(t){Ir=!1}function Dr(t,e,n){Ir?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Rr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Dr(t,n,e[n])}function xr(t){var e={};return Rr(e,t),e}function Or(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Dr(e,n,Or(t[n]));return e}function Pr(t){var e={},n=t[Lr],r=t[Fr];if(!(t=t[Ur])||t!=Mr&&!n)throw Error("Invalid provider user info!");e[Vr]=r||null,e[qr]=n||null,Dr(this,Br,t),Dr(this,jr,Or(e))}var Mr="EMAIL_SIGNIN",Lr="email",Fr="newEmail",Ur="requestType",qr="email",Vr="fromEmail",jr="data",Br="operation";function Wr(t,e){this.code=Qr+t,this.message=e||Hr[t]||""}function Kr(t){var e=t&&t.code;return e?new Wr(e.substring(Qr.length),t.message):null}S(Wr,Error),Wr.prototype.w=function(){return{code:this.code,message:this.message}},Wr.prototype.toJSON=function(){return this.w()};var Qr="auth/",Hr={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The OIDC ID token requires a valid unhashed nonce.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Gr(t){var e=t[$r];if(void 0===e)throw new Wr("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Wr("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[zr];if(n&&"object"==typeof n){e=n[ei];var r=n[Zr];if(n=n[ti],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new Wr("argument-error",Zr+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Wr("argument-error",ti+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new Wr("argument-error",ei+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Wr("missing-android-pkg-name")}}else if(void 0!==n)throw new Wr("argument-error",zr+" property must be a non null object when specified.");if(this.f=null,(e=t[Jr])&&"object"==typeof e){if("string"==typeof(e=e[ni])&&e.length)this.f=e;else if(void 0!==e)throw new Wr("argument-error",ni+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Wr("argument-error",Jr+" property must be a non null object when specified.");if(void 0!==(e=t[Xr])&&"boolean"!=typeof e)throw new Wr("argument-error",Xr+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Yr])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new Wr("argument-error",Yr+" property must be a non empty string when specified.");this.i=t||null}var zr="android",Yr="dynamicLinkDomain",Xr="handleCodeInApp",Jr="iOS",$r="url",Zr="installApp",ti="minimumVersion",ei="packageName",ni="bundleId";function ri(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var ii=null,oi=null;function ai(t){this.c=t.sub,this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function si(t){return(t=ui(t))&&t.sub&&t.iss&&t.aud&&t.exp?new ai(t):null}function ui(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(function(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=oi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!ii){ii={},oi={};for(var t=0;t<65;t++)ii[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),62<=(oi[ii[t]]=t)&&(oi["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}(t))}catch(t){}return null}ai.prototype.f=function(){return this.b};var ci,li={Yc:{bb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",jb:"https://securetoken.googleapis.com/v1/token",id:"p"},$c:{bb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",jb:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ad:{bb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",jb:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function hi(t){for(var e in li)if(li[e].id===t)return{firebaseEndpoint:(t=li[e]).bb,secureTokenEndpoint:t.jb};return null}ci=hi("__EID__")?"__EID__":void 0;var fi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),pi=["client_id","response_type","scope","redirect_uri","state"],di={Tc:{Oa:"locale",Ba:500,Aa:600,Pa:"facebook.com",ib:pi},Vc:{Oa:null,Ba:500,Aa:620,Pa:"github.com",ib:pi},Wc:{Oa:"hl",Ba:515,Aa:680,Pa:"google.com",ib:pi},bd:{Oa:"lang",Ba:485,Aa:705,Pa:"twitter.com",ib:fi}};function yi(t){for(var e in di)if(di[e].Pa==t)return di[e];return null}function mi(t){var e={};e["facebook.com"]=_i,e["google.com"]=Ei,e["github.com"]=Ti,e["twitter.com"]=Si;var n=t&&t[vi];try{if(n)return e[n]?new e[n](t):new wi(t);if(void 0!==t[gi])return new bi(t)}catch(t){}return null}var gi="idToken",vi="providerId";function bi(t){var e=t[vi];if(!e&&t[gi]){var n=si(t[gi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Dr(this,"providerId",e),Dr(this,"isNewUser",n)}function wi(t){bi.call(this,t),Dr(this,"profile",Or((t=vr(t.rawUserInfo||"{}"))||{}))}function _i(t){if(wi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Ti(t){if(wi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Dr(this,"username",this.profile&&this.profile.login||null)}function Ei(t){if(wi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Si(t){if(wi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Dr(this,"username",t.screenName||null)}function Ci(t){this.a=Xe(t)}function Ii(t){var e=Xe(t),n=Ye(e,"link"),r=Ye(Xe(n),"link");return Ye(Xe(e=Ye(e,"deep_link_id")),"link")||e||r||n||t}function Ni(){}function Ai(t,e){return t.then(function(t){if(t[ga]){var n=si(t[ga]);if(!n||e!=n.c)throw new Wr("user-mismatch");return t}throw new Wr("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==Qr+"user-not-found"?new Wr("user-mismatch"):t})}function ki(t,e){if(!e)throw new Wr("internal-error","failed to construct a credential");this.a=e,Dr(this,"providerId",t),Dr(this,"signInMethod",t)}function Di(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Ri(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new ki(t.providerId,t.pendingToken)}catch(t){}return null}function xi(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Dr(this,"idToken",e.idToken),e.accessToken&&Dr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Dr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Wr("internal-error","failed to construct a credential");Dr(this,"accessToken",e.oauthToken),Dr(this,"secret",e.oauthTokenSecret)}Dr(this,"providerId",t),Dr(this,"signInMethod",n)}function Oi(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:cn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Pi(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new xi(t.providerId,e,t.signInMethod)}catch(t){}}return null}function Mi(t,e){this.Cc=e||[],Rr(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(yi(t)||{}).Oa||null,this.ab=null}function Li(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new Wr("argument-error",'SAML provider IDs must be prefixed with "saml."');Mi.call(this,t,[])}function Fi(t){Mi.call(this,t,pi),this.a=[]}function Ui(){Fi.call(this,"facebook.com")}function qi(t){if(!t)throw new Wr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return m(t)&&(e=t.accessToken),(new Ui).credential({accessToken:e})}function Vi(){Fi.call(this,"github.com")}function ji(t){if(!t)throw new Wr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return m(t)&&(e=t.accessToken),(new Vi).credential({accessToken:e})}function Bi(){Fi.call(this,"google.com"),this.ua("profile")}function Wi(t,e){var n=t;return m(t)&&(n=t.idToken,e=t.accessToken),(new Bi).credential({idToken:n,accessToken:e})}function Ki(){Mi.call(this,"twitter.com",fi)}function Qi(t,e){var n=t;if(m(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Wr("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new xi("twitter.com",n,"twitter.com")}function Hi(t,e,n){this.a=t,this.c=e,Dr(this,"providerId","password"),Dr(this,"signInMethod",n===zi.EMAIL_LINK_SIGN_IN_METHOD?zi.EMAIL_LINK_SIGN_IN_METHOD:zi.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Gi(t){return t&&t.email&&t.password?new Hi(t.email,t.password,t.signInMethod):null}function zi(){Rr(this,{providerId:"password",isOAuthProvider:!1})}function Yi(t,e){if(!(e=Xi(e)))throw new Wr("argument-error","Invalid email link!");return new Hi(t,e,zi.EMAIL_LINK_SIGN_IN_METHOD)}function Xi(t){var e=Ye((t=new Ci(t=Ii(t))).a,"oobCode")||null;return"signIn"===(Ye(t.a,"mode")||null)&&e?e:null}function Ji(t){if(!(t.Ua&&t.Ta||t.Fa&&t.$))throw new Wr("internal-error");this.a=t,Dr(this,"providerId","phone"),Dr(this,"signInMethod","phone")}function Zi(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return M(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new Ji(e)}return null}function to(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Ua,code:t.a.Ta}}function eo(t){try{this.a=t||$i.auth()}catch(t){throw new Wr("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Rr(this,{providerId:"phone",isOAuthProvider:!1})}function no(t,e){if(!t)throw new Wr("missing-verification-id");if(!e)throw new Wr("missing-verification-code");return new Ji({Ua:t,Ta:e})}function ro(t){if(t.temporaryProof&&t.phoneNumber)return new Ji({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Wi(o,n);case"facebook.com":return qi(n);case"github.com":return ji(n);case"twitter.com":return Qi(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new ki(e,a):new xi(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Fi(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function io(t){if(!t.isOAuthProvider)throw new Wr("invalid-oauth-provider")}function oo(t,e,n,r,i,o){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.h=o||null,this.a=i||null,!this.g&&!this.a)throw new Wr("invalid-auth-event");if(this.g&&this.a)throw new Wr("invalid-auth-event");if(this.g&&!this.f)throw new Wr("invalid-auth-event")}function ao(t){return(t=t||{}).type?new oo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Kr(t.error),t.postBody):null}function so(){this.b=null,this.a=[]}S(wi,bi),S(_i,wi),S(Ti,wi),S(Ei,wi),S(Si,wi),ki.prototype.la=function(t){return Ma(t,Di(this))},ki.prototype.b=function(t,e){var n=Di(this);return n.idToken=e,La(t,n)},ki.prototype.f=function(t,e){return Ai(Fa(t,Di(this)),e)},ki.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},xi.prototype.la=function(t){return Ma(t,Oi(this))},xi.prototype.b=function(t,e){var n=Oi(this);return n.idToken=e,La(t,n)},xi.prototype.f=function(t,e){return Ai(Fa(t,Oi(this)),e)},xi.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Mi.prototype.Da=function(t){return this.zb=ot(t),this},S(Li,Mi),S(Fi,Mi),Fi.prototype.ua=function(t){return U(this.a,t)||this.a.push(t),this},Fi.prototype.Fb=function(){return B(this.a)},Fi.prototype.credential=function(t,e){var n;if(!(n=m(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new Wr("argument-error","credential failed: must provide the ID token and/or the access token.");return new xi(this.providerId,n,this.providerId)},S(Ui,Fi),Dr(Ui,"PROVIDER_ID","facebook.com"),Dr(Ui,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(Vi,Fi),Dr(Vi,"PROVIDER_ID","github.com"),Dr(Vi,"GITHUB_SIGN_IN_METHOD","github.com"),S(Bi,Fi),Dr(Bi,"PROVIDER_ID","google.com"),Dr(Bi,"GOOGLE_SIGN_IN_METHOD","google.com"),S(Ki,Mi),Dr(Ki,"PROVIDER_ID","twitter.com"),Dr(Ki,"TWITTER_SIGN_IN_METHOD","twitter.com"),Hi.prototype.la=function(t){return this.signInMethod==zi.EMAIL_LINK_SIGN_IN_METHOD?fs(t,Qa,{email:this.a,oobCode:this.c}):fs(t,us,{email:this.a,password:this.c})},Hi.prototype.b=function(t,e){return this.signInMethod==zi.EMAIL_LINK_SIGN_IN_METHOD?fs(t,Ha,{idToken:e,email:this.a,oobCode:this.c}):fs(t,ns,{idToken:e,email:this.a,password:this.c})},Hi.prototype.f=function(t,e){return Ai(this.la(t),e)},Hi.prototype.w=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Rr(zi,{PROVIDER_ID:"password"}),Rr(zi,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Rr(zi,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Ji.prototype.la=function(t){return t.Va(to(this))},Ji.prototype.b=function(t,e){var n=to(this);return n.idToken=e,fs(t,ls,n)},Ji.prototype.f=function(t,e){var n=to(this);return n.operation="REAUTH",Ai(t=fs(t,hs,n),e)},Ji.prototype.w=function(){var t={providerId:"phone"};return this.a.Ua&&(t.verificationId=this.a.Ua),this.a.Ta&&(t.verificationCode=this.a.Ta),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},eo.prototype.Va=function(t,e){var n=this.a.c;return St(e.verify()).then(function(r){if(!a(r))throw new Wr("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return(i=n,o={phoneNumber:t,recaptchaToken:r},fs(i,ts,o)).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new Wr("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}var i,o})},Rr(eo,{PROVIDER_ID:"phone"}),Rr(eo,{PHONE_SIGN_IN_METHOD:"phone"}),oo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.i&&t.push(this.i),t.join("-")},oo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.h,error:this.a&&this.a.w()}};var uo,co=null;function lo(t){var e="unauthorized-domain",n=void 0,r=Xe(t);t=r.b,"chrome-extension"==(r=r.f)?n=lt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=lt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Wr.call(this,e,n)}function ho(t,e,n){Wr.call(this,t,n),(t=e||{}).Ab&&Dr(this,"email",t.Ab),t.$&&Dr(this,"phoneNumber",t.$),t.credential&&Dr(this,"credential",t.credential)}function fo(t){if(t.code){var e=t.code||"";0==e.indexOf(Qr)&&(e=e.substring(Qr.length));var n={credential:ro(t)};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.$=t.phoneNumber;else if(!n.credential)return new Wr(e,t.message||void 0);return new ho(e,n,t.message)}return null}function po(){}function yo(t){return t.c||(t.c=t.b())}function mo(){}function go(t){if(t.f||"undefined"!=typeof XMLHttpRequest||"undefined"==typeof ActiveXObject)return t.f;for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}function vo(){}function bo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=_(this.cc,this),this.a.onerror=_(this.Gb,this),this.a.onprogress=_(this.dc,this),this.a.ontimeout=_(this.hc,this)}function wo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function _o(t,e,n){this.reset(t,e,n,void 0,void 0)}function To(t){this.f=t,this.b=this.c=this.a=null}function Eo(t,e){this.name=t,this.value=e}so.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=lr("universalLinks.subscribe",o))&&t(null,this.b))},so.prototype.unsubscribe=function(t){V(this.a,function(e){return e==t})},S(lo,Wr),S(ho,Wr),ho.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.w();return e&&ct(t,e),t},ho.prototype.toJSON=function(){return this.w()},po.prototype.c=null,S(mo,po),mo.prototype.a=function(){var t=go(this);return t?new ActiveXObject(t):new XMLHttpRequest},mo.prototype.b=function(){var t={};return go(this)&&(t[0]=!0,t[1]=!0),t},uo=new mo,S(vo,po),vo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new bo;throw Error("Unsupported browser")},vo.prototype.b=function(){return{}},(t=bo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.cc=function(){this.status=200,this.response=this.responseText=this.a.responseText,wo(this,4)},t.Gb=function(){this.status=500,this.response=this.responseText="",wo(this,4)},t.hc=function(){this.Gb()},t.dc=function(){this.status=200,wo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},_o.prototype.a=null,_o.prototype.reset=function(t,e,n,r,i){delete this.a},Eo.prototype.toString=function(){return this.name};var So=new Eo("SEVERE",1e3),Co=new Eo("WARNING",900),Io=new Eo("CONFIG",700),No=new Eo("FINE",500);To.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(A("Root logger has no level set."),null)}(this).value)for(y(e)&&(e=e()),t=new _o(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Ao,ko={},Do=null;function Ro(t){var e;if(Do||(Do=new To(""),(ko[""]=Do).c=Io),!(e=ko[t])){e=new To(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=Ro(t.substr(0,n))).b||(n.b={}),(n.b[r]=e).a=n,ko[t]=e}return e}function xo(t,e){t&&t.log(No,e,void 0)}function Oo(t){this.f=t}function Po(t){xe.call(this),this.u=t,this.readyState=Mo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.o="GET",this.g="",this.a=!1,this.h=Ro("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}S(Oo,po),Oo.prototype.a=function(){return new Po(this.f)},Oo.prototype.b=(Ao={},function(){return Ao}),S(Po,xe);var Mo=0;function Lo(t){t.c.read().then(t.bc.bind(t)).catch(t.Ma.bind(t))}function Fo(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,Uo(t)}function Uo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function qo(t){xe.call(this),this.headers=new Ve,this.D=t||null,this.c=!1,this.A=this.a=null,this.h=this.N=this.l="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=Vo,this.v=this.O=!1}(t=Po.prototype).open=function(t,e){if(this.readyState!=Mo)throw this.abort(),Error("Error reopening a connection");this.o=t,this.g=e,this.readyState=1,Uo(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.o,credentials:void 0,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.g,e)).then(this.gc.bind(this),this.Ma.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Fo(this,!1)),this.readyState=Mo},t.gc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,Uo(this)),this.a&&(this.readyState=3,Uo(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.ec.bind(this),this.Ma.bind(this)):void 0!==o.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,Lo(this)):t.text().then(this.fc.bind(this),this.Ma.bind(this)))))},t.bc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Fo(this,!0):Uo(this),3==this.readyState&&Lo(this)}},t.fc=function(t){this.a&&(this.response=this.responseText=t,Fo(this,!0))},t.ec=function(t){this.a&&(this.response=t,Fo(this,!0))},t.Ma=function(t){var e=this.h;e&&e.log(Co,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&Fo(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(Co,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Co,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},S(qo,xe);var Vo="";qo.prototype.b=Ro("goog.net.XhrIo");var jo=/^https?$/i,Bo=["POST","PUT"];function Wo(t){return"content-type"==t.toLowerCase()}function Ko(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Qo(t),Go(t)}function Qo(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ho(t){if(t.c&&void 0!==i)if(t.A[1]&&4==Yo(t)&&2==Xo(t))xo(t.b,Jo(t,"Local request error detected and ignored"));else if(t.i&&4==Yo(t))Le(t.Jb,0,t);else if(t.dispatchEvent("readystatechange"),4==Yo(t)){xo(t.b,Jo(t,"Request complete")),t.c=!1;try{var e,n=Xo(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var a;if(a=0===n){var s=String(t.l).match(We)[1]||null;if(!s&&o.self&&o.self.location){var u=o.self.location.protocol;s=u.substr(0,u.length-1)}a=!jo.test(s?s.toLowerCase():"")}e=a}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Yo(t)?t.a.statusText:""}catch(e){xo(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+Xo(t)+"]",Qo(t)}}finally{Go(t)}}}function Go(t,e){if(t.a){zo(t);var n=t.a,r=t.A[0]?l:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(So,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function zo(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(o.clearTimeout(t.u),t.u=null)}function Yo(t){return t.a?t.a.readyState:0}function Xo(t){try{return 2<Yo(t)?t.a.status:-1}catch(t){return-1}}function Jo(t,e){return e+" ["+t.N+" "+t.l+" "+Xo(t)+"]"}function $o(t){var e=ca;this.g=[],this.v=e,this.u=t||null,this.f=this.a=!1,this.c=void 0,this.l=this.A=this.i=!1,this.h=0,this.b=null,this.m=0}function Zo(t,e,n){t.a=!0,t.c=n,t.f=!e,ra(t)}function ta(t){if(t.a){if(!t.l)throw new ia(t);t.l=!1}}function ea(t,e,n,r){t.g.push([e,n,r]),t.a&&ra(t)}function na(t){return F(t.g,function(t){return y(t[1])})}function ra(t){if(t.h&&t.a&&na(t)){var e=t.h,n=sa[e];n&&(o.clearTimeout(n.a),delete sa[e]),t.h=0}t.b&&(t.b.m--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),a=i[0],s=i[1];if(i=i[2],a=t.f?s:a)try{var u=a.call(i||t.u,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(C(e)||"function"==typeof o.Promise&&e instanceof o.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,na(t)||(n=!0)}}t.c=e,r&&(u=_(t.o,t,!0),r=_(t.o,t,!1),e instanceof $o?(ea(e,u,r),e.A=!0):e.then(u,r)),n&&(e=new aa(e),sa[e.a]=e,t.h=e.a)}function ia(){I.call(this)}function oa(){I.call(this)}function aa(t){this.a=o.setTimeout(_(this.c,this),0),this.b=t}(t=qo.prototype).Ga=function(){void 0!==i&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",xo(this.b,Jo(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(xo(this.b,Jo(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Go(this))},t.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Go(this,!0)),qo.qb.va.call(this)},t.Jb=function(){this.qa||(this.I||this.i||this.f?Ho(this):this.vc())},t.vc=function(){Ho(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case Vo:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(So,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(t){return xo(this.b,"Can not get response: "+t.message),null}},$o.prototype.cancel=function(t){if(this.a)this.c instanceof $o&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.m--,e.m<=0&&e.cancel())}this.v?this.v.call(this.u,this):this.l=!0,this.a||(t=new oa(this),ta(this),Zo(this,!1,t))}},$o.prototype.o=function(t,e){this.i=!1,Zo(this,t,e)},$o.prototype.then=function(t,e,n){var r,i,o=new gt(function(t,e){r=t,i=e});return ea(this,r,function(t){t instanceof oa?o.cancel():i(t)}),o.then(t,e,n)},$o.prototype.$goog_Thenable=!0,S(ia,I),ia.prototype.message="Deferred has already fired",ia.prototype.name="AlreadyCalledError",S(oa,I),oa.prototype.message="Deferred was canceled",oa.prototype.name="CanceledError",aa.prototype.c=function(){throw delete sa[this.a],this.b};var sa={};function ua(t){var e,n,r,i,a,s=document,l=_n(t).toString(),h=document.createElement("SCRIPT"),f={Lb:h,Ga:void 0},p=new $o(f);return e=window.setTimeout(function(){la(h,!0);var t=new pa(fa,"Timeout reached for loading script "+l);ta(p),Zo(p,!1,t)},5e3),f.Ga=e,h.onload=h.onreadystatechange=function(){h.readyState&&"loaded"!=h.readyState&&"complete"!=h.readyState||(la(h,!1,e),ta(p),Zo(p,!0,null))},h.onerror=function(){la(h,!0,e);var t=new pa(ha,"Error while loading script "+l);ta(p),Zo(p,!1,t)},ct(f={},{type:"text/javascript",charset:"UTF-8"}),Ln(h,f),r=t,(n=h).src=_n(r),null===c&&(c=(r=(r=o.document).querySelector&&r.querySelector("script[nonce]"))&&(r=r.nonce||r.getAttribute("nonce"))&&u.test(r)?r:""),(r=c)&&n.setAttribute("nonce",r),(i=s,(a=(i||document).getElementsByTagName("HEAD"))&&0!=a.length?a[0]:i.documentElement).appendChild(h),p}function ca(){if(this&&this.Lb){var t=this.Lb;t&&"SCRIPT"==t.tagName&&la(t,!0,this.Ga)}}function la(t,e,n){null!=n&&o.clearTimeout(n),t.onload=l,t.onerror=l,t.onreadystatechange=l,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var ha=0,fa=1;function pa(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),I.call(this,n),this.code=t}function da(t){this.f=t}function ya(t,e,n){if(this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||va,this.f=ot(t.secureTokenHeaders||ba),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||wa,this.a=ot(t.firebaseHeaders||_a),n&&(this.a["X-Client-Version"]=n,this.f["X-Client-Version"]=n),n="Node"==nr(),!(n=o.XMLHttpRequest||n&&$i.INTERNAL.node&&$i.INTERNAL.node.XMLHttpRequest)&&!er())throw new Wr("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,er()?this.c=new Oo(self):rr()?this.c=new da(n):this.c=new vo}S(pa,I),S(da,po),da.prototype.a=function(){return new this.f},da.prototype.b=function(){return{}};var ma,ga="idToken",va=new Tr(3e4,6e4),ba={"Content-Type":"application/x-www-form-urlencoded"},wa=new Tr(3e4,6e4),_a={"Content-Type":"application/json"};function Ta(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Ea(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function Sa(t,e,n,r,i,a,s){var u;(t=!((u=ar(u=cr())!=or?null:(u=u.match(/\sChrome\/(\d+)/i))&&2==u.length?parseInt(u[1],10):null)&&u<30||Qt&&te&&!(9<te))||er()?_(t.o,t):(ma||(ma=new gt(function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(o[Ia]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},ea(ua(Tn(Ca,{onload:Ia})),null,function(){e(Error("CORS_UNSUPPORTED"))},void 0))}(t,e)})),_(t.l,t)))(e,n,r,i,a,s)}ya.prototype.o=function(t,e,n,r,i,s){if(er()&&(void 0===o.fetch||void 0===o.Headers||void 0===o.Request))throw new Wr("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var u=new qo(this.c);if(s){u.g=Math.max(0,s);var c=setTimeout(function(){u.dispatchEvent("timeout")},s)}Oe(u,"complete",function(){c&&clearTimeout(c);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return xo(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)}),Pe(u,"ready",function(){c&&clearTimeout(c),Vt(this)}),Pe(u,"timeout",function(){c&&clearTimeout(c),Vt(this),e&&e(null)}),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.N=n,t.G=!1,t.c=!0,t.a=t.D?t.D.a():uo.a(),t.A=t.D?yo(t.D):yo(uo),t.a.onreadystatechange=_(t.Jb,t);try{xo(t.b,Jo(t,"Opening Xhr")),t.I=!0,t.a.open(n,String(e),!0),t.I=!1}catch(e){return xo(t.b,Jo(t,"Error opening Xhr: "+e.message)),void Ko(t,e)}e=r||"";var s,u=new Ve(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||a(t))M(t,e,void 0);else for(var n=qe(t),r=Ue(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,function(t,e){u.set(e,t)}),i=function(t){t:{for(var e=Wo,n=t.length,r=a(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:a(t)?t.charAt(e):t[e]}(u.U()),r=o.FormData&&e instanceof o.FormData,!U(Bo,n)||i||r||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),u.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{zo(t),0<t.g&&(t.v=(s=t.a,Qt&&ne(9)&&"number"==typeof s.timeout&&void 0!==s.ontimeout),xo(t.b,Jo(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=_(t.Ga,t)):t.u=Le(t.Ga,t.g,t)),xo(t.b,Jo(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){xo(t.b,Jo(t,"Send error: "+e.message)),Ko(t,e)}}(u,t,n,r,i)};var Ca=new mn(bn,"https://apis.google.com/js/client.js?onload=%{onload}"),Ia="__fcb"+Math.floor(1e6*Math.random()).toString();function Na(t){if(!a(t=t.email)||!Jn.test(t))throw new Wr("invalid-email")}function Aa(t){"email"in t&&Na(t)}function ka(t){if(!t[ga])throw new Wr("internal-error")}function Da(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Wr("internal-error")}else{if(!t.sessionInfo)throw new Wr("missing-verification-id");if(!t.code)throw new Wr("missing-verification-code")}}ya.prototype.l=function(t,e,n,r,i){var o=this;ma.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},ya.prototype.ob=function(){return fs(this,rs,{})},ya.prototype.rb=function(t,e){return fs(this,es,{idToken:t,email:e})},ya.prototype.sb=function(t,e){return fs(this,ns,{idToken:t,password:e})};var Ra={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function xa(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Wr("internal-error")}function Oa(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&hn(t=new sn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function Pa(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=fo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=fo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=fo(t)):t.errorMessage&&(e=ps(t.errorMessage)),e)throw e;if(!t[ga])throw new Wr("internal-error")}function Ma(t,e){return e.returnIdpCredential=!0,fs(t,is,e)}function La(t,e){return e.returnIdpCredential=!0,fs(t,as,e)}function Fa(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,fs(t,os,e)}function Ua(t){if(!t.oobCode)throw new Wr("invalid-action-code")}(t=ya.prototype).tb=function(t,e){var n={idToken:t},r=[];return rt(Ra,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),fs(this,es,n)},t.lb=function(t,e){return ct(t={requestType:"PASSWORD_RESET",email:t},e),fs(this,Xa,t)},t.mb=function(t,e){return ct(t={requestType:"EMAIL_SIGNIN",email:t},e),fs(this,za,t)},t.kb=function(t,e){return ct(t={requestType:"VERIFY_EMAIL",idToken:t},e),fs(this,Ya,t)},t.Va=function(t){return fs(this,cs,t)},t.$a=function(t,e){return fs(this,Za,{oobCode:t,newPassword:e})},t.Ka=function(t){return fs(this,Va,{oobCode:t})},t.Xa=function(t){return fs(this,qa,{oobCode:t})};var qa={endpoint:"setAccountInfo",C:Ua,da:"email"},Va={endpoint:"resetPassword",C:Ua,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Wr("internal-error")}},ja={endpoint:"signupNewUser",C:function(t){if(Na(t),!t.password)throw new Wr("weak-password")},J:ka,R:!0},Ba={endpoint:"createAuthUri"},Wa={endpoint:"deleteAccount",T:["idToken"]},Ka={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],C:function(t){if(!p(t.deleteProvider))throw new Wr("internal-error")}},Qa={endpoint:"emailLinkSignin",T:["email","oobCode"],C:Na,J:ka,R:!0},Ha={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],C:Na,J:ka,R:!0},Ga={endpoint:"getAccountInfo"},za={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Wr("internal-error");Na(t)},da:"email"},Ya={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],C:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Wr("internal-error")},da:"email"},Xa={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Wr("internal-error");Na(t)},da:"email"},Ja={wb:!0,endpoint:"getProjectConfig",Ib:"GET"},$a={wb:!0,endpoint:"getRecaptchaParam",Ib:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new Wr("internal-error")}},Za={endpoint:"resetPassword",C:Ua,da:"email"},ts={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},es={endpoint:"setAccountInfo",T:["idToken"],C:Aa,R:!0},ns={endpoint:"setAccountInfo",T:["idToken"],C:function(t){if(Aa(t),!t.password)throw new Wr("weak-password")},J:ka,R:!0},rs={endpoint:"signupNewUser",J:ka,R:!0},is={endpoint:"verifyAssertion",C:xa,Qa:Oa,J:Pa,R:!0},os={endpoint:"verifyAssertion",C:xa,Qa:Oa,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Wr("user-not-found");if(t.errorMessage)throw ps(t.errorMessage);if(!t[ga])throw new Wr("internal-error")},R:!0},as={endpoint:"verifyAssertion",C:function(t){if(xa(t),!t.idToken)throw new Wr("internal-error")},Qa:Oa,J:Pa,R:!0},ss={endpoint:"verifyCustomToken",C:function(t){if(!t.token)throw new Wr("invalid-custom-token")},J:ka,R:!0},us={endpoint:"verifyPassword",C:function(t){if(Na(t),!t.password)throw new Wr("wrong-password")},J:ka,R:!0},cs={endpoint:"verifyPhoneNumber",C:Da,J:ka},ls={endpoint:"verifyPhoneNumber",C:function(t){if(!t.idToken)throw new Wr("internal-error");Da(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",fo(t);ka(t)}},hs={Vb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",C:Da,J:ka};function fs(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.T))return Ct(new Wr("internal-error"));var r,i=e.Ib||"POST";return St(n).then(e.C).then(function(){return e.R&&(n.returnSecureToken=!0),function(t,e,n,r,i,o){var a=Xe(t.g+e);ze(a,"key",t.b),o&&ze(a,"cb",E().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&ze(a,u,r[u]);return new gt(function(e,o){Sa(t,a.toString(),function(t){t?t.error?o(ds(t,i||{})):e(t):o(new Wr("network-request-failed"))},n,s?void 0:qn(gr(r)),t.a,t.h.get())})}(t,e.endpoint,i,n,e.Vb,e.wb||!1)}).then(function(t){return r=t,e.Qa?e.Qa(n,r):r}).then(e.J).then(function(){if(!e.da)return r;if(!(e.da in r))throw new Wr("internal-error");return r[e.da]})}function ps(t){return ds({error:{errors:[{message:t}],code:400,message:t}})}function ds(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Wr(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",ct(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new Wr(r[i],e);return!e&&t&&(e=mr(t)),new Wr("internal-error",e)}function ys(t){var e;this.b=t,this.a=null,this.gb=(e=this,(bs||(bs=new gt(function(t,e){function n(){_r(),lr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){_r(),e(Error("Network Error"))},timeout:gs.get()})}if(lr("gapi.iframes.Iframe"))t();else if(lr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();o[r]=function(){lr("gapi.load")?n():e(Error("Network Error"))},St(ua(r=Tn(ms,{onload:r}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw bs=null,t}))).then(function(){return new gt(function(t,n){lr("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:lr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},vs.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})}))}var ms=new mn(bn,"https://apis.google.com/js/api.js?onload=%{onload}"),gs=new Tr(3e4,6e4),vs=new Tr(5e3,15e3),bs=null;function ws(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Je(this.i,"/__/auth/iframe"),ze(this.a,"apiKey",this.g),ze(this.a,"appName",this.h),this.b=null,this.c=[]}function _s(t,e,n,r,i){this.o=t,this.l=e,this.c=n,this.m=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function Ts(t){try{return $i.app(t).auth().ya()}catch(t){return[]}}function Es(t,e,n,r,i){this.l=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.m=this.a=null}function Ss(t){var e,n=Qn();return(e=t,fs(e,Ja,{}).then(function(t){return t.authorizedDomains||[]})).then(function(t){t:{var e=Xe(n),r=e.f;e=e.b;for(var i=0;i<t.length;i++){var o=t[i],a=e,s=r;if(a=0==o.indexOf("chrome-extension://")?Xe(o).b==a&&"chrome-extension"==s:("http"==s||"https"==s)&&(Xn.test(o)?a==o:(o=o.split(".").join("\\."),new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)))){t=!0;break t}}t=!1}if(!t)throw new lo(Qn())})}function Cs(t){return t.m||(t.m=$n().then(function(){if(!t.u){var e=t.c,n=t.h,r=Ts(t.b),i=new ws(t.l,t.f,t.b);i.f=e,i.b=n,i.c=B(r||[]),t.u=i.toString()}t.i=new ys(t.u),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");var e,n;e=t.i,n=function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=ao(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",St(n)}return n.status="ERROR",St(n)},e.gb.then(function(){e.a.register("authEvent",n,lr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t)})),t.m}function Is(t){return t.o||(t.v=t.c?ur(t.c,Ts(t.b)):null,t.o=new ya(t.f,hi(t.h),t.v)),t.o}function Ns(t,e,n,r,i,o,a,s,u,c){return(t=new _s(t,e,n,r,i)).i=o,t.g=a,t.h=s,t.b=ot(u||null),t.f=c,t.toString()}function As(t){if(this.a=t||$i.INTERNAL.reactNative&&$i.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Wr("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ks(t){this.b=t,this.a={},this.c=_(this.f,this)}ws.prototype.toString=function(){return this.f?ze(this.a,"v",this.f):ln(this.a.a,"v"),this.b?ze(this.a,"eid",this.b):ln(this.a.a,"eid"),this.c.length?ze(this.a,"fw",this.c.join(",")):ln(this.a.a,"fw"),this.a.toString()},_s.prototype.toString=function(){var t=Je(this.o,"/__/auth/handler");if(ze(t,"apiKey",this.l),ze(t,"appName",this.c),ze(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=$i.app(this.c).auth().ea()}catch(t){n=null}for(var r in e.ab=n,ze(t,"providerId",this.a.providerId),n=gr((e=this.a).zb))n[r]=n[r].toString();r=e.Cc,n=ot(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}e.eb&&e.ab&&!n[e.eb]&&(n[e.eb]=e.ab),it(n)||ze(t,"customParameters",mr(n))}if("function"==typeof this.a.Fb&&(e=this.a.Fb()).length&&ze(t,"scopes",e.join(",")),this.i?ze(t,"redirectUrl",this.i):ln(t.a,"redirectUrl"),this.g?ze(t,"eventId",this.g):ln(t.a,"eventId"),this.h?ze(t,"v",this.h):ln(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Ye(t,a)&&ze(t,a,this.b[a]);return this.f?ze(t,"eid",this.f):ln(t.a,"eid"),(a=Ts(this.c)).length&&ze(t,"fw",a.join(",")),t.toString()},(t=Es.prototype).Ea=function(t,e,n){var r=new Wr("popup-closed-by-user"),i=new Wr("web-storage-unsupported"),o=this,a=!1;return this.ga().then(function(){var n,r;(n=o,r={type:"webStorageSupport"},Cs(n).then(function(){return t=n.i,e=r,t.gb.then(function(){return new gt(function(n){t.a.send(e.type,e,n,lr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})});var t,e}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})).then(function(n){n||(t&&zn(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return e=t,new gt(function(t){return function n(){Fe(2e3).then(function(){if(e&&!e.closed)return n();t()})}()});var e}).then(function(){if(!a)return Fe(n).then(function(){e(r)})})},t.Mb=function(){var t=cr();return!yr(t)&&!wr(t)},t.Hb=function(){return!1},t.Db=function(t,e,n,r,i,o,a){if(!t)return Ct(new Wr("popup-blocked"));if(a&&!yr())return this.ga().s(function(e){zn(t),i(e)}),r(),St();this.a||(this.a=Ss(Is(this)));var s=this;return this.a.then(function(){var e=s.ga().s(function(e){throw zn(t),i(e),e});return r(),e}).then(function(){io(n),a||Hn(Ns(s.l,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},t.Ca=function(t,e,n){this.a||(this.a=Ss(Is(this)));var r=this;return this.a.then(function(){io(e),Hn(Ns(r.l,r.f,r.b,t,e,Qn(),n,r.c,void 0,r.h))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.ga=function(){var t=this;return Cs(this).then(function(){return t.i.gb}).s(function(){throw t.a=null,new Wr("network-request-failed")})},t.Ob=function(){return!0},t.wa=function(t){this.g.push(t)},t.La=function(t){V(this.g,function(e){return e==t})},(t=As.prototype).get=function(t){return St(this.a.getItem(t)).then(function(t){return t&&vr(t)})},t.set=function(t,e){return St(this.a.setItem(t,mr(e)))},t.P=function(t){return St(this.a.removeItem(t))},t.Y=function(){},t.ca=function(){};var Ds,Rs=[];function xs(t){this.a=t}function Os(t){this.c=t,this.b=!1,this.a=[]}function Ps(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Ct(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new gt(function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout(function(){r(Error("unsupported_event"))},l),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))}).then(function(e){return Ms(t,c),e}).s(function(e){throw Ms(t,c),e})}function Ms(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),V(t.a,function(t){return t==e})}}function Ls(){if(!Us())throw new Wr("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.l=o.indexedDB,this.type="indexedDB",this.g=this.m=this.f=this.i=null,this.u=!1,this.h=null;var t,e=this;er()&&self?(this.m=function(){var t=er()?self:null;if(M(Rs,function(n){n.b==t&&(e=n)}),!e){var e=new ks(t);Rs.push(e)}return e}(),this.m.subscribe("keyChanged",function(t,n){return Ws(e).then(function(t){return 0<t.length&&M(e.a,function(e){e(t)}),{keyProcessed:U(t,n.key)}})}),this.m.subscribe("ping",function(){return St(["keyChanged"])})):(t=o.navigator,t&&t.serviceWorker?St().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):St(null)).then(function(t){(e.h=t)&&(e.g=new Os(new xs(t)),Ps(e.g,"ping",null,!0).then(function(t){t[0].fulfilled&&U(t[0].value,"keyChanged")&&(e.u=!0)}).s(function(){}))})}function Fs(t){return t.o||(t.o=function t(e){return new gt(function(n,r){var i=e.l.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(t){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){r(t)}},i.onsuccess=function(i){var o;(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):(o=e,new gt(function(t,e){var n=o.l.deleteDatabase("firebaseLocalStorageDb");n.onsuccess=function(){t()},n.onerror=function(t){e(Error(t.target.error))}})).then(function(){return t(e)}).then(function(t){n(t)}).s(function(t){r(t)})}})}(t)),t.o}function Us(){try{return!!o.indexedDB}catch(t){return!1}}function qs(t){return t.objectStore("firebaseLocalStorage")}function Vs(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function js(t){return new gt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function Bs(t,e){return t.g&&t.h&&((n=o.navigator)&&n.serviceWorker&&n.serviceWorker.controller||null)===t.h?Ps(t.g,"keyChanged",{key:e},t.u).then(function(){}).s(function(){}):St();var n}function Ws(t){return Fs(t).then(function(t){var e=qs(Vs(t,!1));return e.getAll?js(e.getAll()):new gt(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r})}function Ks(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Qs(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=St().then(function(){if(Us()){var t=br(),r="__sak"+t;return Ds||(Ds=new Ls),(n=Ds).set(r,t).then(function(){return n.get(r)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.P(r)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.Y(function(t){M(e.a,function(e){e(t)})}),t})}function Hs(){this.a={},this.type="inMemory"}function Gs(){if(!function(){var t="Node"==nr();if(!(t=zs()||t&&$i.INTERNAL.node&&$i.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==nr())throw new Wr("internal-error","The LocalStorage compatibility library was not found.");throw new Wr("web-storage-unsupported")}this.a=zs()||$i.INTERNAL.node.localStorage,this.type="localStorage"}function zs(){try{var t=o.localStorage,e=br();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Ys(){this.type="nullStorage"}function Xs(){if(!function(){var t="Node"==nr();if(!(t=Js()||t&&$i.INTERNAL.node&&$i.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==nr())throw new Wr("internal-error","The SessionStorage compatibility library was not found.");throw new Wr("web-storage-unsupported")}this.a=Js()||$i.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Js(){try{var t=o.sessionStorage,e=br();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function $s(){var t={};t.Browser=eu,t.Node=nu,t.ReactNative=ru,t.Worker=iu,this.a=t[nr()]}ks.prototype.f=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];M(r,function(e){i.push(St().then(function(){return e(t.origin,t.data.data)}))}),Nt(i).then(function(r){var i=[];M(r,function(t){i.push({fulfilled:t.Eb,value:t.value,reason:t.reason?t.reason.message:void 0})}),M(i,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})})}},ks.prototype.subscribe=function(t,e){it(this.a)&&this.b.addEventListener("message",this.c),void 0===this.a[t]&&(this.a[t]=[]),this.a[t].push(e)},ks.prototype.unsubscribe=function(t,e){void 0!==this.a[t]&&e?(V(this.a[t],function(t){return t==e}),0==this.a[t].length&&delete this.a[t]):e||delete this.a[t],it(this.a)&&this.b.removeEventListener("message",this.c)},xs.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Os.prototype.close=function(){for(;0<this.a.length;)Ms(this,this.a[0]);this.b=!0},(t=Ls.prototype).set=function(t,e){var n,r=!1,i=this;return Fs(this).then(function(e){return js((e=qs(Vs(n=e,!0))).get(t))}).then(function(o){var a=qs(Vs(n,!0));return o?(o.value=e,js(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,js(a.add(o)))}).then(function(){return i.c[t]=e,Bs(i,t)}).ia(function(){r&&i.b--})},t.get=function(t){return Fs(this).then(function(e){return js(qs(Vs(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.P=function(t){var e=!1,n=this;return Fs(this).then(function(r){return e=!0,n.b++,js(qs(Vs(r,!0)).delete(t))}).then(function(){return delete n.c[t],Bs(n,t)}).ia(function(){e&&n.b--})},t.Y=function(t){var e;0==this.a.length&&(Ks(e=this),function t(){e.f=setTimeout(function(){e.i=Ws(e).then(function(t){0<t.length&&M(e.a,function(e){e(t)})}).then(function(){t()}).s(function(e){"STOP_EVENT"!=e.message&&t()})},800)}()),this.a.push(t)},t.ca=function(t){V(this.a,function(e){return e==t}),0==this.a.length&&Ks(this)},(t=Qs.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.P=function(t){return this.b.then(function(e){return e.P(t)})},t.Y=function(t){this.a.push(t)},t.ca=function(t){V(this.a,function(e){return e==t})},(t=Hs.prototype).get=function(t){return St(this.a[t])},t.set=function(t,e){return this.a[t]=e,St()},t.P=function(t){return delete this.a[t],St()},t.Y=function(){},t.ca=function(){},(t=Gs.prototype).get=function(t){var e=this;return St().then(function(){return vr(e.a.getItem(t))})},t.set=function(t,e){var n=this;return St().then(function(){var r=mr(e);null===r?n.P(t):n.a.setItem(t,r)})},t.P=function(t){var e=this;return St().then(function(){e.a.removeItem(t)})},t.Y=function(t){o.window&&we(o.window,"storage",t)},t.ca=function(t){o.window&&Ee(o.window,"storage",t)},(t=Ys.prototype).get=function(){return St(null)},t.set=function(){return St()},t.P=function(){return St()},t.Y=function(){},t.ca=function(){},(t=Xs.prototype).get=function(t){var e=this;return St().then(function(){return vr(e.a.getItem(t))})},t.set=function(t,e){var n=this;return St().then(function(){var r=mr(e);null===r?n.P(t):n.a.setItem(t,r)})},t.P=function(t){var e=this;return St().then(function(){e.a.removeItem(t)})},t.Y=function(){},t.ca=function(){};var Zs,tu,eu={B:Gs,Sa:Xs},nu={B:Gs,Sa:Xs},ru={B:As,Sa:Ys},iu={B:Gs,Sa:Ys},ou={Xc:"local",NONE:"none",Zc:"session"};function au(){var t=!(wr(cr())||!tr()),e=yr(),n=hr();this.o=t,this.h=e,this.m=n,this.a={},Zs||(Zs=new $s),t=Zs;try{this.g=!Kn()&&Cr()||!o.indexedDB?new t.a.B:new Qs(er()?new Hs:new t.a.B)}catch(t){this.g=new Hs,this.h=!0}try{this.i=new t.a.Sa}catch(t){this.i=new Hs}this.l=new Hs,this.f=_(this.Nb,this),this.b={}}function su(){return tu||(tu=new au),tu}function uu(t,e){switch(e){case"session":return t.i;case"none":return t.l;default:return t.g}}function cu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function lu(t,e,n){return n=cu(e,n),"local"==e.B&&(t.b[n]=null),uu(t,e.B).P(n)}function hu(t){t.c&&(clearInterval(t.c),t.c=null)}function fu(t){this.a=t,this.b=su()}(t=au.prototype).get=function(t,e){return uu(this,t.B).get(cu(t,e))},t.set=function(t,e,n){var r=cu(t,n),i=this,o=uu(this,t.B);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.B&&(i.b[r]=e)})},t.addListener=function(t,e,n){var r;t=cu(t,e),this.m&&(this.b[t]=o.localStorage.getItem(t)),it(this.a)&&(uu(this,"local").Y(this.f),this.h||(Kn()||!Cr())&&o.indexedDB||!this.m||(hu(r=this),r.c=setInterval(function(){for(var t in r.a){var e=o.localStorage.getItem(t),n=r.b[t];e!=n&&(r.b[t]=e,e=new ce({type:"storage",key:t,target:window,oldValue:n,newValue:e,a:!0}),r.Nb(e))}},1e3))),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=cu(t,e),this.a[t]&&(V(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),it(this.a)&&(uu(this,"local").ca(this.f),hu(this))},t.Nb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=o.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Ya(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?uu(this,"local").ca(this.f):hu(this),this.o)if(n=o.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?o.localStorage.setItem(e,r):o.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var a=this;n=function(){void 0===t.a.a&&a.b[e]===o.localStorage.getItem(e)||(a.b[e]=o.localStorage.getItem(e),a.Ya(e))},Qt&&te&&10==te&&o.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else M(t,_(this.Ya,this))},t.Ya=function(t){this.a[t]&&M(this.a[t],function(t){t()})};var pu,du={name:"authEvent",B:"local"};function yu(){this.a=su()}function mu(t,e){this.b=gu,this.f=o.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.m=o.Int32Array?new Int32Array(64):Array(64),void 0!==pu||(pu=o.Int32Array?new Int32Array(Su):Su),this.reset()}S(mu,function(){this.b=-1});for(var gu=64,vu=gu-1,bu=[],wu=0;wu<vu;wu++)bu[wu]=0;var _u=j(128,bu);function Tu(t){for(var e=t.f,n=t.m,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;e<64;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;e<64;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|pu[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function Eu(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(a(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(Tu(t),i=0);else{if(!d(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&o<=255&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(Tu(t),i=0)}}t.c=i,t.g+=n}mu.prototype.reset=function(){this.g=this.c=0,this.a=o.Int32Array?new Int32Array(this.h):B(this.h)};var Su=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Cu(){mu.call(this,8,Iu)}S(Cu,mu);var Iu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Nu(t,e,n,r,i){this.l=t,this.i=e,this.m=n,this.o=r||null,this.u=i||null,this.h=e+":"+n,this.v=new yu,this.g=new fu(this.h),this.f=null,this.b=[],this.a=this.c=null}function Au(t){return new Wr("invalid-cordova-configuration",t)}function ku(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Du(t){return t.f||(t.f=t.ga().then(function(){return new gt(function(e){t.wa(function n(r){return e(r),t.La(n),!1}),function(t){function e(e){r=!0,i&&i.cancel(),Ru(t).then(function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=Ii(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=vr(Ye(o=Xe(i),"firebaseError")||null))?Kr(o):null)?new oo(r.c,r.b,null,null,o):new oo(r.c,r.b,i,r.f)),i=o||n}ku(t,i)})}var n=new oo("unknown",null,null,null,new Wr("no-auth-event")),r=!1,i=Fe(500).then(function(){return Ru(t).then(function(){r||ku(t,n)})}),a=o.handleOpenURL;o.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(lr("BuildInfo.packageName",o).toLowerCase()+"://")&&e({url:t}),"function"==typeof a)try{a(t)}catch(t){console.error(t)}},co||(co=new so),co.subscribe(e)}(t)})})),t.f}function Ru(t){var e,n=null;return(e=t.g,e.b.get(du,e.a).then(function(t){return ao(t)})).then(function(e){return n=e,lu((e=t.g).b,du,e.a)}).then(function(){return n})}function xu(t){this.a=t,this.b=su()}(t=Nu.prototype).ga=function(){return this.za?this.za:this.za=(Zn(void 0)?$n().then(function(){return new gt(function(t,e){var n=o.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):Ct(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof lr("universalLinks.subscribe",o))throw Au("cordova-universal-links-plugin-fix is not installed");if(void 0===lr("BuildInfo.packageName",o))throw Au("cordova-plugin-buildinfo is not installed");if("function"!=typeof lr("cordova.plugins.browsertab.openUrl",o))throw Au("cordova-plugin-browsertab is not installed");if("function"!=typeof lr("cordova.InAppBrowser.open",o))throw Au("cordova-plugin-inappbrowser is not installed")},function(){throw new Wr("cordova-not-ready")})},t.Ea=function(t,e){return e(new Wr("operation-not-supported-in-this-environment")),St()},t.Db=function(){return Ct(new Wr("operation-not-supported-in-this-environment"))},t.Ob=function(){return!1},t.Mb=function(){return!0},t.Hb=function(){return!0},t.Ca=function(t,e,n){if(this.c)return Ct(new Wr("redirect-operation-pending"));var r=this,i=o.document,a=null,s=null,u=null,c=null;return this.c=St().then(function(){return io(e),Du(r)}).then(function(){return function(t,e,n,r){var i=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new oo(e,r,null,i,new Wr("no-auth-event")),s=lr("BuildInfo.packageName",o);if("string"!=typeof s)throw new Wr("invalid-cordova-configuration");var u=lr("BuildInfo.displayName",o),c={};if(cr().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!cr().toLowerCase().match(/android/))return Ct(new Wr("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),i=function(t){var e=new Cu;Eu(e,t),t=[];var n=8*e.g;e.c<56?Eu(e,_u,56-e.c):Eu(e,_u,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Tu(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return L(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(i),c.sessionId=i;var l=Ns(t.l,t.i,t.m,e,n,null,r,t.o,c,t.u);return t.ga().then(function(){var e=t.h;return t.v.a.set(du,a.w(),e)}).then(function(){var e=lr("cordova.plugins.browsertab.isAvailable",o);if("function"!=typeof e)throw new Wr("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=lr("cordova.plugins.browsertab.openUrl",o)))throw new Wr("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=lr("cordova.InAppBrowser.open",o)))throw new Wr("invalid-cordova-configuration");e=cr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,t,e,n)}).then(function(){return new gt(function(t,e){s=function(){var e=lr("cordova.plugins.browsertab.close",o);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.wa(s),u=function(){a||(a=Fe(2e3).then(function(){e(new Wr("redirect-cancelled-by-user"))}))},c=function(){Er()&&u()},i.addEventListener("resume",u,!1),cr().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",c,!1)}).s(function(t){return Ru(r).then(function(){throw t})})}).ia(function(){u&&i.removeEventListener("resume",u,!1),c&&i.removeEventListener("visibilitychange",c,!1),a&&a.cancel(),s&&r.La(s),r.c=null})},t.wa=function(t){this.b.push(t),Du(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new oo("unknown",null,null,null,new Wr("no-auth-event")),t(e))})},t.La=function(t){V(this.b,function(e){return e==t})};var Ou={name:"pendingRedirect",B:"session"};function Pu(t){return lu(t.b,Ou,t.a)}function Mu(t,e,n){this.i={},this.u=0,this.A=t,this.l=e,this.o=n,this.h=[],this.f=!1,this.m=_(this.cb,this),this.b=new Qu,this.v=new Yu,this.g=new xu(this.l+":"+this.o),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.v,this.c.linkViaPopup=this.v,this.c.reauthViaPopup=this.v,this.a=Lu(this.A,this.l,this.o,ci)}function Lu(t,e,n,r){var i=$i.SDK_VERSION||null;return Zn()?new Nu(t,e,n,i,r):new Es(t,e,n,i,r)}function Fu(t){t.f||(t.f=!0,t.a.wa(t.m));var e=t.a;return t.a.ga().s(function(n){throw t.a==e&&t.reset(),n})}function Uu(t){t.a.Mb()&&Fu(t).s(function(e){var n=new oo("unknown",null,null,null,new Wr("operation-not-supported-in-this-environment"));Bu(e)&&t.cb(n)}),t.a.Hb()||Hu(t.b)}(t=Mu.prototype).reset=function(){this.f=!1,this.a.La(this.m),this.a=Lu(this.A,this.l,this.o),this.i={}},t.Za=function(){this.b.Za()},t.subscribe=function(t){if(U(this.h,t)||this.h.push(t),!this.f){var e=this;(n=this.g,n.b.get(Ou,n.a).then(function(t){return"pending"==t})).then(function(t){t?Pu(e.g).then(function(){Fu(e).s(function(t){var n=new oo("unknown",null,null,null,new Wr("operation-not-supported-in-this-environment"));Bu(t)&&e.cb(n)})}):Uu(e)}).s(function(){Uu(e)})}var n},t.unsubscribe=function(t){V(this.h,function(e){return e==t})},t.cb=function(t){if(!t)throw new Wr("invalid-auth-event");if(6e5<=E()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=E())),e=!0;break}}return Hu(this.b),e};var qu=new Tr(2e3,1e4),Vu=new Tr(3e4,6e4);function ju(t,e,n,r,i,o){return t.a.Db(e,n,r,function(){t.f||(t.f=!0,t.a.wa(t.m))},function(){t.reset()},i,o)}function Bu(t){return!(!t||"auth/cordova-not-ready"!=t.code)}Mu.prototype.fa=function(){return this.b.fa()},Mu.prototype.Ca=function(t,e,n){var r,i,o=this;return(i=this.g,i.b.set(Ou,"pending",i.a)).then(function(){return o.a.Ca(t,e,n).s(function(t){if(Bu(t))throw new Wr("operation-not-supported-in-this-environment");return r=t,Pu(o.g).then(function(){throw r})}).then(function(){return o.a.Ob()?new gt(function(){}):Pu(o.g).then(function(){return o.fa()}).then(function(){}).s(function(){})})})},Mu.prototype.Ea=function(t,e,n,r){return this.a.Ea(n,function(n){t.ha(e,null,n,r)},qu.get())};var Wu={};function Ku(t,e,n){var r=e+":"+n;return Wu[r]||(Wu[r]=new Mu(t,e,n)),Wu[r]}function Qu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Hu(t){t.g||(t.g=!0,zu(t,!1,null,null))}function Gu(t,e){if(t.b=function(){return St(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function zu(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Ct(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Gu(t,n):Gu(t,{user:null}),t.f=[],t.c=[]}function Yu(){}function Xu(){this.ub=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ub},set:function(t){this.ub=t},enumerable:!1})}function Ju(t,e){this.a=e,Dr(this,"verificationId",t)}function $u(t,e,n,r){return new eo(t).Va(e,n).then(function(t){return new Ju(t,r)})}function Zu(t){var e=ui(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Wr("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Rr(this,{token:t,expirationTime:Sr(1e3*e.exp),authTime:Sr(1e3*e.auth_time),issuedAtTime:Sr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function tc(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function ec(t){this.f=t,this.b=this.a=null,this.c=0}function nc(t,e){var n=e[ga],r=e.refreshToken;e=rc(e.expiresIn),t.b=n,t.c=e,t.a=r}function rc(t){return E()+1e3*parseInt(t,10)}function ic(t,e){this.a=t||null,this.b=e||null,Rr(this,{lastSignInTime:Sr(e||null),creationTime:Sr(t||null)})}function oc(t,e,n,r,i,o){Rr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function ac(t,e){for(var n in ue.call(this,t),e)this[n]=e[n]}function sc(t,e,n){var r;this.G=[],this.l=t.apiKey,this.o=t.appName,this.u=t.authDomain||null,t=$i.SDK_VERSION?ur($i.SDK_VERSION):null,this.c=new ya(this.l,hi(ci),t),this.h=new ec(this.c),dc(this,e[ga]),nc(this.h,e),Dr(this,"refreshToken",this.h.a),gc(this,n||{}),xe.call(this),this.I=!1,this.u&&fr()&&(this.a=Ku(this.u,this.l,this.o)),this.N=[],this.i=null,this.A=(r=this,new tc(function(){return r.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var t=r.h.c-E()-3e5;return 0<t?t:0})),this.V=_(this.Ha,this);var i=this;this.ka=null,this.ta=function(t){i.pa(t.g)},this.X=null,this.O=[],this.sa=function(t){cc(i,t.c)},this.W=null}function uc(t,e){t.X&&Ee(t.X,"languageCodeChanged",t.ta),(t.X=e)&&we(e,"languageCodeChanged",t.ta)}function cc(t,e){t.O=e,Ea(t.c,$i.SDK_VERSION?ur($i.SDK_VERSION,t.O):null)}function lc(t,e){t.W&&Ee(t.W,"frameworkChanged",t.sa),(t.W=e)&&we(e,"frameworkChanged",t.sa)}function hc(t){try{return $i.app(t.o).auth()}catch(e){throw new Wr("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function fc(t){t.D||t.A.b||(t.A.start(),Ee(t,"tokenChanged",t.V),we(t,"tokenChanged",t.V))}function pc(t){Ee(t,"tokenChanged",t.V),t.A.stop()}function dc(t,e){t.ra=e,Dr(t,"_lat",e)}function yc(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return Nt(e).then(function(){return t})}function mc(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function gc(t,e){Rr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new ic(e.createdAt,e.lastLoginAt),providerData:[]})}function vc(){}function bc(t){return St().then(function(){if(t.D)throw new Wr("app-deleted")})}function wc(t){return L(t.providerData,function(t){return t.providerId})}function _c(t,e){e&&(Tc(t,e.providerId),t.providerData.push(e))}function Tc(t,e){V(t.providerData,function(t){return t.providerId==e})}function Ec(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Dr(t,e,n)}function Sc(t,e){var n,r,i;t!=e&&(Rr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Dr(t,"metadata",new ic((i=e.metadata).a,i.b)):Dr(t,"metadata",new ic),M(e.providerData,function(e){_c(t,e)}),n=t.h,r=e.h,n.b=r.b,n.a=r.a,n.c=r.c,Dr(t,"refreshToken",t.h.a))}function Cc(t){return t.F().then(function(e){var n,r,i=t.isAnonymous;return(n=t,r=e,fs(n.c,Ga,{idToken:r}).then(_(n.wc,n))).then(function(){return i||Ec(t,"isAnonymous",!1),e})})}function Ic(t,e){e[ga]&&t.ra!=e[ga]&&(nc(t.h,e),t.dispatchEvent(new ac("tokenChanged")),dc(t,e[ga]),Ec(t,"refreshToken",t.h.a))}function Nc(t,e){return Cc(t).then(function(){if(U(wc(t),e))return yc(t).then(function(){throw new Wr("provider-already-linked")})})}function Ac(t,e,n){return xr({user:t,credential:ro(e),additionalUserInfo:e=mi(e),operationType:n})}function kc(t,e){return Ic(t,e),t.reload().then(function(){return t})}function Dc(t,e,n,r,i){if(!fr())return Ct(new Wr("operation-not-supported-in-this-environment"));if(t.i&&!i)return Ct(t.i);var o=yi(n.providerId),a=br(t.uid+":::"),s=null;(!yr()||tr())&&t.u&&n.isOAuthProvider&&(s=Ns(t.u,t.l,t.o,e,n,null,a,$i.SDK_VERSION||null));var u=Yn(s,o&&o.Ba,o&&o.Aa);return r=r().then(function(){if(xc(t),!i)return t.F().then(function(){})}).then(function(){return ju(t.a,u,e,n,a,!!s)}).then(function(){return new gt(function(n,r){t.ha(e,null,new Wr("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=a,t.b=t.a.Ea(t,e,u,a)})}).then(function(t){return u&&zn(u),t?xr(t):null}).s(function(t){throw u&&zn(u),t}),Oc(t,r,i)}function Rc(t,e,n,r,i){if(!fr())return Ct(new Wr("operation-not-supported-in-this-environment"));if(t.i&&!i)return Ct(t.i);var o=null,a=br(t.uid+":::");return r=r().then(function(){if(xc(t),!i)return t.F().then(function(){})}).then(function(){return t.aa=a,yc(t)}).then(function(e){return t.ba&&(e=(e=t.ba).b.set(Lc,t.w(),e.a)),e}).then(function(){return t.a.Ca(e,n,a)}).s(function(e){if(o=e,t.ba)return Fc(t.ba);throw o}).then(function(){if(o)throw o}),Oc(t,r,i)}function xc(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new Wr("internal-error");throw new Wr("auth-domain-config-required")}}function Oc(t,e,n){var r,i,o,a=(i=e,o=n,(r=t).i&&!o?(i.cancel(),Ct(r.i)):i.s(function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(r.i||r.dispatchEvent(new ac("userInvalidated")),r.i=t),t}));return t.G.push(a),a.ia(function(){q(t.G,a)}),a}function Pc(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[ga]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-E())/1e3;var r=new sc(e,n,t);return t.providerData&&M(t.providerData,function(t){t&&_c(r,xr(t))}),t.redirectEventId&&(r.aa=t.redirectEventId),r}function Mc(t){this.a=t,this.b=su()}Qu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Qu.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(zu(this,!0,null,t.a),St()):e.xa(n,r)?function(t,e,n){n=n.xa(e.c,e.b);var r=e.g,i=e.f,o=e.h,a=!!e.c.match(/Redirect$/);n(r,i,o).then(function(e){zu(t,a,e,null)}).s(function(e){zu(t,a,null,e)})}(this,t,e):Ct(new Wr("invalid-auth-event")):(zu(this,!1,null,null),St())}else Ct(new Wr("invalid-auth-event"))},Qu.prototype.Za=function(){this.g&&!this.i&&zu(this,!1,null,null)},Qu.prototype.fa=function(){var t=this;return new gt(function(e,n){var r,i;t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),r=t,i=new Wr("timeout"),r.a&&r.a.cancel(),r.a=Fe(Vu.get()).then(function(){r.b||(r.g=!0,zu(r,!0,null,i))}))})},Yu.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ha(t.c,null,t.a,t.b),St()):e.xa(n,r)?(o=e,a=(i=t).b,s=i.c,o.xa(s,a)(i.g,i.f,i.h).then(function(t){o.ha(s,t,null,a)}).s(function(t){o.ha(s,null,t,a)})):Ct(new Wr("invalid-auth-event"))}else Ct(new Wr("invalid-auth-event"));var i,o,a,s},Ju.prototype.confirm=function(t){return t=no(this.verificationId,t),this.a(t)},tc.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=Fe(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return t=o.document,e=null,Er()||!t?St():new gt(function(n){e=function(){Er()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},tc.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ec.prototype.w=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},ec.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Ct(new Wr("user-token-expired")):t||!this.b||E()>this.c-3e4?this.a?function(t,e){return(n=t.f,r=e,new gt(function(t,e){"refresh_token"==r.grant_type&&r.refresh_token||"authorization_code"==r.grant_type&&r.code?Sa(n,n.i+"?key="+encodeURIComponent(n.b),function(n){n?n.error?e(ds(n)):n.access_token&&n.refresh_token?t(n):e(new Wr("internal-error")):e(new Wr("network-request-failed"))},"POST",cn(r).toString(),n.f,n.m.get()):e(new Wr("internal-error"))})).then(function(e){return t.b=e.access_token,t.c=rc(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e});var n,r}(this,{grant_type:"refresh_token",refresh_token:this.a}):St(null):St({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},ic.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(ac,ue),S(sc,xe),sc.prototype.pa=function(t){this.ka=t,Ta(this.c,t)},sc.prototype.ea=function(){return this.ka},sc.prototype.ya=function(){return B(this.O)},sc.prototype.Ha=function(){this.A.b&&(this.A.stop(),this.A.start())},Dr(sc.prototype,"providerId","firebase"),(t=sc.prototype).reload=function(){var t=this;return Oc(this,bc(this).then(function(){return Cc(t).then(function(){return yc(t)}).then(vc)}))},t.ac=function(t){return this.F(t).then(function(t){return new Zu(t)})},t.F=function(t){var e=this;return Oc(this,bc(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new Wr("internal-error");return t.accessToken!=e.ra&&(dc(e,t.accessToken),e.dispatchEvent(new ac("tokenChanged"))),Ec(e,"refreshToken",t.refreshToken),t.accessToken}))},t.wc=function(t){if(!(t=t.users)||!t.length)throw new Wr("internal-error");gc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=(r=(r=t).providerUserInfo)&&r.length?L(r,function(t){return new oc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[],n=0;n<e.length;n++)_c(this,e[n]);var r;Ec(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},t.xc=function(t){return Ar("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(t)},t.hb=function(t){var e=this,n=null;return Oc(this,t.f(this.c,this.uid).then(function(t){return Ic(e,t),n=Ac(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},t.oc=function(t){return Ar("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(t)},t.fb=function(t){var e=this,n=null;return Oc(this,Nc(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.c,n)}).then(function(t){return n=Ac(e,t,"link"),kc(e,t)}).then(function(){return n}))},t.pc=function(t,e){var n=this;return Oc(this,Nc(this,"phone").then(function(){return $u(hc(n),t,e,_(n.fb,n))}))},t.yc=function(t,e){var n=this;return Oc(this,St().then(function(){return $u(hc(n),t,e,_(n.hb,n))}),!0)},t.rb=function(t){var e=this;return Oc(this,this.F().then(function(n){return e.c.rb(n,t)}).then(function(t){return Ic(e,t),e.reload()}))},t.Pc=function(t){var e=this;return Oc(this,this.F().then(function(n){return t.b(e.c,n)}).then(function(t){return Ic(e,t),e.reload()}))},t.sb=function(t){var e=this;return Oc(this,this.F().then(function(n){return e.c.sb(n,t)}).then(function(t){return Ic(e,t),e.reload()}))},t.tb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return bc(this);var e=this;return Oc(this,this.F().then(function(n){return e.c.tb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Ic(e,t),Ec(e,"displayName",t.displayName||null),Ec(e,"photoURL",t.photoUrl||null),M(e.providerData,function(t){"password"===t.providerId&&(Dr(t,"displayName",e.displayName),Dr(t,"photoURL",e.photoURL))}),yc(e)}).then(vc))},t.Nc=function(t){var e=this;return Oc(this,Cc(this).then(function(n){return U(wc(e),t)?(r=e.c,i=n,o=[t],fs(r,Ka,{idToken:i,deleteProvider:o})).then(function(t){var n={};return M(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),M(wc(e),function(t){n[t]||Tc(e,t)}),n[eo.PROVIDER_ID]||Dr(e,"phoneNumber",null),yc(e)}):yc(e).then(function(){throw new Wr("no-such-provider")});var r,i,o}))},t.delete=function(){var t=this;return Oc(this,this.F().then(function(e){return fs(t.c,Wa,{idToken:e})}).then(function(){t.dispatchEvent(new ac("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");uc(t,null),lc(t,null),t.G=[],t.D=!0,pc(t),Dr(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},t.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.aa||null)==e||"reauthViaRedirect"==t&&(this.aa||null)==e)},t.ha=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},t.xa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?_(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?_(this.Cb,this):"linkViaRedirect"==t&&(this.aa||null)==e?_(this.Bb,this):"reauthViaRedirect"==t&&(this.aa||null)==e?_(this.Cb,this):null},t.qc=function(t){var e=this;return Dc(this,"linkViaPopup",t,function(){return Nc(e,t.providerId).then(function(){return yc(e)})},!1)},t.zc=function(t){return Dc(this,"reauthViaPopup",t,function(){return St()},!0)},t.rc=function(t){var e=this;return Rc(this,"linkViaRedirect",t,function(){return Nc(e,t.providerId)},!1)},t.Ac=function(t){return Rc(this,"reauthViaRedirect",t,function(){return St()},!0)},t.Bb=function(t,e,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return Oc(this,this.F().then(function(i){return La(r.c,{requestUri:t,postBody:n,sessionId:e,idToken:i})}).then(function(t){return i=Ac(r,t,"link"),kc(r,t)}).then(function(){return i}))},t.Cb=function(t,e,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return Oc(this,St().then(function(){return Ai(Fa(r.c,{requestUri:t,sessionId:e,postBody:n}),r.uid)}).then(function(t){return i=Ac(r,t,"reauthenticate"),Ic(r,t),r.i=null,r.reload()}).then(function(){return i}),!0)},t.kb=function(t){var e=this,n=null;return Oc(this,this.F().then(function(e){return n=e,void 0===t||it(t)?{}:ri(new Gr(t))}).then(function(t){return e.c.kb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.l,appName:this.o,authDomain:this.u,stsTokenManager:this.h.w(),redirectEventId:this.aa||null};return this.metadata&&ct(t,this.metadata.w()),M(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var Lc={name:"redirectUser",B:"session"};function Fc(t){return lu(t.b,Lc,t.a)}function Uc(t){var e,n,r,i,a,s,u,c,l;this.a=t,this.b=su(),this.c=null,this.f=(e=this,n=jc("local"),r=jc("session"),i=jc("none"),(a=e.b,s=n,u=e.a,c=cu(s,u),l=uu(a,s.B),a.get(s,u).then(function(t){var e=null;try{e=vr(o.localStorage.getItem(c))}catch(t){}if(e&&!t)return o.localStorage.removeItem(c),a.set(s,e,u);e&&t&&"localStorage"!=l.type&&o.localStorage.removeItem(c)})).then(function(){return e.b.get(r,e.a)}).then(function(t){return t?r:e.b.get(i,e.a).then(function(t){return t?i:e.b.get(n,e.a).then(function(t){return t?n:e.b.get(Vc,e.a).then(function(t){return t?jc(t):n})})})}).then(function(t){return e.c=t,qc(e,t.B)}).s(function(){e.c||(e.c=n)})),this.b.addListener(jc("local"),this.a,_(this.g,this))}function qc(t,e){var n,r,i=[];for(n in ou)ou[n]!==e&&i.push(lu(t.b,jc(ou[n]),t.a));return i.push(lu(t.b,Vc,t.a)),r=i,new gt(function(t,e){var n=r.length,i=[];if(n)for(var o=function(e,r){n--,i[e]=r,0==n&&t(i)},a=function(t){e(t)},s=0;s<r.length;s++)It(r[s],T(o,s),a);else t(i)})}Uc.prototype.g=function(){var t=this,e=jc("local");Qc(this,function(){return St().then(function(){return t.c&&"local"!=t.c.B?t.b.get(e,t.a):null}).then(function(n){if(n)return qc(t,"local").then(function(){t.c=e})})})};var Vc={name:"persistence",B:"session"};function jc(t){return{name:"authUser",B:t}}function Bc(t,e){return Qc(t,function(){return t.b.set(t.c,e.w(),t.a)})}function Wc(t){return Qc(t,function(){return lu(t.b,t.c,t.a)})}function Kc(t,e){return Qc(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),Pc(t||{})})})}function Qc(t,e){return t.f=t.f.then(e,e),t.f}function Hc(t){if(this.l=!1,Dr(this,"settings",new Xu),Dr(this,"app",t),!Zc(this).options||!Zc(this).options.apiKey)throw new Wr("invalid-api-key");var e,n,r,i,o,a,s,u,c,l,h;t=$i.SDK_VERSION?ur($i.SDK_VERSION):null,this.c=new ya(Zc(this).options&&Zc(this).options.apiKey,hi(ci),t),this.N=[],this.o=[],this.I=[],this.Rb=$i.INTERNAL.createSubscribe(_(this.kc,this)),this.O=void 0,this.Sb=$i.INTERNAL.createSubscribe(_(this.mc,this)),Jc(this,null),this.h=new Uc(Zc(this).options.apiKey+":"+Zc(this).name),this.A=new Mc(Zc(this).options.apiKey+":"+Zc(this).name),this.V=rl(this,(n=Zc(e=this).options.authDomain,r=(i=e,o=(a=i.A,s=Zc(i).options.authDomain,a.b.get(Lc,a.a).then(function(t){return t&&s&&(t.authDomain=s),Pc(t||{})})).then(function(t){return(i.D=t)&&(t.ba=i.A),Fc(i.A)}),rl(i,o)).then(function(){return Kc(e.h,n)}).then(function(t){return t?(t.ba=e.A,e.D&&(e.D.aa||null)==(t.aa||null)?t:t.reload().then(function(){return Bc(e.h,t).then(function(){return t})}).s(function(n){return"auth/network-request-failed"==n.code?t:Wc(e.h)})):null}).then(function(t){Jc(e,t||null)}),rl(e,r))),this.i=rl(this,(u=this).V.then(function(){return u.fa()}).s(function(){}).then(function(){if(!u.l)return u.ka()}).s(function(){}).then(function(){if(!u.l){u.X=!0;var t=u.h;t.b.addListener(jc("local"),t.a,u.ka)}})),this.X=!1,this.ka=_(this.Kc,this),this.Ha=_(this.Z,this),this.ra=_(this.Zb,this),this.sa=_(this.ic,this),this.ta=_(this.jc,this),l=Zc(c=this).options.authDomain,h=Zc(c).options.apiKey,l&&fr()&&(c.Qb=c.V.then(function(){if(!c.l){if(c.a=Ku(l,h,Zc(c).name),c.a.subscribe(c),tl(c)&&mc(tl(c)),c.D){mc(c.D);var t=c.D;t.pa(c.ea()),uc(t,c),cc(t=c.D,c.G),lc(t,c),c.D=null}return c.a}})),this.INTERNAL={},this.INTERNAL.delete=_(this.delete,this),this.INTERNAL.logFramework=_(this.sc,this),this.u=0,xe.call(this),Object.defineProperty(this,"lc",{get:function(){return this.ea()},set:function(t){this.pa(t)},enumerable:!1}),this.W=null,this.G=[]}function Gc(t){ue.call(this,"languageCodeChanged"),this.g=t}function zc(t){ue.call(this,"frameworkChanged"),this.c=t}function Yc(t){return t.Qb||Ct(new Wr("auth-domain-config-required"))}function Xc(t,e){var n={};return n.apiKey=Zc(t).options.apiKey,n.authDomain=Zc(t).options.authDomain,n.appName=Zc(t).name,t.V.then(function(){return r=n,i=e,o=t.A,a=t.ya(),s=new sc(r,i),o&&(s.ba=o),a&&cc(s,a),s.reload().then(function(){return s});var r,i,o,a,s}).then(function(e){return tl(t)&&e.uid==tl(t).uid?Sc(tl(t),e):(Jc(t,e),mc(e)),t.Z(e)}).then(function(){nl(t)})}function Jc(t,e){var n,r;tl(t)&&(n=tl(t),r=t.Ha,V(n.N,function(t){return t==r}),Ee(tl(t),"tokenChanged",t.ra),Ee(tl(t),"userDeleted",t.sa),Ee(tl(t),"userInvalidated",t.ta),pc(tl(t))),e&&(e.N.push(t.Ha),we(e,"tokenChanged",t.ra),we(e,"userDeleted",t.sa),we(e,"userInvalidated",t.ta),0<t.u&&fc(e)),Dr(t,"currentUser",e),e&&(e.pa(t.ea()),uc(e,t),cc(e,t.G),lc(e,t))}function $c(t,e){var n=null,r=null;return rl(t,e.then(function(e){return n=ro(e),r=mi(e),Xc(t,e)}).then(function(){return xr({user:tl(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Zc(t){return t.app}function tl(t){return t.currentUser}function el(t){return tl(t)&&tl(t)._lat||null}function nl(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](el(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](el(t))}}function rl(t,e){return t.N.push(e),e.ia(function(){q(t.N,e)}),e}function il(){}function ol(){this.a={},this.b=1e12}Uc.prototype.nb=function(t){var e=null,n=this;return function(t){var e=new Wr("invalid-persistence-type"),n=new Wr("unsupported-persistence-type");t:{for(r in ou)if(ou[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(nr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!hr()&&"none"!==t)throw n}}(t),Qc(this,function(){return t!=n.c.B?n.b.get(n.c,n.a).then(function(r){return e=r,qc(n,t)}).then(function(){if(n.c=jc(t),e)return n.b.set(n.c,e,n.a)}):St()})},S(Hc,xe),S(Gc,ue),S(zc,ue),(t=Hc.prototype).nb=function(t){return rl(this,t=this.h.nb(t))},t.pa=function(t){this.W===t||this.l||(this.W=t,Ta(this.c,this.W),this.dispatchEvent(new Gc(this.ea())))},t.ea=function(){return this.W},t.Qc=function(){var t=o.navigator;this.pa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.sc=function(t){this.G.push(t),Ea(this.c,$i.SDK_VERSION?ur($i.SDK_VERSION,this.G):null),this.dispatchEvent(new zc(this.G))},t.ya=function(){return B(this.G)},t.toJSON=function(){return{apiKey:Zc(this).options.apiKey,authDomain:Zc(this).options.authDomain,appName:Zc(this).name,currentUser:tl(this)&&tl(this).w()}},t.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.ha=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},t.xa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?_(this.Yb,this):null},t.Yb=function(t,e,n){var r=this;t={requestUri:t,postBody:n,sessionId:e},this.b&&(this.b.cancel(),this.b=null);var i=null,o=null,a=Ma(r.c,t).then(function(t){return i=ro(t),o=mi(t),t});return rl(this,t=r.V.then(function(){return a}).then(function(t){return Xc(r,t)}).then(function(){return xr({user:tl(r),credential:i,additionalUserInfo:o,operationType:"signIn"})}))},t.Ic=function(t){if(!fr())return Ct(new Wr("operation-not-supported-in-this-environment"));var e=this,n=yi(t.providerId),r=br(),i=null;(!yr()||tr())&&Zc(this).options.authDomain&&t.isOAuthProvider&&(i=Ns(Zc(this).options.authDomain,Zc(this).options.apiKey,Zc(this).name,"signInViaPopup",t,null,r,$i.SDK_VERSION||null));var o=Yn(i,n&&n.Ba,n&&n.Aa);return rl(this,n=Yc(this).then(function(e){return ju(e,o,"signInViaPopup",t,r,!!i)}).then(function(){return new gt(function(t,n){e.ha("signInViaPopup",null,new Wr("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.b=e.a.Ea(e,"signInViaPopup",o,r)})}).then(function(t){return o&&zn(o),t?xr(t):null}).s(function(t){throw o&&zn(o),t}))},t.Jc=function(t){if(!fr())return Ct(new Wr("operation-not-supported-in-this-environment"));var e=this;return rl(this,Yc(this).then(function(){return Qc(t=e.h,function(){return t.b.set(Vc,t.c.B,t.a)});var t}).then(function(){return e.a.Ca("signInViaRedirect",t)}))},t.fa=function(){if(!fr())return Ct(new Wr("operation-not-supported-in-this-environment"));var t=this;return rl(this,Yc(this).then(function(){return t.a.fa()}).then(function(t){return t?xr(t):null}))},t.Oc=function(t){if(!t)return Ct(new Wr("null-user"));var e=this,n={};n.apiKey=Zc(this).options.apiKey,n.authDomain=Zc(this).options.authDomain,n.appName=Zc(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.u,appName:t.o};var i=t.h,o={};return o[ga]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-E())/1e3,e=new sc(e,o),n&&(e.ba=n),r&&cc(e,r),Sc(e,t),e}(t,n,e.A,e.ya());return rl(this,this.i.then(function(){if(Zc(e).options.apiKey!=t.l)return r.reload()}).then(function(){return tl(e)&&t.uid==tl(e).uid?(Sc(tl(e),t),e.Z(t)):(Jc(e,r),mc(r),e.Z(r))}).then(function(){nl(e)}))},t.pb=function(){var t=this;return rl(this,this.i.then(function(){return tl(t)?(Jc(t,null),Wc(t.h).then(function(){nl(t)})):St()}))},t.Kc=function(){var t=this;return Kc(this.h,Zc(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=tl(t)&&e){n=tl(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Sc(tl(t),e),tl(t).F();(tl(t)||e)&&(Jc(t,e),e&&(mc(e),e.ba=t.A),t.a&&t.a.subscribe(t),nl(t))}})},t.Z=function(t){return Bc(this.h,t)},t.Zb=function(){nl(this),this.Z(tl(this))},t.ic=function(){this.pb()},t.jc=function(){this.pb()},t.kc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(tl(e))})},t.mc=function(t){var e,n,r=this;n=function(){t.next(tl(r))},(e=this).I.push(n),rl(e,e.i.then(function(){!e.l&&U(e.I,n)&&e.O!==e.getUid()&&(e.O=e.getUid(),n(el(e)))}))},t.uc=function(t,e,n){var r=this;return this.X&&Promise.resolve().then(function(){y(t)?t(tl(r)):y(t.next)&&t.next(tl(r))}),this.Rb(t,e,n)},t.tc=function(t,e,n){var r=this;return this.X&&Promise.resolve().then(function(){r.O=r.getUid(),y(t)?t(tl(r)):y(t.next)&&t.next(tl(r))}),this.Sb(t,e,n)},t.$b=function(t){var e=this;return rl(this,this.i.then(function(){return tl(e)?tl(e).F(t).then(function(t){return{accessToken:t}}):null}))},t.Ec=function(t){var e=this;return this.i.then(function(){return $c(e,fs(e.c,ss,{token:t}))}).then(function(t){var n=t.user;return Ec(n,"isAnonymous",!1),e.Z(n),t})},t.Fc=function(t,e){var n=this;return this.i.then(function(){return $c(n,fs(n.c,us,{email:t,password:e}))})},t.Ub=function(t,e){var n=this;return this.i.then(function(){return $c(n,fs(n.c,ja,{email:t,password:e}))})},t.Ra=function(t){var e=this;return this.i.then(function(){return $c(e,t.la(e.c))})},t.Dc=function(t){return Ar("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Ra(t)},t.ob=function(){var t=this;return this.i.then(function(){var e=tl(t);return e&&e.isAnonymous?xr({user:e,credential:null,additionalUserInfo:xr({providerId:null,isNewUser:!1}),operationType:"signIn"}):$c(t,t.c.ob()).then(function(e){var n=e.user;return Ec(n,"isAnonymous",!0),t.Z(n),e})})},t.getUid=function(){return tl(this)&&tl(this).uid||null},t.Tb=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&tl(this)&&fc(tl(this))},t.Bc=function(t){var e=this;M(this.o,function(n){n==t&&e.u--}),this.u<0&&(this.u=0),0==this.u&&tl(this)&&pc(tl(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.o.push(t),rl(this,this.i.then(function(){e.l||U(e.o,t)&&t(el(e))}))},t.removeAuthTokenListener=function(t){V(this.o,function(e){return e==t})},t.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h).b.removeListener(jc("local"),t.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Za()),Promise.resolve()},t.Xb=function(t){return rl(this,fs(this.c,Ba,{identifier:t,continueUri:pr()?Qn():"http://localhost"}).then(function(t){return t.signinMethods||[]}))},t.nc=function(t){return!!Xi(t)},t.mb=function(t,e){var n=this;return rl(this,St().then(function(){var t=new Gr(e);if(!t.c)throw new Wr("argument-error",Xr+" must be true when sending sign in link to email");return ri(t)}).then(function(e){return n.c.mb(t,e)}).then(function(){}))},t.Rc=function(t){return this.Ka(t).then(function(t){return t.data.email})},t.$a=function(t,e){return rl(this,this.c.$a(t,e).then(function(){}))},t.Ka=function(t){return rl(this,this.c.Ka(t).then(function(t){return new Pr(t)}))},t.Xa=function(t){return rl(this,this.c.Xa(t).then(function(){}))},t.lb=function(t,e){var n=this;return rl(this,St().then(function(){return void 0===e||it(e)?{}:ri(new Gr(e))}).then(function(e){return n.c.lb(t,e)}).then(function(){}))},t.Hc=function(t,e){return rl(this,$u(this,t,e,_(this.Ra,this)))},t.Gc=function(t,e){var n=this;return rl(this,St().then(function(){var r=Yi(t,e||Qn());return n.Ra(r)}))},il.prototype.render=function(){},il.prototype.reset=function(){},il.prototype.getResponse=function(){},il.prototype.execute=function(){};var al=null;function sl(t,e){return(e=ul(e))&&t.a[e]||null}function ul(t){return(t=void 0===t?1e12:t)?t.toString():null}function cl(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Mn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():we(this.f,"click",this.i)}function ll(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function hl(){}ol.prototype.render=function(t,e){return this.a[this.b.toString()]=new cl(t,e),this.b++},ol.prototype.reset=function(t){var e=sl(this,t);t=ul(t),e&&t&&(e.delete(),delete this.a[t])},ol.prototype.getResponse=function(t){return(t=sl(this,t))?t.getResponse():null},ol.prototype.execute=function(t){(t=sl(this,t))&&t.execute()},cl.prototype.getResponse=function(){return ll(this),this.b},cl.prototype.execute=function(){ll(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(e){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()},6e4)},500))},cl.prototype.delete=function(){ll(this),this.g=!0,clearTimeout(this.a),this.a=null,Ee(this.f,"click",this.i)},hl.prototype.g=function(){return al||(al=new ol),St(al)},hl.prototype.c=function(){};var fl=null;function pl(){this.b=o.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var dl=new mn(bn,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),yl=new Tr(3e4,6e4);pl.prototype.g=function(t){var e=this;return new gt(function(n,r){var i=setTimeout(function(){r(new Wr("network-request-failed"))},yl.get());!o.grecaptcha||t!==e.f&&!e.b?(o[e.a]=function(){if(o.grecaptcha){e.f=t;var a=o.grecaptcha.render;o.grecaptcha.render=function(t,n){return t=a(t,n),e.b++,t},clearTimeout(i),n(o.grecaptcha)}else clearTimeout(i),r(new Wr("internal-error"));delete o[e.a]},St(ua(Tn(dl,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(i),r(new Wr("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),n(o.grecaptcha))})},pl.prototype.c=function(){this.b--};var ml=null;function gl(t,e,n,r,i,a,s){if(Dr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.l=e,this.g=null,s=s?(fl||(fl=new hl),fl):(ml||(ml=new pl),ml),this.o=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[wl])throw new Wr("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[_l],!o.document)throw new Wr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Mn(e)||!this.i&&Mn(e).hasChildNodes())throw new Wr("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new ya(t,a||null,i||null),this.v=r||function(){return null};var u=this;this.m=[];var c=this.a[vl];this.a[vl]=function(t){if(Tl(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=lr(c,o);"function"==typeof e&&e(t)}};var l=this.a[bl];this.a[bl]=function(){if(Tl(u,null),"function"==typeof l)l();else if("string"==typeof l){var t=lr(l,o);"function"==typeof t&&t()}}}var vl="callback",bl="expired-callback",wl="sitekey",_l="size";function Tl(t,e){for(var n=0;n<t.m.length;n++)try{t.m[n](e)}catch(t){}}function El(t,e){return t.h.push(e),e.ia(function(){q(t.h,e)}),e}function Sl(t){if(t.D)throw new Wr("internal-error","RecaptchaVerifier instance has been destroyed.")}function Cl(t,e,n){var r=!1;try{this.b=n||$i.app()}catch(t){throw new Wr("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Wr("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().ya()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=$i.SDK_VERSION?ur($i.SDK_VERSION,o):null,gl.call(this,n,t,e,function(){try{var t=i.b.auth().ea()}catch(e){t=null}return t},o,hi(ci),r)}function Il(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Wr("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],i<0||i>=Nl.length)throw new Wr("internal-error","Argument validator received an unsupported number of arguments.");n=Nl[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new Wr("argument-error",t+" failed: "+r)}(t=gl.prototype).za=function(){var t=this;return this.f?this.f:this.f=El(this,St().then(function(){if(pr()&&!er())return $n();throw new Wr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,fs(t.u,$a,{})}).then(function(e){t.a[wl]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},t.render=function(){Sl(this);var t=this;return El(this,this.za().then(function(){if(null===t.c){var e=t.l;if(!t.i){var n=Mn(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!yn&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',ht(s.name),'"'),s.type){o.push(' type="',ht(s.type),'"');var u={};ct(u,s),delete u.type,s=u}o.push(">"),o=o.join("")}return o=i.createElement(o),s&&(a(s)?o.className=s:p(s)?o.className=s.join(" "):Ln(o,s)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild(a(n)?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!d(o)||m(o)&&0<o.nodeType?r(o):M(Un(o)?B(o):o,r)}}(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){Sl(this);var t=this;return El(this,this.render().then(function(e){return new gt(function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){var r;e&&(r=i,V(t.m,function(t){return t==r}),n(e))};t.m.push(i),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){Sl(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Sl(this),this.D=!0,this.o.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=Mn(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}},S(Cl,gl);var Nl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Al(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:a}}function kl(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:s}}function Dl(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:m}}function Rl(t,e){return{name:t||"",K:"a function",optional:!!e,M:y}}function xl(t,e){return{name:t||"",K:"null",optional:!!e,M:f}}function Ol(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.la||!n)}}}function Pl(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!!(t&&a(t.type)&&y(t.verify))}}}function Ml(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Ll(t,e){for(var n in e){var r=e[n].name;t[r]=ql(r,t[n],e[n].j)}}function Fl(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:T(function(t){return this[t]},n),set:T(function(t,e,n,r){Il(t,[n],[r],!0),this[e]=r},r,n,e[n].vb),enumerable:!0})}}function Ul(t,e,n,r){t[e]=ql(e,n,r)}function ql(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Il(a,n,t),e.apply(this,t)}if(!n)return e;var i,o,a=(o=(o=t).split("."))[o.length-1];for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Ll(Hc.prototype,{Xa:{name:"applyActionCode",j:[Al("code")]},Ka:{name:"checkActionCode",j:[Al("code")]},$a:{name:"confirmPasswordReset",j:[Al("code"),Al("newPassword")]},Ub:{name:"createUserWithEmailAndPassword",j:[Al("email"),Al("password")]},Xb:{name:"fetchSignInMethodsForEmail",j:[Al("email")]},fa:{name:"getRedirectResult",j:[]},nc:{name:"isSignInWithEmailLink",j:[Al("emailLink")]},tc:{name:"onAuthStateChanged",j:[Ml(Dl(),Rl(),"nextOrObserver"),Rl("opt_error",!0),Rl("opt_completed",!0)]},uc:{name:"onIdTokenChanged",j:[Ml(Dl(),Rl(),"nextOrObserver"),Rl("opt_error",!0),Rl("opt_completed",!0)]},lb:{name:"sendPasswordResetEmail",j:[Al("email"),Ml(Dl("opt_actionCodeSettings",!0),xl(null,!0),"opt_actionCodeSettings",!0)]},mb:{name:"sendSignInLinkToEmail",j:[Al("email"),Dl("actionCodeSettings")]},nb:{name:"setPersistence",j:[Al("persistence")]},Dc:{name:"signInAndRetrieveDataWithCredential",j:[Ol()]},ob:{name:"signInAnonymously",j:[]},Ra:{name:"signInWithCredential",j:[Ol()]},Ec:{name:"signInWithCustomToken",j:[Al("token")]},Fc:{name:"signInWithEmailAndPassword",j:[Al("email"),Al("password")]},Gc:{name:"signInWithEmailLink",j:[Al("email"),Al("emailLink",!0)]},Hc:{name:"signInWithPhoneNumber",j:[Al("phoneNumber"),Pl()]},Ic:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Jc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"updateCurrentUser",j:[Ml({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof sc)}},xl(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Al(null,!0)]},Qc:{name:"useDeviceLanguage",j:[]},Rc:{name:"verifyPasswordResetCode",j:[Al("code")]}}),Fl(Hc.prototype,{lc:{name:"languageCode",vb:Ml(Al(),xl(),"languageCode")}}),(Hc.Persistence=ou).LOCAL="local",Hc.Persistence.SESSION="session",Hc.Persistence.NONE="none",Ll(sc.prototype,{delete:{name:"delete",j:[]},ac:{name:"getIdTokenResult",j:[kl("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[kl("opt_forceRefresh",!0)]},oc:{name:"linkAndRetrieveDataWithCredential",j:[Ol()]},fb:{name:"linkWithCredential",j:[Ol()]},pc:{name:"linkWithPhoneNumber",j:[Al("phoneNumber"),Pl()]},qc:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},rc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},xc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Ol()]},hb:{name:"reauthenticateWithCredential",j:[Ol()]},yc:{name:"reauthenticateWithPhoneNumber",j:[Al("phoneNumber"),Pl()]},zc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ac:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},kb:{name:"sendEmailVerification",j:[Ml(Dl("opt_actionCodeSettings",!0),xl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Al(null,!0)]},Nc:{name:"unlink",j:[Al("provider")]},rb:{name:"updateEmail",j:[Al("email")]},sb:{name:"updatePassword",j:[Al("password")]},Pc:{name:"updatePhoneNumber",j:[Ol("phone")]},tb:{name:"updateProfile",j:[Dl("profile")]}}),Ll(ol.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Ll(il.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Ll(gt.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Fl(Xu.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",vb:kl("appVerificationDisabledForTesting")}}),Ll(Ju.prototype,{confirm:{name:"confirm",j:[Al("verificationCode")]}}),Ul(Ni,"fromJSON",function(t){t=a(t)?JSON.parse(t):t;for(var e,n=[Pi,Gi,Zi,Ri],r=0;r<n.length;r++)if(e=n[r](t))return e;return null},[Ml(Al(),Dl(),"json")]),Ul(zi,"credential",function(t,e){return new Hi(t,e)},[Al("email"),Al("password")]),Ll(Hi.prototype,{w:{name:"toJSON",j:[Al(null,!0)]}}),Ll(Ui.prototype,{ua:{name:"addScope",j:[Al("scope")]},Da:{name:"setCustomParameters",j:[Dl("customOAuthParameters")]}}),Ul(Ui,"credential",qi,[Ml(Al(),Dl(),"token")]),Ul(zi,"credentialWithLink",Yi,[Al("email"),Al("emailLink")]),Ll(Vi.prototype,{ua:{name:"addScope",j:[Al("scope")]},Da:{name:"setCustomParameters",j:[Dl("customOAuthParameters")]}}),Ul(Vi,"credential",ji,[Ml(Al(),Dl(),"token")]),Ll(Bi.prototype,{ua:{name:"addScope",j:[Al("scope")]},Da:{name:"setCustomParameters",j:[Dl("customOAuthParameters")]}}),Ul(Bi,"credential",Wi,[Ml(Al(),Ml(Dl(),xl()),"idToken"),Ml(Al(),xl(),"accessToken",!0)]),Ll(Ki.prototype,{Da:{name:"setCustomParameters",j:[Dl("customOAuthParameters")]}}),Ul(Ki,"credential",Qi,[Ml(Al(),Dl(),"token"),Al("secret",!0)]),Ll(Fi.prototype,{ua:{name:"addScope",j:[Al("scope")]},credential:{name:"credential",j:[Ml(Al(),Ml(Dl(),xl()),"optionsOrIdToken"),Ml(Al(),xl(),"accessToken",!0)]},Da:{name:"setCustomParameters",j:[Dl("customOAuthParameters")]}}),Ll(xi.prototype,{w:{name:"toJSON",j:[Al(null,!0)]}}),Ll(ki.prototype,{w:{name:"toJSON",j:[Al(null,!0)]}}),Ul(eo,"credential",no,[Al("verificationId"),Al("verificationCode")]),Ll(eo.prototype,{Va:{name:"verifyPhoneNumber",j:[Al("phoneNumber"),Pl()]}}),Ll(Ji.prototype,{w:{name:"toJSON",j:[Al(null,!0)]}}),Ll(Wr.prototype,{toJSON:{name:"toJSON",j:[Al(null,!0)]}}),Ll(ho.prototype,{toJSON:{name:"toJSON",j:[Al(null,!0)]}}),Ll(lo.prototype,{toJSON:{name:"toJSON",j:[Al(null,!0)]}}),Ll(Cl.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===$i||!$i.INTERNAL||!$i.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:Hc,AuthCredential:Ni,Error:Wr};Ul(t,"EmailAuthProvider",zi,[]),Ul(t,"FacebookAuthProvider",Ui,[]),Ul(t,"GithubAuthProvider",Vi,[]),Ul(t,"GoogleAuthProvider",Bi,[]),Ul(t,"TwitterAuthProvider",Ki,[]),Ul(t,"OAuthProvider",Fi,[Al("providerId")]),Ul(t,"SAMLAuthProvider",Li,[Al("providerId")]),Ul(t,"PhoneAuthProvider",eo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof Hc)}}]),Ul(t,"RecaptchaVerifier",Cl,[Ml(Al(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Dl("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof $i.app.App)}}]),$i.INTERNAL.registerService("auth",function(t,e){return e({INTERNAL:{getUid:_((t=new Hc(t)).getUid,t),getToken:_(t.$b,t),addAuthTokenListener:_(t.Tb,t),removeAuthTokenListener:_(t.Bc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),$i.INTERNAL.extendNamespace({User:sc})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Zi,to=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),wi(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:bi(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),eo=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return Ti(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),no=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new to(e)}}catch(t){}return new eo},ro=no("localStorage"),io=no("sessionStorage"),oo=new Bi("@firebase/database"),ao=(Zi=1,function(){return Zi++}),so=function(t){var e=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(55296<=i&&i<=56319){var o=i-55296;ri(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}e[n++]=i<128?i:(e[n++]=i<2048?i>>6|192:(e[n++]=i<65536?i>>12|224:(e[n++]=i>>18|240,i>>12&63|128),i>>6&63|128),63&i|128)}return e}(t),n=new Ii;n.update(e);var r=n.digest();return ui.encodeByteArray(r)},uo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"==typeof t[r]&&"number"==typeof t[r].length?n+=uo.apply(null,t[r]):"object"==typeof t[r]?n+=wi(t[r]):n+=t[r],n+=" ";return n},co=null,lo=!0,ho=function(t,e){ri(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(oo.logLevel=Pi.VERBOSE,co=oo.log.bind(oo),e&&io.set("logging_enabled",!0)):"function"==typeof t?co=t:(co=null,io.remove("logging_enabled"))},fo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===lo&&(lo=!1,null===co&&!0===io.get("logging_enabled")&&ho(!0)),co){var n=uo.apply(null,t);co(n)}},po=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];fo.apply(void 0,ei([t],e))}},yo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+uo.apply(void 0,ei(t));oo.error(n)},mo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+uo.apply(void 0,ei(t));throw oo.error(n),new Error(n)},go=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+uo.apply(void 0,ei(t));oo.warn(n)},vo=function(t){return"number"==typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},bo="[MIN_NAME]",wo="[MAX_NAME]",_o=function(t,e){if(t===e)return 0;if(t===bo||e===wo)return-1;if(e===bo||t===wo)return 1;var n=qo(t),r=qo(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},To=function(t,e){return t===e?0:t<e?-1:1},Eo=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+wi(e))},So=function(t){if("object"!=typeof t||null===t)return wi(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=wi(e[i]),r+=":",r+=So(t[e[i]]);return r+"}"},Co=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)n<i+e?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Io(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var No,Ao,ko,Do,Ro,xo,Oo,Po,Mo,Lo,Fo=function(t){var e,n,r,i,o,a,s;for(ri(!vo(t),"Invalid JSON number"),0===t?e=1/t==-1/(r=n=0)?1:0:(e=t<0,r=(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(t/Math.pow(2,-1074)))),a=[],o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse(),s=a.join("");var u="";for(o=0;o<64;o+=8){var c=parseInt(s.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()},Uo=new RegExp("^-?\\d{1,10}$"),qo=function(t){if(Uo.test(t)){var e=Number(t);if(-2147483648<=e&&e<=2147483647)return e}return null},Vo=function(t){try{t()}catch(t){setTimeout(function(){var e=t.stack||"";throw go("Exception was thrown by user callback.",e),t},Math.floor(0))}},jo=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},Bo=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)0<this.pieces_[r].length&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)0<i[r].length&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=_o(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),Wo=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Li(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){0<this.parts_.length&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=Li(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=Li(t),0<this.parts_.length&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),Ko="firebaseio.com",Qo="websocket",Ho="long_polling",Go=function(){function t(t,e,n,r,i){void 0===i&&(i=""),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=ro.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&ro.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(ri("string"==typeof t,"typeof type must == string"),ri("object"==typeof e,"typeof params must == object"),t===Qo)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==Ho)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return Io(e,function(t,e){r.push(t+"="+e)}),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}(),zo=function(t){var e=Yo(t),n=e.subdomain;"firebase"===e.domain&&mo(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===e.domain||mo("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&go("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new Go(e.host,e.secure,n,r),path:new Bo(e.pathString)}},Yo=function(t){var e="",n="",r="",i="",o=!0,a="https",s=443;if("string"==typeof t){var u=t.indexOf("//");0<=u&&(a=t.substring(0,u-1),t=t.substring(u+2));var c=t.indexOf("/");-1===c&&(c=t.length);var l=t.indexOf("?");-1===l&&(l=t.length),e=t.substring(0,Math.min(c,l)),c<l&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(0<n[r].length){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(c,l)));var h=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=Zr(t.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var s=a.split("=");2===s.length?r[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):go("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,l)));0<=(u=e.indexOf(":"))?(o="https"===a||"wss"===a,s=parseInt(e.substring(u+1),10)):u=t.length;var f=e.split(".");3===f.length?(n=f[1],r=f[0].toLowerCase()):2===f.length?n=f[0]:"localhost"===f[0].slice(0,u).toLowerCase()&&(n="localhost"),""===r&&"ns"in h&&(r=h.ns)}return{host:e,port:s,domain:n,subdomain:r,secure:o,scheme:a,pathString:i}},Xo=/[\[\].#$\/\u0000-\u001F\u007F]/,Jo=/[\[\].#$\u0000-\u001F\u007F]/,$o=10485760,Zo=function(t){return"string"==typeof t&&0!==t.length&&!Xo.test(t)},ta=function(t){return"string"==typeof t&&0!==t.length&&!Jo.test(t)},ea=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!vo(t)||t&&"object"==typeof t&&Ti(t,".sv")},na=function(t,e,n,r,i){i&&void 0===n||ra(Ri(t,e,i),n,r)},ra=function(t,e,n){var r=n instanceof Bo?new Wo(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(vo(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>$o/3&&Li(e)>$o)throw new Error(t+"contains a string greater than "+$o+" utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(Io(e,function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!Zo(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),ra(t,n,r),r.pop()}),i&&o)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},ia=function(t,e,n,r,i){if(!i||void 0!==n){var o=Ri(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];Io(n,function(t,e){var n=new Bo(t);if(ra(o,e,r.child(n)),".priority"===n.getBack()&&!ea(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)}),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Zo(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Bo.comparePaths);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&a.contains(r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(o,a)}},oa=function(t,e,n,r){if(!r||void 0!==n){if(vo(n))throw new Error(Ri(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ea(n))throw new Error(Ri(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},aa=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Ri(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},sa=function(t,e,n,r){if(!(r&&void 0===n||Zo(n)))throw new Error(Ri(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ua=function(t,e,n,r){if(!(r&&void 0===n||ta(n)))throw new Error(Ri(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ca=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},la=function(t,e,n){var r,i=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!Zo(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==i.length&&((r=i)&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),!ta(r)))throw new Error(Ri(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ha=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){Di("OnDisconnect.cancel",0,1,arguments.length),xi("OnDisconnect.cancel",1,t,!0);var e=new hi;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){Di("OnDisconnect.remove",0,1,arguments.length),ca("OnDisconnect.remove",this.path_),xi("OnDisconnect.remove",1,t,!0);var e=new hi;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){Di("OnDisconnect.set",1,2,arguments.length),ca("OnDisconnect.set",this.path_),na("OnDisconnect.set",1,t,this.path_,!1),xi("OnDisconnect.set",2,e,!0);var n=new hi;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){Di("OnDisconnect.setWithPriority",2,3,arguments.length),ca("OnDisconnect.setWithPriority",this.path_),na("OnDisconnect.setWithPriority",1,t,this.path_,!1),oa("OnDisconnect.setWithPriority",2,e,!1),xi("OnDisconnect.setWithPriority",3,n,!0);var r=new hi;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(Di("OnDisconnect.update",1,2,arguments.length),ca("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,go("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ia("OnDisconnect.update",1,t,this.path_,!1),xi("OnDisconnect.update",2,e,!0);var i=new hi;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),fa=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return Di("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),pa=(No="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Ao=0,ko=[],function(t){var e,n=t===Ao;Ao=t;var r=new Array(8);for(e=7;0<=e;e--)r[e]=No.charAt(t%64),t=Math.floor(t/64);ri(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;0<=e&&63===ko[e];e--)ko[e]=0;ko[e]++}else for(e=0;e<12;e++)ko[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=No.charAt(ko[e]);return ri(20===i.length,"nextPushId: Length should be 20."),i}),da=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),ya=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new da(bo,t),r=new da(bo,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return da.MIN},t}(),ma=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Do},set:function(t){Do=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return _o(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw ii("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return da.MIN},e.prototype.maxPost=function(){return new da(wo,Do)},e.prototype.makePost=function(t,e){return ri("string"==typeof t,"KeyIndex indexValue must always be a string."),new da(t,Do)},e.prototype.toString=function(){return".key"},e}(ya),ga=new ma,va=function(t){return"number"==typeof t?"number:"+Fo(t):"string:"+t},ba=function(t){if(t.isLeafNode()){var e=t.val();ri("string"==typeof e||"number"==typeof e||"object"==typeof e&&Ti(e,".sv"),"Priority must be a string or number.")}else ri(t===Ro||t.isEmpty(),"priority of unexpected type.");ri(t===Ro||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},wa=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,ri(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ba(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return xo},set:function(t){xo=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(ri(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+va(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?Fo(this.value_):this.value_,this.lazyHash_=so(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(ri(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return ri(0<=i,"Unknown leaf type: "+n),ri(0<=o,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),_a=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?_o(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return da.MIN},e.prototype.maxPost=function(){return new da(wo,new wa("[PRIORITY-POST]",Po))},e.prototype.makePost=function(t,e){var n=Oo(t);return new da(e,new wa("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(ya)),Ta=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return 0<this.nodeStack_.length},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Ea=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Ca.EMPTY_NODE,this.right=null!=o?o:Ca.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r,i;return(i=(r=n(t,(i=this).key))<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Ca.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Ca.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Sa=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Ea(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Ca=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ea.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ea.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:0<e&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:0<e&&(n=(r=n).right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Ta(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Ta(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Ta(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Ta(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Sa,t}(),Ia=Math.log(2),Na=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Ia,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Aa=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0==s)return null;if(1==s)return o=t[e],a=n?n(o):o,new Ea(a,o.node,Ea.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],a=n?n(o):o,new Ea(a,o.node,Ea.BLACK,c,l)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),l=t[o],h=n?n(l):l;u(new Ea(h,l.node,r,null,c))},u=function(t){r=r?r.left=t:o=t},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?s(h,Ea.BLACK):(s(h,Ea.BLACK),s(h,Ea.RED))}return o}(new Na(t.length));return new Ca(r||e,o)},ka={},Da=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return ri(_a,"ChildrenNode.ts has not been loaded"),Mo=Mo||new t({".priority":ka},{".priority":_a})},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=Ei(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Ca?e:null},t.prototype.hasIndex=function(t){return Ti(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){ri(e!==ga,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,a=n.getIterator(da.Wrap),s=a.getNext();s;)o=o||e.isDefinedOn(s.node),i.push(s),s=a.getNext();r=o?Aa(i,e.getCompare()):ka;var u=e.toString(),c=Xr({},this.indexSet_);c[u]=e;var l=Xr({},this.indexes_);return l[u]=r,new t(l,c)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(Ci(this.indexes_,function(t,i){var o=Ei(r.indexSet_,i);if(ri(o,"Missing index implementation for "+i),t===ka){if(o.isDefinedOn(e.node)){for(var a=[],s=n.getIterator(da.Wrap),u=s.getNext();u;)u.name!=e.name&&a.push(u),u=s.getNext();return a.push(e),Aa(a,o.getCompare())}return ka}var c=n.get(e.name),l=t;return c&&(l=l.remove(new da(e.name,c))),l.insert(e,e.node)}),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(Ci(this.indexes_,function(t){if(t===ka)return t;var r=n.get(e.name);return r?t.remove(new da(e.name,r)):t}),this.indexSet_)},t}();function Ra(t,e){return _o(t.name,e.name)}function xa(t,e){return _o(t,e)}var Oa=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&ba(this.priorityNode_),this.children_.isEmpty()&&ri(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Lo||(Lo=new t(new Ca(xa),null,Da.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Lo},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Lo:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(ri(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r,i=new da(e,n),o=void 0;return r=n.isEmpty()?(o=this.children_.remove(e),this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(e,n),this.indexMap_.addToIndexes(i,this.children_)),new t(o,o.isEmpty()?Lo:this.priorityNode_,r)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;ri(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(_a,function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+va(this.getPriority().val())+":"),this.forEachChild(_a,function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)}),this.lazyHash_=""===t?"":so(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new da(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new da(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new da(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this.children_.getIteratorFrom(t.name,da.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this.children_.getReverseIteratorFrom(t.name,da.Wrap),i=r.peek();null!=i&&0<e.compare(i,t);)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Pa?-1:0},t.prototype.withIndex=function(e){if(e===ga||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===ga||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()!==e.children_.count())return!1;for(var n=this.getIterator(_a),r=e.getIterator(_a),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1},t.prototype.resolveIndex_=function(t){return t===ga?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Pa=new(function(t){function e(){return t.call(this,new Ca(xa),Oa.EMPTY_NODE,Da.Default)||this}return Yr(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return Oa.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(Oa));Object.defineProperties(da,{MIN:{value:new da(bo,Oa.EMPTY_NODE)},MAX:{value:new da(wo,Pa)}}),ma.__EMPTY_NODE=Oa.EMPTY_NODE,wa.__childrenNodeConstructor=Oa,Ro=Pa,Po=Pa;var Ma=!0;function La(t,e){if(void 0===e&&(e=null),null===t)return Oa.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),ri(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new wa(t,La(e));if(t instanceof Array||!Ma){var n=Oa.EMPTY_NODE;return Io(t,function(e,r){if(Ti(t,e)&&"."!==e.substring(0,1)){var i=La(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}}),n.updatePriority(La(e))}var r=[],i=!1;if(Io(t,function(t,e){if("."!==t.substring(0,1)){var n=La(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new da(t,n)))}}),0==r.length)return Oa.EMPTY_NODE;var o=Aa(r,Ra,function(t){return t.name},xa);if(i){var a=Aa(r,_a.getCompare());return new Oa(o,La(e),new Da({".priority":a},{".priority":_a}))}return new Oa(o,La(e),Da.Default)}Oo=La;var Fa,Ua,qa,Va=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?_o(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return da.MIN},e.prototype.maxPost=function(){return da.MAX},e.prototype.makePost=function(t,e){var n=La(t);return new da(e,n)},e.prototype.toString=function(){return".value"},e}(ya)),ja=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,ri(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return Yr(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?_o(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=La(t),r=Oa.EMPTY_NODE.updateChild(this.indexPath_,n);return new da(e,r)},e.prototype.maxPost=function(){var t=Oa.EMPTY_NODE.updateChild(this.indexPath_,Pa);return new da(wo,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(ya),Ba=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return Di("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return Di("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return Di("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return Di("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){Di("DataSnapshot.child",0,1,arguments.length),e=String(e),ua("DataSnapshot.child",1,e,!1);var n=new Bo(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,_a)},t.prototype.hasChild=function(t){Di("DataSnapshot.hasChild",1,1,arguments.length),ua("DataSnapshot.hasChild",1,t,!1);var e=new Bo(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return Di("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;return Di("DataSnapshot.forEach",1,1,arguments.length),xi("DataSnapshot.forEach",1,e,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(r,i){return e(new t(i,n.ref_.child(r),_a))})},t.prototype.hasChildren=function(){return Di("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return Di("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return Di("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),Wa=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+wi(this.snapshot.exportVal())},t}(),Ka=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Qa=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Wa("value",this,new Ba(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){ri(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Ka(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Ha=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,Ti(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Ka(this,t,e):null},t.prototype.createEvent=function(t,e){ri(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Wa(t.type,this,new Ba(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){ri(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1!==o)return i.every(function(t){return e.callbacks_[t]===n.callbacks_[t]});var a=r[0],s=i[0];return!(s!==a||e.callbacks_[a]&&this.callbacks_[s]&&e.callbacks_[a]!==this.callbacks_[s])}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),Ga=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return ri(Fa,"Reference.ts has not been loaded"),Fa},set:function(t){Fa=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===ga){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=bo)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!=wo)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===_a){if(null!=e&&!ea(e)||null!=n&&!ea(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(ri(t.getIndex()instanceof ja||t.getIndex()===Va,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return Di("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){Di("Query.on",2,4,arguments.length),aa("Query.on",1,e,!1),xi("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new Qa(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new Ha(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){Di("Query.off",0,3,arguments.length),aa("Query.off",1,t,!0),xi("Query.off",2,e,!0),Oi("Query.off",3,n,!0);var r=null,i=null;"value"===t?r=new Qa(e||null,null,n||null):t&&(e&&((i={})[t]=e),r=new Ha(i,null,n||null)),this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var o=this;Di("Query.once",1,4,arguments.length),aa("Query.once",1,e,!1),xi("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),s=!0,u=new hi;u.promise.catch(function(){});var c=function(t){s&&(s=!1,o.off(e,c),n&&n.bind(a.context)(t),u.resolve(t))};return this.on(e,c,function(t){o.off(e,c),a.cancel&&a.cancel.bind(a.context)(t),u.reject(t)}),u.promise},t.prototype.limitToFirst=function(e){if(Di("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(Di("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(Di("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');ua("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new Bo(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new ja(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){Di("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(ga);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){Di("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(_a);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){Di("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Va);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),Di("Query.startAt",0,2,arguments.length),na("Query.startAt",1,e,this.path,!0),sa("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(n=e=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),Di("Query.endAt",0,2,arguments.length),na("Query.endAt",1,e,this.path,!0),sa("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(Di("Query.equalTo",1,2,arguments.length),na("Query.equalTo",1,t,this.path,!1),sa("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return Di("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return Di("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=So(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(Di("Query.isEqual",1,1,arguments.length),!(e instanceof t))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var n=this.repo===e.repo,r=this.path.equals(e.path),i=this.queryIdentifier()===e.queryIdentifier();return n&&r&&i},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,xi(t,3,r.cancel,!0),r.context=n,Oi(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(Ri(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),za=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&0<this.children.size){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(_a,function(t,e){n.remember(new Bo(t),e)}),this.forget(t)}if(0<this.children.size){var r=t.getFront();return t=t.popFront(),this.children.has(r)&&this.children.get(r).forget(t)&&this.children.delete(r),0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild(function(n,r){var i=new Bo(t.toString()+"/"+n);r.forEachTree(i,e)})},t.prototype.forEachChild=function(t){this.children.forEach(function(e,n){t(n,e)})},t}(),Ya=function(t,e){return t&&"object"==typeof t?(ri(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},Xa=function(t,e){var n,r=t.getPriority().val(),i=Ya(r,e);if(t.isLeafNode()){var o=t,a=Ya(o.getValue(),e);return a!==o.getValue()||i!==o.getPriority().val()?new wa(a,La(i)):t}var s=t;return i!==(n=s).getPriority().val()&&(n=n.updatePriority(new wa(i))),s.forEachChild(_a,function(t,r){var i=Xa(r,e);i!==r&&(n=n.updateImmediateChild(t,i))}),n};(qa=Ua||(Ua={}))[qa.OVERWRITE=0]="OVERWRITE",qa[qa.MERGE=1]="MERGE",qa[qa.ACK_USER_WRITE=2]="ACK_USER_WRITE",qa[qa.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var Ja,$a,Za=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,ri(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),ts=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Ua.ACK_USER_WRITE,this.source=Za.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return ri(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new Bo(e));return new t(Bo.Empty,n,this.revert)}return ri(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),es=function(){function t(t,e){void 0===e&&(Ja||(Ja=new Ca(To)),e=Ja),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return Io(e,function(t,e){n=n.set(new Bo(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:Bo.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null===r)return null;var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null==i?null:{path:new Bo(n).child(i.path),value:i.value}},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r,i=e.getFront(),o=(this.children.get(i)||t.Empty).setTree(e.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(Bo.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(t.child(r),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,Bo.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,Bo.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(Bo.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,r){r.foreach_(t.child(n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t.Empty=new t(null),t}(),ns=function(){function t(t,e){this.source=t,this.path=e,this.type=Ua.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Bo.Empty):new t(this.source,this.path.popFront())},t}(),rs=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Ua.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Bo.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),is=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Ua.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new Bo(e));return n.isEmpty()?null:n.value?new rs(this.source,Bo.Empty,n.value):new t(this.source,Bo.Empty,n)}return ri(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),os=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),as=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new os(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new os(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new os(Oa.EMPTY_NODE,!1,!1),new os(Oa.EMPTY_NODE,!1,!1)),t}(),ss=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),us=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){ri(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()==n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(ss.childRemovedChange(e,a)):ri(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ss.childAddedChange(e,n)):o.trackChildChange(ss.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(_a,function(t,r){e.hasChild(t)||n.trackChildChange(ss.childRemovedChange(t,r))}),e.isLeafNode()||e.forEachChild(_a,function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(ss.childChangedChange(e,r,i))}else n.trackChildChange(ss.childAddedChange(e,r))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?Oa.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),cs=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;ri(e==ss.CHILD_ADDED||e==ss.CHILD_CHANGED||e==ss.CHILD_REMOVED,"Only child changes supported for tracking"),ri(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e==ss.CHILD_ADDED&&i==ss.CHILD_REMOVED)this.changeMap.set(n,ss.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e==ss.CHILD_REMOVED&&i==ss.CHILD_ADDED)this.changeMap.delete(n);else if(e==ss.CHILD_REMOVED&&i==ss.CHILD_CHANGED)this.changeMap.set(n,ss.childRemovedChange(n,r.oldSnap));else if(e==ss.CHILD_CHANGED&&i==ss.CHILD_ADDED)this.changeMap.set(n,ss.childAddedChange(n,t.snapshotNode));else{if(e!=ss.CHILD_CHANGED||i!=ss.CHILD_CHANGED)throw ii("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,ss.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),ls=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),hs=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new os(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),fs=function(t,e){this.viewCache=t,this.changes=e},ps=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){ri(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),ri(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var o,a,s=new cs;if(n.type===Ua.OVERWRITE){var u=n;o=u.source.fromUser?this.applyUserOverwrite_(e,u.path,u.snap,r,i,s):(ri(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.getServerCache().isFiltered()&&!u.path.isEmpty(),this.applyServerOverwrite_(e,u.path,u.snap,r,i,a,s))}else if(n.type===Ua.MERGE){var c=n;o=c.source.fromUser?this.applyUserMerge_(e,c.path,c.children,r,i,s):(ri(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered(),this.applyServerMerge_(e,c.path,c.children,r,i,a,s))}else if(n.type===Ua.ACK_USER_WRITE){var l=n;o=l.revert?this.revertUserWrite_(e,l.path,r,i,s):this.ackUserWrite_(e,l.path,l.affectedTree,r,i,s)}else{if(n.type!==Ua.LISTEN_COMPLETE)throw ii("Unknown operation type: "+n.type);o=this.listenComplete_(e,n.path,r,s)}var h=s.getChanges();return t.maybeAddValueEvent_(e,o,h),new fs(o,h)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(0<n.length||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(ss.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,s=void 0;if(e.isEmpty())if(ri(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var u=t.getCompleteServerSnap(),c=u instanceof Oa?u:Oa.EMPTY_NODE,l=n.calcCompleteEventChildren(c);a=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var h=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var f=e.getFront();if(".priority"==f){ri(1==e.getLength(),"Can't have a priority with additional path components");var p=o.getNode();s=t.getServerCache().getNode();var d=n.calcEventCacheAfterServerOverwrite(e,p,s);a=null!=d?this.filter_.updatePriority(p,d):o.getNode()}else{var y=e.popFront(),m=void 0;if(o.isCompleteForChild(f)){s=t.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),s);m=null!=g?o.getNode().getImmediateChild(f).updateChild(y,g):o.getNode().getImmediateChild(f)}else m=n.calcCompleteChild(f,t.getServerCache());a=null!=m?this.filter_.updateChild(o.getNode(),f,m,y,r,i):o.getNode()}}return t.updateEventSnap(a,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),l,null)}else{var h=e.getFront();if(!u.isCompleteForPath(e)&&1<e.getLength())return t;var f=e.popFront(),p=u.getNode().getImmediateChild(h).updateChild(f,n);s=".priority"==h?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),h,p,f,ls,null)}var d=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),y=new hs(r,d,i);return this.generateEventCacheAfterServerEvent_(d,e,r,y,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,s,u=t.getEventCache(),c=new hs(r,t,i);if(e.isEmpty())s=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var l=e.getFront();if(".priority"===l)s=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),f=u.getNode().getImmediateChild(l),p=void 0;if(h.isEmpty())p=n;else{var d=c.getCompleteChild(l);p=null!=d?".priority"===h.getBack()&&d.getChild(h.parent()).isEmpty()?d:d.updateChild(h,n):Oa.EMPTY_NODE}if(f.equals(p))a=t;else{var y=this.filter_.updateChild(u.getNode(),l,p,h,c,o);a=t.updateEventSnap(y,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),u},t.prototype.applyMerge_=function(t,e){return e.foreach(function(e,n){t=t.updateChild(e,n)}),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:es.Empty.setTree(e,n);var l=t.getServerCache().getNode();return u.children.inorderTraversal(function(e,n){if(l.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),h=s.applyMerge_(u,n);c=s.applyServerOverwrite_(c,new Bo(e),h,r,i,o,a)}}),u.children.inorderTraversal(function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!l.hasChild(e)&&!u){var h=t.getServerCache().getNode().getImmediateChild(e),f=s.applyMerge_(h,n);c=s.applyServerOverwrite_(c,new Bo(e),f,r,i,o,a)}}),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var u=es.Empty;return s.getNode().forEachChild(ga,function(t,e){u=u.set(new Bo(t),e)}),this.applyServerMerge_(t,e,u,r,i,a,o)}return t}var c=es.Empty;return n.foreach(function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(c=c.set(t,s.getNode().getChild(r)))}),this.applyServerMerge_(t,e,c,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,ls,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var a=new hs(n,t,r),s=t.getEventCache().getNode(),u=void 0;if(e.isEmpty()||".priority"===e.getFront()){var c=void 0;if(t.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var l=t.getServerCache().getNode();ri(l instanceof Oa,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(l)}c=c,u=this.filter_.updateFullNode(s,c,i)}else{var h=e.getFront(),f=n.calcCompleteChild(h,t.getServerCache());null==f&&t.getServerCache().isCompleteForChild(h)&&(f=s.getImmediateChild(h)),(u=null!=f?this.filter_.updateChild(s,h,f,e.popFront(),a,i):t.getEventCache().getNode().hasChild(h)?this.filter_.updateChild(s,h,Oa.EMPTY_NODE,e.popFront(),a,i):s).isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(u=this.filter_.updateFullNode(u,o,i))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(Bo.Empty),t.updateEventSnap(u,o,this.filter_.filtersNodes())},t}(),ds=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach(function(t){t.type===ss.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(ss.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(i,ss.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,ss.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,ss.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,ss.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,ss.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter(function(t){return t.type===e});a.sort(this.compareChanges_.bind(this)),a.forEach(function(e){var n=o.materializeSingleChange_(e,i);r.forEach(function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))})})},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_)),t},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw ii("Should only compare child_ events.");var n=new da(t.childName,t.snapshotNode),r=new da(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),ys=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new us(n.getIndex()),i=n.getNodeFilter();this.processor_=new ps(i);var o=e.getServerCache(),a=e.getEventCache(),s=r.updateFullNode(Oa.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Oa.EMPTY_NODE,a.getNode(),null),c=new os(s,o.isFullyInitialized(),r.filtersNodes()),l=new os(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new as(l,c),this.eventGenerator_=new ds(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){ri(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)})}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===Ua.MERGE&&null!==t.source.queryId&&(ri(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),ri(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),ri(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(_a,function(t,e){n.push(ss.childAddedChange(t,e))}),e.isFullyInitialized()&&n.push(ss.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),ms=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return ri($a,"Reference.ts has not been loaded"),$a},set:function(t){ri(!$a,"__referenceConstructor has already been defined"),$a=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,i,o=t.source.queryId;if(null!==o){var a=this.views.get(o);return ri(null!=a,"SyncTree gave us an op for an invalid query."),a.applyOperation(t,e,n)}var s=[];try{for(var u=Zr(this.views.values()),c=u.next();!c.done;c=u.next())a=c.value,s=s.concat(a.applyOperation(t,e,n))}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return s},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),a=this.views.get(o);if(!a){var s,u=n.calcCompleteEventCache(i?r:null);s=!!u||(u=r instanceof Oa?n.calcCompleteEventChildren(r):Oa.EMPTY_NODE,!1);var c=new as(new os(u,s,!1),new os(r,i,!1));a=new ys(t,c),this.views.set(o,a)}return a.addEventRegistration(e),a.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i,o,a=e.queryIdentifier(),s=[],u=[],c=this.hasCompleteView();if("default"===a)try{for(var l=Zr(this.views.entries()),h=l.next();!h.done;h=l.next()){var f=ti(h.value,2),p=f[0],d=f[1];u=u.concat(d.removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(p),d.getQuery().getQueryParams().loadsAllData()||s.push(d.getQuery()))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}else(d=this.views.get(a))&&(u=u.concat(d.removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(a),d.getQuery().getQueryParams().loadsAllData()||s.push(d.getQuery())));return c&&!this.hasCompleteView()&&s.push(new t.__referenceConstructor(e.repo,e.path)),{removed:s,events:u}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=Zr(this.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var i=Zr(this.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r||a.getCompleteServerCache(t)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=Zr(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),gs=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new es(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=Bo.relativePath(i,e);return o=o.updateChild(a,n),new t(this.writeTree_.set(i,o))}var s=new es(n);return new t(this.writeTree_.setTree(e,s))},t.prototype.addWrites=function(t,e){var n=this;return Io(e,function(e,r){n=n.addWrite(t.child(e),r)}),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,es.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(Bo.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(_a,function(e,n){t.push(new da(e,n))}):this.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new da(e,n.value))}),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new es(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(t){return function t(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(ri(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=t(e.child(n),o,r)}),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r}(Bo.Empty,this.writeTree_,t)},t.Empty=new t(new es(null)),t}(),vs=function(){function t(){this.visibleWrites_=gs.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new bs(t,this)},t.prototype.addOverwrite=function(t,e,n,r){ri(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){ri(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex(function(e){return e.writeId===t});ri(0<=n,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&0<=a;){var s=this.allWrites_[a];s.visible&&(n<=a&&this.recordContainsPath_(s,r.path)?i=!1:r.path.contains(s.path)&&(o=!0)),a--}return!!i&&(o?(this.resetTree_(),!0):(r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):Io(r.children,function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))}),!0))},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(Bo.Empty)){var a=t.layerTree_(this.allWrites_,function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},e);return c=n||Oa.EMPTY_NODE,a.apply(c)}return null}var s=this.visibleWrites_.getCompleteNode(e);if(null!=s)return s;var u=this.visibleWrites_.childCompoundWrite(e);if(u.isEmpty())return n;if(null!=n||u.hasCompleteWrite(Bo.Empty)){var c=n||Oa.EMPTY_NODE;return u.apply(c)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=Oa.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(_a,function(t,e){n=n.updateImmediateChild(t,e)}),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(_a,function(t,e){var r=i.childCompoundWrite(new Bo(t)).apply(e);n=n.updateImmediateChild(t,r)}),i.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){ri(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(t),u=s.getCompleteNode(Bo.Empty);if(null!=u)a=u;else{if(null==e)return[];a=s.apply(e)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),f=h.getNext();f&&c.length<r;)0!==l(f,n)&&c.push(f),f=h.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,Bo.Empty),0<this.allWrites_.length?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=gs.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var a=o.path,s=void 0;if(o.snap)n.contains(a)?(s=Bo.relativePath(n,a),r=r.addWrite(s,o.snap)):a.contains(n)&&(s=Bo.relativePath(a,n),r=r.addWrite(Bo.Empty,o.snap.getChild(s)));else{if(!o.children)throw ii("WriteRecord should have .snap or .children");if(n.contains(a))s=Bo.relativePath(n,a),r=r.addWrites(s,o.children);else if(a.contains(n))if((s=Bo.relativePath(a,n)).isEmpty())r=r.addWrites(Bo.Empty,o.children);else{var u=Ei(o.children,s.getFront());if(u){var c=u.getChild(s.popFront());r=r.addWrite(Bo.Empty,c)}}}}}return r},t}(),bs=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),ws=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=es.Empty,this.pendingWriteTree_=new vs,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new rs(Za.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=es.fromObject(e);return this.applyOperationToSyncPoints_(new is(Za.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=es.Empty;return null!=n.snap?r=r.set(Bo.Empty,!0):Io(n.children,function(t,e){r=r.set(new Bo(t),e)}),this.applyOperationToSyncPoints_(new ts(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new rs(Za.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=es.fromObject(e);return this.applyOperationToSyncPoints_(new is(Za.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new ns(Za.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null==i)return[];var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=Bo.relativePath(a,e),c=new rs(Za.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=Bo.relativePath(a,e),c=es.fromObject(n),l=new is(Za.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,l)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=Bo.relativePath(o,e),u=new ns(Za.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,function(t,e){var n=Bo.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()});var a,s=this.syncPointTree_.get(r);s?(o=o||s.hasCompleteView(),i=i||s.getCompleteServerCache(Bo.Empty)):(s=new ms,this.syncPointTree_=this.syncPointTree_.set(r,s)),null!=i?a=!0:(a=!1,i=Oa.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild(function(t,e){var n=e.getCompleteServerCache(Bo.Empty);n&&(i=i.updateImmediateChild(t,n))}));var u=s.viewExistsForQuery(e);if(!u&&!e.getQueryParams().loadsAllData()){var c=t.makeQueryKey_(e);ri(!this.queryToTagMap.has(c),"View does not exist, but we have a tag");var l=t.getNextQueryTag_();this.queryToTagMap.set(c,l),this.tagToQueryMap.set(l,c)}var h=this.pendingWriteTree_.childWrites(r),f=s.addEventRegistration(e,n,h,i,a);if(!u&&!o){var p=s.viewForQuery(e);f=f.concat(this.setupListener_(e,p))}return f},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var l=-1!==c.findIndex(function(t){return t.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(t,e){return e.hasCompleteView()});if(l&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(f),d=0;d<p.length;++d){var y=p[d],m=y.getQuery(),g=this.createListenerForView_(y);this.listenProvider_.startListening(t.queryForListening_(m),this.tagForQuery_(m),g.hashFn,g.onComplete)}}!h&&0<c.length&&!r&&(l?this.listenProvider_.stopListening(t.queryForListening_(e),null):c.forEach(function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)})),this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,function(e,n){var r=Bo.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),Io(n,function(t,e){r=r.concat(e)}),r})},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,o.hashFn,o.onComplete),s=this.syncPointTree_.subtree(r);if(i)ri(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),Io(n,function(t,e){r=r.concat(e)}),r}),c=0;c<u.length;++c){var l=u[c];this.listenProvider_.stopListening(t.queryForListening_(l),this.tagForQuery_(l))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||Oa.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return ri(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Bo(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);ri(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Bo.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(Bo.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(Bo.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(Bo.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(Bo.Empty));var a=[];return e.children.inorderTraversal(function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))}),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}(),_s=function(){function t(){this.rootNode_=Oa.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Ts=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_.INTERNAL.getToken(t).then(null,function(t){return t&&"auth/token-not-initialized"===t.code?(fo("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})},t.prototype.addTokenChangeListener=function(t){this.app_.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=function(t){this.app_.INTERNAL.removeAuthTokenListener(t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',go(t)},t}(),Es=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),Ti(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return ci(this.counters_)},t}(),Ss=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new Es),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),Cs=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=Xr({},t);return this.last_&&Io(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}(),Is=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Cs(t);var n=1e4+2e4*Math.random();jo(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;Io(e,function(e,i){0<i&&Ti(t.statsToReport_,e)&&(n[e]=i,r=!0)}),r&&this.server_.reportStats(n),jo(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Ns=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new As(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),As=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();co&&fo("event: "+e.toString()),Vo(n)}}},t.prototype.getPath=function(){return this.path_},t}(),ks=function(){function t(t){this.allowedEvents_=t,this.listeners_={},ri(Array.isArray(t)&&0<t.length,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=ei(this.listeners_[t]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){ri(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}(),Ds=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))},!1),r}return Yr(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return ri("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(ks),Rs=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||pi()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return Yr(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return ri("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(ks),xs=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&Vo(function(){n.onMessage_(t[e])})},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),Os=function(){function t(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=po(t),this.stats_=Ss.getCollection(e),this.urlFn=function(t){return e.connectionURL(Ho,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new xs(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new Ps(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=ti(t,5),i=r[0],o=r[1],a=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"==i)n.id=o,n.password=a;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=ti(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)},function(){n.onClosed_()},n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Ko)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.UI)&&!yi()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=wi(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n,r=(n=oi(e),ui.encodeByteArray(n,!0)),i=Co(r,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},t.prototype.incrementIncomingBytes_=function(t){var e=wi(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Ps=function(){function t(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=ao(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(e){fo("frame writing exception"),e.stack&&fo(e.stack),fo(e)}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||fo("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(0<this.pendingSegs.length?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;0<this.pendingSegs.length&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,function(){clearTimeout(i),r()})},t.prototype.addTag=function(t,e){var n=this;setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){fo("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}},Math.floor(1))},t}(),Ms="",Ls=null;"undefined"!=typeof MozWebSocket?Ls=MozWebSocket:"undefined"!=typeof WebSocket&&(Ls=WebSocket);var Fs=function(){function t(e,n,r,i){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=po(this.connId),this.stats_=Ss.getCollection(n),this.connURL=t.connectionURL_(n,r,i)}return t.connectionURL_=function(t,e,n){var r={v:"5"};return"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Ko)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL(Qo,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ro.set("previous_websocket_failure",!0);try{this.mySock=new Ls(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var r=t.message||t.data;return r&&this.log_(r),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&1<n.length&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Ls&&!t.forceDisallow_},t.previouslyFailed=function(){return ro.isInMemoryStorage||!0===ro.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){ro.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=bi(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(ri(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=wi(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=Co(e,16384);1<n.length&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),Us=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Os,Fs]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=Fs&&Fs.isAvailable(),o=i&&!Fs.previouslyFailed();if(e.webSocketOnly&&(i||go("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Fs];else{var a=this.transports_=[];try{for(var s=Zr(t.ALL_TRANSPORTS),u=s.next();!u.done;u=s.next()){var c=u.value;c&&c.isAvailable()&&a.push(c)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(0<this.transports_.length)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return 1<this.transports_.length?this.transports_[1]:null},t}(),qs=function(){function t(t,e,n,r,i,o,a){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=po("c:"+this.id+":"),this.transportManager_=new Us(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,r)},Math.floor(0));var i=e.healthyTimeout||0;0<i&&(this.healthyTimeout_=jo(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&102400<t.conn_.bytesReceived?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&10240<t.conn_.bytesSent?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=Eo("t",t),n=Eo("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=Eo("t",t),n=Eo("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=Eo("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?yo("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):yo("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&go("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),jo(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):jo(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ro.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),Vs=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),js=function(t){function e(n,r,i,o,a,s){var u=t.call(this)||this;if(u.repoInfo_=n,u.onDataUpdate_=r,u.onConnectStatus_=i,u.onServerInfoUpdate_=o,u.authTokenProvider_=a,u.authOverride_=s,u.id=e.nextPersistentConnectionId_++,u.log_=po("p:"+u.id+":"),u.interruptReasons_={},u.listens=new Map,u.outstandingPuts_=[],u.outstandingPutCount_=0,u.onDisconnectRequestQueue_=[],u.connected_=!1,u.reconnectDelay_=1e3,u.maxReconnectDelay_=3e5,u.securityDebugCallback_=null,u.lastSessionId=null,u.establishConnectionTimer_=null,u.visible_=!1,u.requestCBHash_={},u.requestNumber_=0,u.realtime_=null,u.authToken_=null,u.forceTokenRefresh_=!1,u.invalidAuthTokenCount_=0,u.firstConnection_=!0,u.lastConnectionAttemptTime_=null,u.lastConnectionEstablishedTime_=null,s&&!yi())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return u.scheduleConnect_(0),Ds.getInstance().on("visible",u.onVisible_,u),-1===n.host.indexOf("fblocal")&&Rs.getInstance().on("online",u.onOnline_,u),u}return Yr(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(wi(i)),ri(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),ri(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),ri(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&Ti(t,"w")){var n=Ei(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();go("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){var e;(t&&40===t.length||"object"==typeof(e=_i(t).claims)&&!0===e.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t,e=this;if(this.connected_&&this.authToken_){var n=this.authToken_,r=(t=_i(n).claims)&&"object"==typeof t&&t.hasOwnProperty("iat")?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,function(t){var r=t.s,i=t.d||"error";e.authToken_===n&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),ri(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+wi(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):yo("Unrecognized action received from server: "+wi(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;ri(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(3e4<(new Date).getTime()-this.lastConnectionEstablishedTime_&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())};this.realtime_={close:c,sendRequest:function(t){ri(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)}};var l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(l).then(function(e){s?fo("getToken() completed but was canceled"):(fo("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,u=new qs(i,o.repoInfo_,t,n,r,function(t){go(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(t){o.log_("Failed to get token: "+t),s||c()})}},e.prototype.interrupt=function(t){fo("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){fo("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Si(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return So(t)}).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new Bo(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){fo("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,3<=this.invalidAuthTokenCount_&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var i=Zr(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=Zr(a.values()),u=s.next();!u.done;u=s.next()){var c=u.value;this.sendListen_(c)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}},e.prototype.sendConnectStats_=function(){var t={};t["sdk.js."+Ms.replace(/\./g,"-")]=1,pi()?t["framework.cordova"]=1:di()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=Rs.getInstance().currentlyOnline();return Si(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(Vs),Bs=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=po("p:rest:"),i.listens_={},i}return Yr(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(ri(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var s=e.getListenId_(t,r),u={};this.listens_[s]=u;var c=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",c,function(t,e){var n=e;404===t&&(t=n=null),null===t&&o.onDataUpdate_(a,n,!1,r),Ei(o.listens_,s)===u&&i(t?401==t?"permission_denied":"rest_error:"+t:"ok",null)})},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var o=i&&i.accessToken;o&&(e.auth=o);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+function(t){var e,n,r=[],i=function(t,e){Array.isArray(e)?e.forEach(function(e){r.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}):r.push(encodeURIComponent(t)+"="+encodeURIComponent(e))};try{for(var o=Zr(Object.entries(t)),a=o.next();!a.done;a=o.next()){var s=ti(a.value,2);i(s[0],s[1])}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r.length?"&"+r.join("&"):""}(e);r.log_("Sending REST request for "+a);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(n&&4===s.readyState){r.log_("REST Response for "+a+" received. status:",s.status,"response:",s.responseText);var t=null;if(200<=s.status&&s.status<300){try{t=bi(s.responseText)}catch(t){go("Failed to parse JSON response for "+a+": "+s.responseText)}n(null,t)}else 401!==s.status&&404!==s.status&&go("Got unsuccessful REST response for "+a+" Status: "+s.status),n(s.status);n=null}},s.open("GET",a,!0),s.send()})},e}(Vs),Ws="repo_interrupt",Ks=function(){function t(t,e,n){var r=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ns,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new za,this.persistentConnection_=null;var i=new Ts(n);if(this.stats_=Ss.getCollection(t),e||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))this.server_=new Bs(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(null!=o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{wi(o)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new js(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(t){r.server_.refreshAuthToken(t)}),this.statsReporter_=Ss.getOrCreateReporter(t,function(){return new Is(r.stats_,r.server_)}),this.transactions_init_(),this.infoData_=new _s,this.infoSyncTree_=new ws({startListening:function(t,e,n,i){var o=[],a=r.infoData_.getNode(t.path);return a.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new ws({startListening:function(t,e,n,i){return r.server_.listen(t,n,e,function(e,n){var o=i(e,n);r.eventQueue_.raiseEventsForChangedPath(t.path,o)}),[]},stopListening:function(t,e){r.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new Bo(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new Bo(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var a=Ci(e,function(t){return La(t)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var s=La(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,r)}else if(n){var u=Ci(e,function(t){return La(t)});o=this.serverSyncTree_.applyServerMerge(i,u)}else{var c=La(e);o=this.serverSyncTree_.applyServerOverwrite(i,c)}var l=i;0<o.length&&(l=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(l,o)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;Io(t,function(t,n){e.updateInfo_(n,t)})},t.prototype.updateInfo_=function(t,e){var n=new Bo("/.info/"+t),r=La(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),a=La(e,n),s=Xa(a,o),u=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserOverwrite(t,s,u,!0);this.eventQueue_.queueEvents(c),this.server_.put(t.toString(),a.val(!0),function(e,n){var o="ok"===e;o||go("set at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(u,!o);i.eventQueue_.raiseEventsForChangedPath(t,a),i.callOnCompleteCallback(r,e,n)});var l=this.abortTransactions_(t);this.rerunTransactions_(l),this.eventQueue_.raiseEventsForChangedPath(l,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),a={};if(Io(e,function(t,e){i=!1;var n=La(e);a[t]=Xa(n,o)}),i)fo("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,a,s);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,function(e,i){var o="ok"===e;o||go("update at "+t+" failed: "+e);var a=r.serverSyncTree_.ackUserWrite(s,!o),u=0<a.length?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,a),r.callOnCompleteCallback(n,e,i)}),Io(e,function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e,n,r,i=this.generateServerValues(),o=(e=this.onDisconnect_,n=i,r=new za,e.forEachTree(new Bo(""),function(t,e){r.remember(t,Xa(e,n))}),r),a=[];o.forEachTree(Bo.Empty,function(e,n){a=a.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var r=t.abortTransactions_(e);t.rerunTransactions_(r)}),this.onDisconnect_=new za,this.eventQueue_.raiseEventsForChangedPath(Bo.Empty,a)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)})},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=La(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)})},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=La(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)})},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(Si(e))return fo("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,function(i,o){"ok"===i&&Io(e,function(e,n){var i=La(n);r.onDisconnect_.remember(t.child(e),i)}),r.callOnCompleteCallback(n,i,o)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(Ws)},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(Ws)},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;e=t?(this.statsListener_||(this.statsListener_=new Cs(this.stats_)),this.statsListener_.get()):this.stats_.get();var n=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);Io(e,function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)})}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),fo.apply(void 0,ei([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&Vo(function(){if("ok"==e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new nu(this))},enumerable:!0,configurable:!0}),t}(),Qs=function(){function t(e){this.indexedFilter_=new us(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new da(e,n))||(n=Oa.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Oa.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(Oa.EMPTY_NODE);var i=this;return e.forEachChild(_a,function(t,e){i.matches(new da(t,e))||(r=r.updateImmediateChild(t,Oa.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),Hs=function(){function t(t){this.rangedFilter_=new Qs(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new da(e,n))||(n=Oa.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=Oa.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=Oa.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(Oa.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)a=i.getNext(),!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,Oa.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var s=t;ri(s.numChildren()==this.limit_,"");var u=new da(e,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(e)){for(var h=s.getImmediateChild(e),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name==e||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:o(f,u);if(l&&!n.isEmpty()&&0<=p)return null!=i&&i.trackChildChange(ss.childChangedChange(e,n,h)),s.updateImmediateChild(e,n);null!=i&&i.trackChildChange(ss.childRemovedChange(e,h));var d=s.updateImmediateChild(e,Oa.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(ss.childAddedChange(f.name,f.node)),d.updateImmediateChild(f.name,f.node)):d}return n.isEmpty()?t:l&&0<=o(c,u)?(null!=i&&(i.trackChildChange(ss.childRemovedChange(c.name,c.node)),i.trackChildChange(ss.childAddedChange(e,n))),s.updateImmediateChild(e,n).updateImmediateChild(c.name,Oa.EMPTY_NODE)):t},t}(),Gs=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=_a}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return ri(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return ri(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:bo},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return ri(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return ri(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:wo},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return ri(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,n.indexStartName_=null!=e?(n.startNameSet_=!0,e):(n.startNameSet_=!1,""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,n.indexEndName_=void 0!==e?(n.endNameSet_=!0,e):(n.endNameSet_=!1,""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==_a&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==_a},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new us(this.getIndex()):this.hasLimit()?new Hs(this):new Qs(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()||(e=this.index_===_a?n.PRIORITY_INDEX:this.index_===Va?n.VALUE_INDEX:this.index_===ga?n.KEY_INDEX:(ri(this.index_ instanceof ja,"Unrecognized index type!"),this.index_.toString()),r[n.ORDER_BY]=wi(e),this.startSet_&&(r[n.START_AT]=wi(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+wi(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=wi(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+wi(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_)),r},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),zs=function(t){function e(e,n){if(!(e instanceof Ks))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,Gs.DEFAULT,!1)||this}return Yr(e,t),e.prototype.getKey=function(){return Di("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){var n,r;return Di("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof Bo||(null===this.path.getFront()?("Reference.child",r=!1,(n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ua("Reference.child",1,n,r)):ua("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){Di("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){Di("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){Di("Reference.set",1,2,arguments.length),ca("Reference.set",this.path),na("Reference.set",1,t,this.path,!1),xi("Reference.set",2,e,!0);var n=new hi;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(Di("Reference.update",1,2,arguments.length),ca("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,go("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ia("Reference.update",1,t,this.path,!1),xi("Reference.update",2,e,!0);var i=new hi;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(Di("Reference.setWithPriority",2,3,arguments.length),ca("Reference.setWithPriority",this.path),na("Reference.setWithPriority",1,t,this.path,!1),oa("Reference.setWithPriority",2,e,!1),xi("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new hi;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return Di("Reference.remove",0,1,arguments.length),ca("Reference.remove",this.path),xi("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(Di("Reference.transaction",1,3,arguments.length),ca("Reference.transaction",this.path),xi("Reference.transaction",1,t,!1),xi("Reference.transaction",2,e,!0),function(t,e,n,r){if(void 0!==n&&"boolean"!=typeof n)throw new Error(Ri("Reference.transaction",3,!0)+"must be a boolean.")}(0,0,n),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new hi;return"function"==typeof e&&r.promise.catch(function(){}),this.repo.startTransaction(this.path,t,function(t,n,i){t?r.reject(t):r.resolve(new fa(n,i)),"function"==typeof e&&e(t,n,i)},n),r.promise},e.prototype.setPriority=function(t,e){Di("Reference.setPriority",1,2,arguments.length),ca("Reference.setPriority",this.path),oa("Reference.setPriority",1,t,!1),xi("Reference.setPriority",2,e,!0);var n=new hi;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){Di("Reference.push",0,2,arguments.length),ca("Reference.push",this.path),na("Reference.push",1,t,this.path,!0),xi("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=pa(r),o=this.child(i),a=this.child(i);return n=null!=t?o.set(t,e).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),o},e.prototype.onDisconnect=function(){return ca("Reference.onDisconnect",this.path),new ha(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(Ga);Ga.__referenceConstructor=zs,ms.__referenceConstructor=zs;var Ys,Xs,Js=function(){this.children={},this.childCount=0,this.value=null},$s=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new Js),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n,r=e instanceof Bo?e:new Bo(e),i=this;null!==(n=r.getFront());)i=new t(n,i,Ei(i.node_.children,n)||new Js),r=r.popFront();return i},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){ri(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return 0<this.node_.childCount},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;Io(this.node_.children,function(r,i){e(new t(r,n,i))})},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},t.prototype.path=function(){return new Bo(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=Ti(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();(Xs=Ys||(Ys={}))[Xs.RUN=0]="RUN",Xs[Xs.SENT=1]="SENT",Xs[Xs.COMPLETED=2]="COMPLETED",Xs[Xs.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",Xs[Xs.NEEDS_ABORT=4]="NEEDS_ABORT",Ks.MAX_TRANSACTION_RETRIES_=25,Ks.prototype.transactions_init_=function(){this.transactionQueueTree_=new $s},Ks.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},o=new zs(this,t);o.on("value",i);var a={path:t,update:e,onComplete:n,status:null,order:ao(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(t);a.currentInputSnapshot=s;var u=a.update(s.val());if(void 0===u){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var c=new Ba(a.currentInputSnapshot,new zs(this,a.path),_a);a.onComplete(null,!1,c)}}else{ra("transaction failed: Data returned ",u,a.path),a.status=Ys.RUN;var l=this.transactionQueueTree_.subTree(t),h=l.getValue()||[];h.push(a),l.setValue(h);var f=void 0;"object"==typeof u&&null!==u&&Ti(u,".priority")?(f=Ei(u,".priority"),ri(ea(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(this.serverSyncTree_.calcCompleteEventCache(t)||Oa.EMPTY_NODE).getPriority().val(),f=f;var p=this.generateServerValues(),d=La(u,f),y=Xa(d,p);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=y,a.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(t,y,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,m),this.sendReadyTransactions_()}},Ks.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||Oa.EMPTY_NODE},Ks.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);ri(0<n.length,"Sending zero length transaction queue"),n.every(function(t){return t.status===Ys.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},Ks.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map(function(t){return t.currentWriteId}),i=this.getLatestState_(t,r),o=i,a=i.hash(),s=0;s<e.length;s++){var u=e[s];ri(u.status===Ys.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=Ys.SENT,u.retryCount++;var c=Bo.relativePath(t,u.path);o=o.updateChild(c,u.currentOutputSnapshotRaw)}var l=o.val(!0),h=t;this.server_.put(h.toString(),l,function(r){n.log_("transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<e.length;a++){if(e[a].status=Ys.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[a].currentWriteId)),e[a].onComplete){var s=e[a].currentOutputSnapshotResolved,u=new zs(n,e[a].path),c=new Ba(s,u,_a);o.push(e[a].onComplete.bind(null,null,!0,c))}e[a].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i),a=0;a<o.length;a++)Vo(o[a])}else{if("datastale"===r)for(a=0;a<e.length;a++)e[a].status===Ys.SENT_NEEDS_ABORT?e[a].status=Ys.NEEDS_ABORT:e[a].status=Ys.RUN;else for(go("transaction at "+h.toString()+" failed: "+r),a=0;a<e.length;a++)e[a].status=Ys.NEEDS_ABORT,e[a].abortReason=r;n.rerunTransactions_(t)}},a)},Ks.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},Ks.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,r=[],i=[],o=t.filter(function(t){return t.status===Ys.RUN}).map(function(t){return t.currentWriteId}),a=0;a<t.length;a++){var s=t[a],u=Bo.relativePath(e,s.path),c=!1,l=void 0;if(ri(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===Ys.NEEDS_ABORT)c=!0,l=s.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===Ys.RUN)if(s.retryCount>=Ks.MAX_TRANSACTION_RETRIES_)c=!0,l="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var h=this.getLatestState_(s.path,o);s.currentInputSnapshot=h;var f=t[a].update(h.val());if(void 0!==f){ra("transaction failed: Data returned ",f,s.path);var p=La(f);"object"==typeof f&&null!=f&&Ti(f,".priority")||(p=p.updatePriority(h.getPriority()));var d=s.currentWriteId,y=this.generateServerValues(),m=Xa(p,y);s.currentOutputSnapshotRaw=p,s.currentOutputSnapshotResolved=m,s.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(d),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(s.path,m,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(d,!0))}else c=!0,l="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,i),i=[],c&&(t[a].status=Ys.COMPLETED,n=t[a].unwatcher,setTimeout(n,Math.floor(0)),t[a].onComplete))if("nodata"===l){var g=new zs(this,t[a].path),v=t[a].currentInputSnapshot,b=new Ba(v,g,_a);r.push(t[a].onComplete.bind(null,null,!1,b))}else r.push(t[a].onComplete.bind(null,new Error(l),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),a=0;a<r.length;a++)Vo(r[a]);this.sendReadyTransactions_()}},Ks.prototype.getAncestorTransactionNode_=function(t){for(var e,n=this.transactionQueueTree_;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},Ks.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},Ks.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},Ks.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==Ys.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(0<n.length?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},Ks.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},Ks.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)e[o].status===Ys.SENT_NEEDS_ABORT||(e[o].status===Ys.SENT?(ri(i===o-1,"All SENT items should be at beginning of queue."),e[i=o].status=Ys.SENT_NEEDS_ABORT,e[o].abortReason="set"):(ri(e[o].status===Ys.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete&&n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r),o=0;o<n.length;o++)Vo(n[o])}};var Zs,tu="databaseURL",eu=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return Zs||(Zs=new t),Zs},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options[tu];void 0===n&&mo("Can't determine Firebase Database URL.  Be sure to include "+tu+" option when calling firebase.initializeApp().");var r=zo(n),i=r.repoInfo;return la("Invalid Firebase Database URL",1,r),r.path.isEmpty()||mo("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,t).database},t.prototype.deleteRepo=function(t){var e=Ei(this.repos_,t.app.name);e&&Ei(e,t.repoInfo_.toURLString())===t||mo("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=Ei(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var r=Ei(n,t.toURLString());return r&&mo("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Ks(t,this.useRestClient_,e),n[t.toURLString()]=r},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),nu=function(){function t(t){(this.repo_=t)instanceof Ks||mo("Don't call new Database() directly - please use firebase.database()."),this.root_=new zs(t,Bo.Empty),this.INTERNAL=new ru(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),Di("database.ref",0,1,arguments.length),t instanceof zs?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),Di(e,1,1,arguments.length);var n=zo(t);la(e,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&mo(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&mo("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){Di("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){Di("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}(),ru=function(){function t(t){this.database=t}return t.prototype.delete=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){return this.database.checkDeleted_("delete"),eu.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},t}(),iu=Object.freeze({forceLongPolling:function(){Fs.forceDisallow(),Os.forceAllow()},forceWebSockets:function(){Os.forceDisallow()},isWebSocketsAvailable:function(){return Fs.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)}}),ou=js;js.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},js.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var au,su,uu=qs,cu=Go,lu=Object.freeze({DataConnection:ou,RealTimeConnection:uu,hijackHash:function(t){var e=js.prototype.put;return js.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){js.prototype.put=e}},ConnectionTarget:cu,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){eu.getInstance().forceRestClient(t)}}),hu=nu.ServerValue;su=(au=$i).SDK_VERSION,Ms=su,au.INTERNAL.registerService("database",function(t,e,n){return eu.getInstance().databaseFromApp(t,n)},{Reference:zs,Query:Ga,Database:nu,DataSnapshot:Ba,enableLogging:ho,INTERNAL:iu,ServerValue:hu,TEST_ACCESS:lu},null,!0);var fu,pu="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},du=du||{},yu=pu;function mu(t){return"string"==typeof t}function gu(t){return"number"==typeof t}function vu(t,e){t=t.split("."),e=e||yu;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function bu(){}function wu(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function _u(t){return"array"==wu(t)}function Tu(t){var e=wu(t);return"array"==e||"object"==e&&"number"==typeof t.length}function Eu(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Su="closure_uid_"+(1e9*Math.random()>>>0),Cu=0;function Iu(t,e,n){return t.call.apply(t.bind,arguments)}function Nu(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Au(t,e,n){return(Au=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Iu:Nu).apply(null,arguments)}function ku(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var Du=Date.now||function(){return+new Date};function Ru(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,(t.prototype.constructor=t).yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function xu(){this.j=this.j,this.i=this.i}xu.prototype.j=!1,xu.prototype.la=function(){!this.j&&(this.j=!0,this.G(),0)&&(this[Su]||(this[Su]=++Cu))},xu.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var Ou=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(mu(t))return mu(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Pu=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=mu(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Mu(t){return Array.prototype.concat.apply([],arguments)}function Lu(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Fu(t){return/^[\s\xa0]*$/.test(t)}var Uu,qu=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Vu(t,e){return-1!=t.indexOf(e)}function ju(t,e){return t<e?-1:e<t?1:0}t:{var Bu=yu.navigator;if(Bu){var Wu=Bu.userAgent;if(Wu){Uu=Wu;break t}}Uu=""}function Ku(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Qu(t){var e,n={};for(e in t)n[e]=t[e];return n}var Hu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Gu(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Hu.length;o++)n=Hu[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function zu(t){return zu[" "](t),t}zu[" "]=bu;var Yu,Xu,Ju=Vu(Uu,"Opera"),$u=Vu(Uu,"Trident")||Vu(Uu,"MSIE"),Zu=Vu(Uu,"Edge"),tc=Zu||$u,ec=Vu(Uu,"Gecko")&&!(Vu(Uu.toLowerCase(),"webkit")&&!Vu(Uu,"Edge"))&&!(Vu(Uu,"Trident")||Vu(Uu,"MSIE"))&&!Vu(Uu,"Edge"),nc=Vu(Uu.toLowerCase(),"webkit")&&!Vu(Uu,"Edge");function rc(){var t=yu.document;return t?t.documentMode:void 0}t:{var ic="",oc=(Xu=Uu,ec?/rv:([^\);]+)(\)|;)/.exec(Xu):Zu?/Edge\/([\d\.]+)/.exec(Xu):$u?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Xu):nc?/WebKit\/(\S+)/.exec(Xu):Ju?/(?:Version)[ \/]?(\S+)/.exec(Xu):void 0);if(oc&&(ic=oc?oc[1]:""),$u){var ac=rc();if(null!=ac&&ac>parseFloat(ic)){Yu=String(ac);break t}}Yu=ic}var sc,uc={};function cc(t){return e=t,n=function(){for(var e=0,n=qu(String(Yu)).split("."),r=qu(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ju(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ju(0==a[2].length,0==s[2].length)||ju(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e},r=uc,Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=n();var e,n,r}var lc=yu.document;sc=lc&&$u?rc()||("CSS1Compat"==lc.compatMode?parseInt(Yu,10):5):void 0;var hc=!$u||9<=Number(sc),fc=$u&&!cc("9"),pc=function(){if(!yu.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{yu.addEventListener("test",bu,e),yu.removeEventListener("test",bu,e)}catch(t){}return t}();function dc(t,e){this.type=t,this.a=this.target=e,this.Ja=!0}function yc(t,e){if(dc.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ec){t:{try{zu(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,this.screenY=r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=mu(t.pointerType)?t.pointerType:mc[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dc.prototype.b=function(){this.Ja=!1},Ru(yc,dc);var mc={2:"touch",3:"pen",4:"mouse"};yc.prototype.b=function(){yc.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,fc)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gc="closure_listenable_"+(1e6*Math.random()|0),vc=0;function bc(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++vc,this.X=this.Z=!1}function wc(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function _c(t){this.src=t,this.a={},this.b=0}function Tc(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=Ou(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(wc(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Ec(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}_c.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=Ec(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new bc(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Sc="closure_lm_"+(1e6*Math.random()|0),Cc={};function Ic(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(_u(n)){for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);return null}return r=Pc(r),e&&e[gc]?e.Ba(n,r,Eu(i)?!!i.capture:!!i,o):Nc(e,n,r,!0,i,o)}(t,e,n,r,i);if(_u(e)){for(var o=0;o<e.length;o++)Ic(t,e[o],n,r,i);return null}return n=Pc(n),t&&t[gc]?t.Aa(e,n,Eu(r)?!!r.capture:!!r,i):Nc(t,e,n,!1,r,i)}function Nc(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=Eu(i)?!!i.capture:!!i;if(a&&!hc)return null;var s,u,c=xc(t);if(c||(t[Sc]=c=new _c(t)),(n=c.add(e,n,r,a,o)).proxy)return n;if(s=Rc,r=u=hc?function(t){return s.call(u.src,u.listener,t)}:function(t){if(!(t=s.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)pc||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kc(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ac(t){if(!gu(t)&&t&&!t.X){var e=t.src;if(e&&e[gc])Tc(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kc(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xc(e))?(Tc(n,t),0==n.b&&(n.src=null,e[Sc]=null)):wc(t)}}}function kc(t){return t in Cc?Cc[t]:Cc[t]="on"+t}function Dc(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&Ac(t),n.call(r,e)}function Rc(t,e){return!!t.X||Dc(t,hc?new yc(e,this):e=new yc(e||vu("window.event"),this))}function xc(t){return(t=t[Sc])instanceof _c?t:null}var Oc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pc(t){return"function"==wu(t)?t:(t[Oc]||(t[Oc]=function(e){return t.handleEvent(e)}),t[Oc])}function Mc(){xu.call(this),this.c=new _c(this),(this.J=this).B=null}function Lc(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.X&&a.capture==n){var s=a.listener,u=a.da||a.src;a.Z&&Tc(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ja}Ru(Mc,xu),Mc.prototype[gc]=!0,(fu=Mc.prototype).addEventListener=function(t,e,n,r){Ic(this,t,e,n,r)},fu.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(_u(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=Eu(i)?!!i.capture:!!i,r=Pc(r),e&&e[gc]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ec(a=e.a[n],r,i,o))&&(wc(a[r]),Array.prototype.splice.call(a,r,1),0==a.length&&(delete e.a[n],e.b--))):e&&(e=xc(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ec(n,r,i,o)),(r=-1<e?n[e]:null)&&Ac(r))}(this,t,e,n,r)},fu.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(mu(t))t=new dc(t,n);else if(t instanceof dc)t.target=t.target||n;else{var i=t;Gu(t=new dc(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Lc(a,r,!0,t)&&i}if(i=Lc(a=t.a=n,r,!0,t)&&i,i=Lc(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Lc(a=t.a=e[o],r,!1,t)&&i;return i},fu.G=function(){if(Mc.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)wc(n[r]);delete e.a[t],e.b--}}this.B=null},fu.Aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},fu.Ba=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Fc=yu.JSON.stringify;function Uc(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function qc(){this.b=this.a=null}Uc.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Vc,jc=new Uc(function(){return new Bc},function(t){t.reset()});function Bc(){this.next=this.b=this.a=null}function Wc(t){yu.setTimeout(function(){throw t},0)}function Kc(t,e){var n;Vc||(n=yu.Promise.resolve(void 0),Vc=function(){n.then(Gc)}),Qc||(Vc(),Qc=!0),Hc.add(t,e)}qc.prototype.add=function(t,e){var n=jc.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Bc.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qc=!(Bc.prototype.reset=function(){this.next=this.b=this.a=null}),Hc=new qc;function Gc(){for(var t;r=n=void 0,r=null,(n=Hc).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){Wc(t)}var e=jc;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,r;Qc=!1}function zc(t,e){Mc.call(this),this.b=t||1,this.a=e||yu,this.f=Au(this.gb,this),this.g=Du()}function Yc(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Xc(t,e,n){if("function"==wu(t))n&&(t=Au(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Au(t.handleEvent,t)}return 2147483647<Number(e)?-1:yu.setTimeout(t,e||0)}function Jc(t,e,n){xu.call(this),this.f=null!=n?Au(t,n):t,this.c=e,this.b=Au(this.ab,this),this.a=[]}function $c(t){t.U=Xc(t.b,t.c),t.f.apply(null,t.a)}function Zc(t){xu.call(this),this.b=t,this.a={}}Ru(zc,Mc),(fu=zc.prototype).ba=!1,fu.L=null,fu.gb=function(){if(this.ba){var t=Du()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Yc(this),this.start()))}},fu.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=Du())},fu.G=function(){zc.N.G.call(this),Yc(this),delete this.a},Ru(Jc,xu),(fu=Jc.prototype).ea=!1,fu.U=null,fu.Ua=function(t){this.a=arguments,this.U?this.ea=!0:$c(this)},fu.G=function(){Jc.N.G.call(this),this.U&&(yu.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},fu.ab=function(){this.U=null,this.ea&&(this.ea=!1,$c(this))},Ru(Zc,xu);var tl=[];function el(t,e,n,r){_u(n)||(n&&(tl[0]=n.toString()),n=tl);for(var i=0;i<n.length;i++){var o=Ic(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function nl(t){Ku(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ac(t)},t),t.a={}}function rl(){}Zc.prototype.G=function(){Zc.N.G.call(this),nl(this)},Zc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var il=new Mc;function ol(t){dc.call(this,"serverreachability",t)}function al(t){il.dispatchEvent(new ol(il,t))}function sl(t){dc.call(this,"statevent",t)}function ul(t){il.dispatchEvent(new sl(il,t))}function cl(t){dc.call(this,"timingevent",t)}function ll(t,e){if("function"!=wu(t))throw Error("Fn must not be null and must be a function");return yu.setTimeout(function(){t()},e)}Ru(ol,dc),Ru(sl,dc),Ru(cl,dc);var hl={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,Ma:7,TIMEOUT:8,sb:9},fl={jb:"complete",wb:"success",Na:"error",Ma:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function pl(){}function dl(t){var e;return(e=t.a)||(e=t.a={}),e}function yl(){}pl.prototype.a=null;var ml,gl={OPEN:"a",ib:"b",Na:"c",rb:"d"};function vl(){dc.call(this,"d")}function bl(){dc.call(this,"c")}function wl(){}function _l(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Zc(this),this.O=Tl,t=tc?125:void 0,this.P=new zc(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}Ru(vl,dc),Ru(bl,dc),Ru(wl,pl),ml=new wl;var Tl=45e3,El={},Sl={};function Cl(t,e,n){t.F=1,t.f=Xl(Wl(e)),t.l=n,t.H=!0,Nl(t,null)}function Il(t,e,n,r){t.F=1,t.f=Xl(Wl(e)),t.l=null,t.H=n,Nl(t,r)}function Nl(t,e){t.v=Du(),Dl(t),t.D=Wl(t.f),Yl(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new Jc(Au(t.Ka,t,t.a),t.J)),el(t.I,t.a,"readystatechange",t.eb),e=t.h?Qu(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),al(1)}function Al(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=kl(t,n);if(i==Sl){4==e&&(t.c=4,ul(14),r=!1);break}if(i==El){t.c=4,ul(15),r=!1;break}Ml(t,i)}4==e&&0==n.length&&(t.c=1,ul(16),r=!1),t.b=t.b&&r,r||(Pl(t),Ol(t))}function kl(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?Sl:(n=Number(e.substring(n,r)),isNaN(n)?El:(r+=1)+n>e.length?Sl:(e=e.substr(r,n),t.A=r+n,e))}function Dl(t){t.R=Du()+t.O,Rl(t,t.O)}function Rl(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=ll(Au(t.bb,t),e)}function xl(t){t.i&&(yu.clearTimeout(t.i),t.i=null)}function Ol(t){t.g.Da()||t.m||t.g.na(t)}function Pl(t){xl(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,Yc(t.P),nl(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ml(t,e){try{t.g.Ga(t,e),al(4)}catch(t){}}function Ll(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Tu(t)||mu(t))Pu(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(Tu(t)||mu(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(mu(t))return t.split("");if(Tu(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Fl(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Fl)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ul(t,e){Vl(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ql(t))}function ql(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Vl(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Vl(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Vl(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(fu=_l.prototype).setTimeout=function(t){this.O=t},fu.eb=function(t){t=t.target;var e=this.B;e&&3==Bh(t)?e.Ua():this.Ka(t)},fu.Ka=function(t){try{if(t==this.a)t:{var e=Bh(this.a),n=this.a.ya(),r=this.a.T();if(!(e<3||3==e&&!tc&&!this.a.aa())){this.m||4!=e||7==n||al(8==n||r<=0?3:2),xl(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var a=Wh(this.a,"X-HTTP-Initial-Response");if(a&&!Fu(a)){var s=a;break e}}s=null}if(!s){this.b=!1,this.c=3,ul(12),Pl(this),Ol(this);break t}this.s=!0,Ml(this,s)}this.H?(Al(this,e,o),tc&&this.b&&3==e&&(el(this.I,this.P,"tick",this.cb),this.P.start())):Ml(this,o),4==e&&Pl(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Dl(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,ul(12)):(this.c=0,ul(13)),Pl(this),Ol(this)}}}catch(t){}},fu.cb=function(){if(this.a){var t=Bh(this.a),e=this.a.aa();this.A<e.length&&(xl(this),Al(this,t,e),this.b&&4!=t&&Dl(this))}},fu.cancel=function(){this.m=!0,Pl(this)},fu.bb=function(){this.i=null;var t=Du();0<=t-this.R?(2!=this.F&&(al(3),ul(17)),Pl(this),this.c=2,Ol(this)):Rl(this,this.R-t)},(fu=Fl.prototype).C=function(){ql(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},fu.K=function(){return ql(this),this.a.concat()},fu.get=function(t,e){return Vl(this.b,t)?this.b[t]:e},fu.set=function(t,e){Vl(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},fu.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var jl=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Bl(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Bl?(this.h=void 0!==e?e:t.h,Kl(this,t.f),this.j=t.j,Ql(this,t.b),Hl(this,t.i),this.a=t.a,Gl(this,lh(t.c)),this.g=t.g):t&&(n=String(t).match(jl))?(this.h=!!e,Kl(this,n[1]||"",!0),this.j=Jl(n[2]||""),Ql(this,n[3]||"",!0),Hl(this,n[4]),this.a=Jl(n[5]||"",!0),Gl(this,n[6]||"",!0),this.g=Jl(n[7]||"")):(this.h=!!e,this.c=new oh(null,this.h))}function Wl(t){return new Bl(t)}function Kl(t,e,n){t.f=n?Jl(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ql(t,e,n){t.b=n?Jl(e,!0):e}function Hl(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Gl(t,e,n){var r,i;e instanceof oh?(t.c=e,r=t.c,(i=t.h)&&!r.f&&(ah(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(sh(this,e),ch(this,n,t))},r)),r.f=i):(n||(e=$l(e,rh)),t.c=new oh(e,t.h))}function zl(t,e,n){t.c.set(e,n)}function Yl(t,e,n){_u(n)||(n=[String(n)]),ch(t.c,e,n)}function Xl(t){return zl(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Du()).toString(36)),t}function Jl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function $l(t,e,n){return mu(t)?(t=encodeURI(t).replace(e,Zl),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Zl(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Bl.prototype.toString=function(){var t=[],e=this.f;e&&t.push($l(e,th,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push($l(e,th,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push($l(n,"/"==n.charAt(0)?nh:eh,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",$l(n,ih)),t.join("")},Bl.prototype.resolve=function(t){var e=Wl(this),n=!!t.f;n?Kl(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?Ql(e,t.b):n=null!=t.i;var r=t.a;if(n)Hl(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(Vu(i,"./")||Vu(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?Gl(e,lh(t.c)):n=!!t.g,n&&(e.g=t.g),e};var th=/[#\/\?@]/g,eh=/[#\?:]/g,nh=/[#\?]/g,rh=/[#\?@]/g,ih=/#/g;function oh(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ah(t){t.a||(t.a=new Fl,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function sh(t,e){ah(t),e=hh(t,e),Vl(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ul(t.a,e))}function uh(t,e){return ah(t),e=hh(t,e),Vl(t.a.b,e)}function ch(t,e,n){sh(t,e),0<n.length&&(t.c=null,t.a.set(hh(t,e),Lu(n)),t.b+=n.length)}function lh(t){var e=new oh;return e.c=t.c,t.a&&(e.a=new Fl(t.a),e.b=t.b),e}function hh(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function fh(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function ph(t){var e=t.a.F.a;if(null!=e)ul(4),e?(ul(10),ef(t.a,t,!1)):(ul(11),ef(t.a,t,!0));else{t.b=new _l(t,void 0,void 0),t.b.h=t.h,e=sf(e=t.a,e.Y()?t.f:null,t.i),ul(4),Yl(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&zl(e,n,r),Il(t.b,e,!1,t.f)}}function dh(){this.a=this.b=null}function yh(){this.a=new Fl}function mh(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[Su]||(t[Su]=++Cu)):e.charAt(0)+t}function gh(t,e){this.b=t,this.a=e}function vh(t){this.g=t||bh,t=yu.PerformanceNavigationTiming?0<(t=yu.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(yu.ka&&yu.ka.Ea&&yu.ka.Ea()&&yu.ka.Ea().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new yh),this.b=null,this.c=[]}(fu=oh.prototype).add=function(t,e){ah(this),this.c=null,t=hh(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},fu.forEach=function(t,e){ah(this),this.a.forEach(function(n,r){Pu(n,function(n){t.call(e,n,r,this)},this)},this)},fu.K=function(){ah(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},fu.C=function(t){ah(this);var e=[];if(mu(t))uh(this,t)&&(e=Mu(e,this.a.get(hh(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=Mu(e,t[n])}return e},fu.set=function(t,e){return ah(this),this.c=null,uh(this,t=hh(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},fu.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},fu.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},Ru(function(){},function(){}),(fu=fh.prototype).M=null,fu.$=function(t){return this.a.$(t)},fu.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},fu.Da=function(){return!1},fu.Ga=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Wh(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=Wh(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void of(e,2)}this.f=r[0]}else(e=this.a).m=this.c,of(e,2)}else 1==this.M&&(this.g?ul(6):"11111"==e?(ul(5),this.g=!0,(!$u||10<=Number(sc))&&(this.c=200,this.b.cancel(),ul(11),ef(this.a,this,!0))):(ul(7),this.g=!1))},fu.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,ph(this)):1==this.M&&(this.g?(ul(11),ef(this.a,this,!0)):(ul(10),ef(this.a,this,!1)));else{0==this.M?ul(8):1==this.M&&ul(9);var t=this.a;t.m=this.c,of(t,2)}},fu.Y=function(){return this.a.Y()},fu.ma=function(){return this.a.ma()},yh.prototype.add=function(t){this.a.set(mh(t),t)},yh.prototype.C=function(){return this.a.C()};var bh=10;function wh(t,e){!t.a&&(Vu(e,"spdy")||Vu(e,"quic")||Vu(e,"h2"))&&(t.f=t.g,t.a=new yh,t.b&&(Sh(t,t.b),t.b=null))}function _h(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function Th(t){return t.b?1:t.a?t.a.a.c:0}function Eh(t,e){return t.b?t.b==e:!!t.a&&(e=mh(e),Vl(t.a.a.b,e))}function Sh(t,e){t.a?t.a.add(e):t.b=e}function Ch(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=mh(e),n=Vl(t.a.a.b,n)),n&&Ul(t.a.a,mh(e)))}function Ih(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return Lu(t.c);var e=t.c;return Pu(t.a.C(),function(t){e=e.concat(t.j)}),e}function Nh(){}function Ah(){this.a=new Nh}function kh(t,e,n){var r=n||"";try{Ll(t,function(t,n){var i=t;Eu(t)&&(i=Fc(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Dh(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}vh.prototype.cancel=function(){var t;this.c=Ih(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(Pu(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},Nh.prototype.stringify=function(t){return yu.JSON.stringify(t,void 0)},Nh.prototype.parse=function(t){return yu.JSON.parse(t,void 0)};var Rh=yu.JSON.parse;function xh(t){Mc.call(this),this.headers=new Fl,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Oh,this.D=this.F=!1}Ru(xh,Mc);var Oh="",Ph=/^https?$/i,Mh=["POST","PUT"];function Lh(t){return"content-type"==t.toLowerCase()}function Fh(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Uh(t),Vh(t)}function Uh(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qh(t){if(t.b&&void 0!==du&&(!t.s[1]||4!=Bh(t)||2!=t.T()))if(t.l&&4==Bh(t))Xc(t.Fa,0,t);else if(t.dispatchEvent("readystatechange"),4==Bh(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.A).match(jl)[1]||null;if(!o&&yu.self&&yu.self.location){var a=yu.self.location.protocol;o=a.substr(0,a.length-1)}i=!Ph.test(o?o.toLowerCase():"")}e=i}e?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.h=6,t.f=t.za()+" ["+t.T()+"]",Uh(t))}finally{Vh(t)}}}function Vh(t,e){if(t.a){jh(t);var n=t.a,r=t.s[0]?bu:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function jh(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(yu.clearTimeout(t.m),t.m=null)}function Bh(t){return t.a?t.a.readyState:0}function Wh(t,e){return t.a?t.a.getResponseHeader(e):null}function Kh(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;var i;if(i="",Ku(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,mu(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(r=t.indexOf("?"))<0||n<r){r=n;var o=""}else o=t.substring(r+1,n);n=(t=[t.substr(0,r),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return zl(t,e,n),t}function Qh(t){this.f=[],this.F=new dh,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Ra=this.P=0,this.Pa=!!vu("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Oa=vu("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Sa=vu("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Qa=vu("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=vu("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.La=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new vh(t&&t.concurrentRequestLimit),this.ja=new Ah,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function Hh(t){if(Gh(t),3==t.u){var e=t.P++,n=Wl(t.B);zl(n,"SID",t.H),zl(n,"RID",e),zl(n,"TYPE","terminate"),Jh(t,n),(e=new _l(t,e,void 0)).F=2,e.f=Xl(Wl(n)),n=!1,yu.navigator&&yu.navigator.sendBeacon&&(n=yu.navigator.sendBeacon(e.f.toString(),"")),!n&&yu.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=Du(),Dl(e)}af(t)}function Gh(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(yu.clearTimeout(t.l),t.l=null),nf(t),t.b.cancel(),t.h&&(gu(t.h)&&yu.clearTimeout(t.h),t.h=null)}function zh(t,e){t.f.push(new gh(t.Ra++,e)),3==t.u&&Yh(t)}function Yh(t){_h(t.b)||t.h||(t.h=!0,Kc(t.Ia,t),t.A=0)}function Xh(t,e){var n;n=e?e.W:t.P++;var r=Wl(t.B);zl(r,"SID",t.H),zl(r,"RID",n),zl(r,"AID",t.O),Jh(t,r),t.g&&t.i&&Kh(r,t.g,t.i),n=new _l(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=$h(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Sh(t.b,n),Cl(n,r,e)}function Jh(t,e){t.c&&Ll({},function(t,n){zl(e,n,t)})}function $h(t,e,n){n=Math.min(t.f.length,n);var r=t.c?Au(t.c.Ta,t.c,t):null;t:for(var i=t.f,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),s=!1;else try{kh(l,a,"req"+c+"_")}catch(t){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function Zh(t){t.a||t.l||(t.S=1,Kc(t.Ha,t),t.v=0)}function tf(t){return!(t.a||t.l||3<=t.v||(t.S++,t.l=ll(Au(t.Ha,t),rf(t,t.v)),t.v++,0))}function ef(t,e,n){var r=e.l;r&&wh(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=sf(t,null,t.ha),Yh(t)}function nf(t){null!=t.s&&(yu.clearTimeout(t.s),t.s=null)}function rf(t,e){var n=t.Oa+Math.floor(Math.random()*t.Sa);return t.ma()||(n*=2),n*e}function of(t,e){if(2==e){var n=null;t.c&&(n=null);var r=Au(t.fb,t);n||(n=new Bl("//www.google.com/images/cleardot.gif"),yu.location&&"http"==yu.location.protocol||Kl(n,"https"),Xl(n)),function(t,e){var n=new rl;if(yu.Image){var r=new Image;r.onload=ku(Dh,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ku(Dh,n,r,"TestLoadImage: error",!1,e),r.onabort=ku(Dh,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ku(Dh,n,r,"TestLoadImage: timeout",!1,e),yu.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else ul(2);t.u=0,t.c&&t.c.ta(e),af(t),Gh(t)}function af(t){t.u=0,t.m=-1,t.c&&(0==Ih(t.b).length&&0==t.f.length||(t.b.c.length=0,Lu(t.f),t.f.length=0),t.c.sa())}function sf(t,e,n){var r,i,o,a,s,u,c=(r=n)instanceof Bl?Wl(r):new Bl(r,void 0);if(""!=c.b)e&&Ql(c,e+"."+c.b),Hl(c,c.i);else{var l,h=yu.location;l=e?e+"."+h.hostname:h.hostname,i=h.protocol,o=l,a=+h.port,s=n,u=new Bl(null,void 0),i&&Kl(u,i),o&&Ql(u,o),a&&Hl(u,a),s&&(u.a=s),c=u}return t.V&&Ku(t.V,function(t,e){zl(c,e,t)}),e=t.j,n=t.I,e&&n&&zl(c,e,n),zl(c,"VER",t.wa),Jh(t,c),c}function uf(){}function cf(){if($u&&!(10<=Number(sc)))throw Error("Environmental error: no available transport.")}function lf(t,e){Mc.call(this),this.a=new Qh(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=t,n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?e=i:((r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i)}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!Fu(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Fu(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pf(this)}function hf(t){vl.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ff(){bl.call(this),this.status=1}function pf(t){this.a=t}(fu=xh.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?dl(this.H):dl(ml),this.a.onreadystatechange=Au(this.Fa,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Fh(this,t)}t=n||"";var i,o=new Fl(this.headers);r&&Ll(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Lh,n=t.length,r=mu(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:mu(t)?t.charAt(e):t[e]}(o.K()),n=yu.FormData&&t instanceof yu.FormData,!(0<=Ou(Mh,e))||r||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jh(this),0<this.o&&((this.D=(i=this.a,$u&&cc(9)&&gu(i.timeout)&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=Au(this.Ca,this)):this.m=Xc(this.Ca,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Fh(this,t)}},fu.Ca=function(){void 0!==du&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},fu.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Vh(this))},fu.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vh(this,!0)),xh.N.G.call(this)},fu.Fa=function(){this.j||(this.w||this.l||this.g?qh(this):this.$a())},fu.$a=function(){qh(this)},fu.T=function(){try{return 2<Bh(this)?this.a.status:-1}catch(t){return-1}},fu.za=function(){try{return 2<Bh(this)?this.a.statusText:""}catch(t){return""}},fu.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},fu.Va=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rh(e)}},fu.ya=function(){return this.h},fu.Ya=function(){return mu(this.f)?this.f:String(this.f)},(fu=Qh.prototype).wa=8,fu.u=1,fu.Da=function(){return 0==this.u},fu.Ia=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new _l(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?Gu(r=Qu(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&mu(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$h(this,n,e),zl(i=Wl(this.B),"RID",t),zl(i,"CVER",22),this.o&&this.j&&zl(i,"X-HTTP-Session-Id",this.j),Jh(this,i),this.g&&r&&Kh(i,this.g,r),Sh(this.b,n),this.W?(zl(i,"$req",e),zl(i,"SID","null"),n.S=!0,Cl(n,i,null)):Cl(n,i,e),this.u=2}}else 3==this.u&&(t?Xh(this,t):0==this.f.length||_h(this.b)||Xh(this))},fu.Ha=function(){this.l=null,this.a=new _l(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Wl(this.pa);zl(t,"RID","rpc"),zl(t,"SID",this.H),zl(t,"CI",this.ia?"0":"1"),zl(t,"AID",this.O),Jh(this,t),zl(t,"TYPE","xmlhttp"),this.g&&this.i&&Kh(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Il(this.a,t,!0,this.ga)},fu.Ga=function(t,e){if(0!=this.u&&(this.a==t||Eh(this.b,t)))if(this.m=t.o,!t.s&&Eh(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(_u(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;nf(this),this.a.cancel(),this.a=null}tf(this),ul(18)}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=ll(Au(this.Za,this),6e3));if(Th(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else of(this,11)}else if((t.s||this.a==t)&&nf(this),!Fu(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&gu(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=Wh(r,"X-Client-Wire-Protocol"))&&wh(this.b,i),this.j&&(r=Wh(r,"X-HTTP-Session-Id")))&&(this.I=r,zl(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=sf(this,this.Y()?this.ga:null,this.ha),r.s?(Ch(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(xl(r),Dl(r)),this.a=r):Zh(this),0<this.f.length&&Yh(this)}else"stop"!=r[0]&&"close"!=r[0]||of(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?of(this,7):Hh(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},fu.Za=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,tf(this),ul(19))},fu.na=function(t){var e,n,r=null;if(this.a==t){nf(this),this.a=null;var i=2}else{if(!Eh(this.b,t))return;r=t.j,Ch(this.b,t),i=1}if(this.m=t.o,0!=this.u)if(t.b)1==i?(r=Du()-t.v,il.dispatchEvent(new cl(il,t.l?t.l.length:0,r,this.A)),Yh(this)):Zh(this);else{var o=t.c;if(3==o||0==o&&0<this.m||(1!=i||(n=t,Th((e=this).b)>=e.b.f-(e.h?1:0)||(e.h?(e.f=n.j.concat(e.f),0):1==e.u||2==e.u||e.A>=(e.Pa?0:e.Qa)||(e.h=ll(Au(e.Ia,e,n),rf(e,e.A)),e.A++,0))))&&(2!=i||!tf(this)))switch(r&&0<r.length&&(t=this.b,t.c=t.c.concat(r)),o){case 1:of(this,5);break;case 4:of(this,10);break;case 3:of(this,6);break;default:of(this,2)}}},fu.fb=function(t){ul(t?2:1)},fu.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new xh(this.La)).F=this.R,t},fu.ma=function(){return!!this.c&&!0},fu.Y=function(){return this.R},(fu=uf.prototype).va=function(){},fu.ua=function(){},fu.ta=function(){},fu.sa=function(){},fu.Ta=function(){},cf.prototype.a=function(t,e){return new lf(t,e)},Ru(lf,Mc),(fu=lf.prototype).addEventListener=function(t,e,n,r){lf.N.addEventListener.call(this,t,e,n,r)},fu.removeEventListener=function(t,e,n,r){lf.N.removeEventListener.call(this,t,e,n,r)},fu.Wa=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;ul(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new fh(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=Kh(e,t.g,t.i)),(t=t.w).i=n,e=sf(t.a,null,t.i),ul(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,ph(t)):(Yl(e,"MODE","init"),!t.a.o&&t.a.j&&Yl(e,"X-HTTP-Session-Id",t.a.j),t.b=new _l(t,void 0,void 0),t.b.h=t.h,Il(t.b,e,!1,null),t.M=0)},fu.close=function(){Hh(this.a)},fu.Xa=function(t){if(mu(t)){var e={};e.__data__=t,zh(this.a,e)}else this.h?((e={}).__data__=Fc(t),zh(this.a,e)):zh(this.a,t)},fu.G=function(){this.a.c=null,delete this.f,Hh(this.a),delete this.a,lf.N.G.call(this)},Ru(hf,vl),Ru(ff,bl),Ru(pf,uf),pf.prototype.va=function(){this.a.dispatchEvent("a")},pf.prototype.ua=function(t){this.a.dispatchEvent(new hf(t))},pf.prototype.ta=function(t){this.a.dispatchEvent(new ff(t))},pf.prototype.sa=function(){this.a.dispatchEvent("b")};var df=ku(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},cf);cf.prototype.createWebChannel=cf.prototype.a,lf.prototype.send=lf.prototype.Xa,lf.prototype.open=lf.prototype.Wa,lf.prototype.close=lf.prototype.close,hl.NO_ERROR=0,hl.TIMEOUT=8,hl.HTTP_ERROR=6,fl.COMPLETE="complete",(yl.EventType=gl).OPEN="a",gl.CLOSE="b",gl.ERROR="c",gl.MESSAGE="d",Mc.prototype.listen=Mc.prototype.Aa,xh.prototype.listenOnce=xh.prototype.Ba,xh.prototype.getLastError=xh.prototype.Ya,xh.prototype.getLastErrorCode=xh.prototype.ya,xh.prototype.getStatus=xh.prototype.T,xh.prototype.getStatusText=xh.prototype.za,xh.prototype.getResponseJson=xh.prototype.Va,xh.prototype.getResponseText=xh.prototype.aa,xh.prototype.send=xh.prototype.ca;var yf,mf,gf={createWebChannelTransport:df,ErrorCode:hl,EventType:fl,WebChannel:yl,XhrIo:xh},vf=gf.createWebChannelTransport,bf=gf.ErrorCode,wf=gf.EventType,_f=gf.WebChannel,Tf=gf.XhrIo,Ef=$i.SDK_VERSION,Sf=new Bi("@firebase/firestore");function Cf(){return Sf.logLevel===Pi.DEBUG?yf.DEBUG:Sf.logLevel===Pi.SILENT?yf.SILENT:yf.ERROR}function If(t){switch(t){case yf.DEBUG:Sf.logLevel=Pi.DEBUG;break;case yf.ERROR:Sf.logLevel=Pi.ERROR;break;case yf.SILENT:Sf.logLevel=Pi.SILENT;break;default:Sf.error("Firestore ("+Ef+"): Invalid value passed to `setLogLevel`")}}function Nf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Sf.logLevel<=Pi.DEBUG){var i=n.map(kf);Sf.debug.apply(Sf,ei(["Firestore ("+Ef+") ["+t+"]: "+e],i))}}function Af(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Sf.logLevel<=Pi.ERROR){var r=e.map(kf);Sf.error.apply(Sf,ei(["Firestore ("+Ef+"): "+t],r))}}function kf(t){if("string"==typeof t)return t;var e=xf.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}function Df(t){var e="FIRESTORE ("+Ef+") INTERNAL ASSERTION FAILED: "+t;throw Af(e),new Error(e)}function Rf(t,e){t||Df(e)}(mf=yf||(yf={}))[mf.DEBUG=0]="DEBUG",mf[mf.ERROR=1]="ERROR",mf[mf.SILENT=2]="SILENT";var xf=function(){function t(){}return t.setPlatform=function(e){t.platform&&Df("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||Df("Platform not set"),t.platform},t}();function Of(){return xf.getPlatform().emptyByteString}var Pf={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mf=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Yr(e,t),e}(Error);function Lf(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Mf(Pf.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function Ff(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Uf(t,e){return void 0!==t?t:e}function qf(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function Vf(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jf(t){for(var e in Rf(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Bf(t,e){if(0!==e.length)throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ip(e.length,"argument")+".")}function Wf(t,e,n){if(e.length!==n)throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() requires "+ip(n,"argument")+", but was called with "+ip(e.length,"argument")+".")}function Kf(t,e,n){if(e.length<n)throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ip(n,"argument")+", but was called with "+ip(e.length,"argument")+".")}function Qf(t,e,n,r){if(e.length<n||e.length>r)throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ip(e.length,"argument")+".")}function Hf(t,e,n,r){Jf(t,e,rp(n)+" argument",r)}function Gf(t,e,n,r){void 0!==r&&Hf(t,e,n,r)}function zf(t,e,n,r){Jf(t,e,n+" option",r)}function Yf(t,e,n,r){void 0!==r&&zf(t,e,n,r)}function Xf(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){var o,a,s=[];try{for(var u=Zr(i),c=u.next();!c.done;c=u.next()){var l=c.value;if(l===r)return;s.push(Zf(l))}}catch(t){o={error:t}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}var h=Zf(r);throw new Mf(Pf.INVALID_ARGUMENT,"Invalid value "+h+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+s.join(", "))}(t,0,n,r,i)}function Jf(t,e,n,r){if(!("object"===e?$f(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Zf(r);throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function $f(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Zf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":Df("Unknown wrong type: "+typeof t);if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}function tp(t,e,n){if(void 0===n)throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+rp(e)+" argument, but it was undefined.")}function ep(t,e,n){Vf(e,function(e,r){if(n.indexOf(e)<0)throw new Mf(Pf.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function np(t,e,n,r){var i=Zf(r);return new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() requires its "+rp(n)+" argument to be a "+e+", but it was: "+i)}function rp(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ip(t,e){return t+" "+e+(1===t?"":"s")}var op=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return Rf(20===e.length,"Invalid auto ID: "+e),e},t}();function ap(t,e){return t<e?-1:e<t?1:0}function sp(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function up(t){return t+"\0"}function cp(){if("undefined"==typeof Uint8Array)throw new Mf(Pf.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function lp(){if(!xf.getPlatform().base64Available)throw new Mf(Pf.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var hp,fp,pp=function(){function t(t){lp(),this._binaryString=t}return t.fromBase64String=function(e){Wf("Blob.fromBase64String",arguments,1),Hf("Blob.fromBase64String","string",1,e),lp();try{return new t(xf.getPlatform().atob(e))}catch(e){throw new Mf(Pf.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(Wf("Blob.fromUint8Array",arguments,1),cp(),!(e instanceof Uint8Array))throw np("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return Wf("Blob.toBase64",arguments,0),lp(),xf.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){Wf("Blob.toUint8Array",arguments,0),cp();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return ap(this._binaryString,t._binaryString)},t}(),dp=Lf(pp,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),yp=function(t,e,n,r,i){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},mp="(default)",gp=function(){function t(t,e){this.projectId=t,this.database=e||mp}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===mp},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return ap(this.projectId,t.projectId)||ap(this.database,t.database)},t}(),vp=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),bp="__name__",wp=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&Df("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&Df("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"==typeof e?n.push(e):Df("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,Rf(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return Rf(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return Rf(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return Rf(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),_p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(0<=t.indexOf("//"))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return 0<t.length}))},e.EMPTY_PATH=new e([]),e}(wp),Tp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ep=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.isValidIdentifier=function(t){return Tp.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===bp},e.keyField=function(){return new e([bp])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Mf(Pf.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Mf(Pf.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?a=!a:"."!==s||a?r+=s:o(),i++}if(o(),a)throw new Mf(Pf.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(wp),Sp=function(){function t(e){this.path=e,Rf(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.hasCollectionId=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===_p.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return _p.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new _p(e.slice()))},t.fromPathString=function(e){return new t(_p.fromString(e))},t.EMPTY=new t(new _p([])),t}(),Cp=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})};(fp=hp||(hp={})).All="all",fp.ListenStreamIdle="listen_stream_idle",fp.ListenStreamConnectionBackoff="listen_stream_connection_backoff",fp.WriteStreamIdle="write_stream_idle",fp.WriteStreamConnectionBackoff="write_stream_connection_backoff",fp.OnlineStateTimeout="online_state_timeout",fp.ClientMetadataRefresh="client_metadata_refresh",fp.LruGarbageCollection="lru_garbage_collection";var Ip=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Cp,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Mf(Pf.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),Np=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueue=function(t){var e=this;this.verifyNotFailed();var n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw Af("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),Rf(0<=e,"Attempted to schedule an operation with a negative delay of "+e),Rf(!this.containsDelayedOperation(t),"Attempted to schedule multiple operations with timer id "+t+".");var i=Ip.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&Df("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){Rf(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){var e,n;try{for(var r=Zr(this.delayedOperations),i=r.next();!i.done;i=r.next())if(i.value.timerId===t)return!0}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){var n,r;Rf(t===hp.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});try{for(var i=Zr(e.delayedOperations),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.skipDelay(),t!==hp.All&&a.timerId===t)break}}catch(r){n={error:r}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return e.drain()})},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);Rf(0<=e,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),Ap="",kp="",Dp="",Rp="";function xp(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Pp(e)),e=Op(t.get(n),e);return Pp(e)}function Op(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=Ap+Dp;break;case Ap:n+=Ap+Rp;break;default:n+=o}}return n}function Pp(t){return t+Ap+kp}function Mp(t){var e=t.length;if(Rf(2<=e,"Invalid path "+t),2===e)return Rf(t.charAt(0)===Ap&&t.charAt(1)===kp,"Non-empty path "+t+" had length 2"),_p.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(Ap,o);switch((a<0||n<a)&&Df('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case kp:var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case Dp:i+=t.substring(o,a),i+="\0";break;case Rp:i+=t.substring(o,a+1);break;default:Df('Invalid encoded resource path: "'+t+'"')}o=a+2}return new _p(r)}var Lp=function(){function t(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Mf(Pf.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Mf(Pf.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mf(Pf.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Mf(Pf.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ap(this.nanoseconds,t.nanoseconds):ap(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),Fp=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new Lp(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Lp(0,0)),t}(),Up=function(){function t(t,e){this.comparator=t,this.root=e||Vp.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vp.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vp.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new qp(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new qp(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new qp(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new qp(this.root,t,this.comparator,!0)},t}(),qp=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){Rf(0<this.nodeStack.length,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return 0<this.nodeStack.length},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Vp=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Df("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw Df("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw Df("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),jp=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Vp(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();Vp.EMPTY=new jp;var Bp=function(){function t(t){this.comparator=t,this.data=new Up(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,t[1]))return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Wp(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Wp(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Wp=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Kp=new Up(Sp.comparator);function Qp(){return Kp}function Hp(){return Qp()}var Gp=new Up(Sp.comparator);function zp(){return Gp}var Yp=new Up(Sp.comparator);function Xp(){return Yp}var Jp=new Bp(Sp.comparator);function $p(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=Jp;try{for(var o=Zr(n),a=o.next();!a.done;a=o.next()){var s=a.value;i=i.add(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return i}var Zp=new Bp(ap);function td(){return Zp}var ed,nd,rd=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,Rf(0<(this.mutations=r).length,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&Rf(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;Rf(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){var n,r,i,o;e&&Rf(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);try{for(var a=Zr(this.baseMutations),s=a.next();!s.done;s=a.next())(h=s.value).key.isEqual(t)&&(e=h.applyToLocalView(e,e,this.localWriteTime))}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}var u=e;try{for(var c=Zr(this.mutations),l=c.next();!l.done;l=c.next()){var h;(h=l.value).key.isEqual(t)&&(e=h.applyToLocalView(e,u,this.localWriteTime))}}catch(t){i={error:t}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},$p())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&sp(this.mutations,t.mutations)&&sp(this.baseMutations,t.baseMutations)},t}(),id=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){Rf(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Xp(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),od=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Df("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){var n,r,i=t.resolve(!1),o=function(e){i=i.next(function(n){return n?t.resolve(n):e()})};try{for(var a=Zr(e),s=a.next();!s.done;s=a.next())o(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),ad=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.indexManager=n,this.referenceDelegate=r,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r,i){return Rf(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ld(t).iterate({index:zd.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next(function(e){return e.lastStreamToken=cd(n),fd(t).put(e)})},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next(function(t){return t.lastStreamToken})},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next(function(n){return n.lastStreamToken=cd(e),fd(t).put(n)})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=hd(t),a=ld(t);return a.add({}).next(function(s){var u,c;Rf("number"==typeof s,"Auto-generated key is not a number");var l=new rd(s,e,n,r),h=i.serializer.toDbMutationBatch(i.userId,l);i.documentKeysByBatchId[s]=l.keys();var f=[];try{for(var p=Zr(r),d=p.next();!d.done;d=p.next()){var y=d.value,m=Yd.key(i.userId,y.key.path,s);f.push(a.put(h)),f.push(o.put(m,Yd.PLACEHOLDER)),f.push(i.indexManager.addToCollectionParentIndex(t,y.key.path.popLast()))}}catch(s){u={error:s}}finally{try{d&&!d.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}return od.waitFor(f).next(function(){return l})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return ld(t).get(e).next(function(t){return t?(Rf(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null})},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?od.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return ld(t).iterate({index:zd.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Rf(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()}).next(function(){return o})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ld(t).loadAll(zd.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Yd.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return hd(t).iterate({range:i},function(r,i,a){var s=ti(r,3),u=s[0],c=s[1],l=s[2],h=Mp(c);if(u===n.userId&&e.path.isEqual(h))return ld(t).get(l).next(function(t){if(!t)throw Df("Dangling document-mutation reference found: "+r+" which points to "+l);Rf(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+l),o.push(n.serializer.fromDbMutationBatch(t))});a.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Bp(ap),i=[];return e.forEach(function(e){var o=Yd.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=hd(t).iterate({range:a},function(t,i,o){var a=ti(t,3),s=a[0],u=a[1],c=a[2],l=Mp(u);s===n.userId&&e.path.isEqual(l)?r=r.add(c):o.done()});i.push(s)}),od.waitFor(i).next(function(){return n.lookupMutationBatches(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;Rf(!e.isDocumentQuery(),"Document queries shouldn't go down this path"),Rf(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=Yd.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Bp(ap);return hd(t).iterate({range:a},function(t,e,o){var a=ti(t,3),u=a[0],c=a[1],l=a[2],h=Mp(c);u===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(l)):o.done()}).next(function(){return n.lookupMutationBatches(t,s)})},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(ld(t).get(e).next(function(t){if(null===t)throw Df("Dangling document-mutation reference found, which points to "+e);Rf(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))}))}),od.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return ud(t.simpleDbTransaction,this.userId,e).next(function(r){return n.removeCachedMutationKeys(e.batchId),od.forEach(r,function(e){return n.referenceDelegate.removeMutationReference(t,e)})})},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return od.resolve();var r=IDBKeyRange.lowerBound(Yd.prefixForUser(e.userId)),i=[];return hd(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=Mp(t[1]);i.push(o)}else r.done()}).next(function(){Rf(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.containsKey=function(t,e){return sd(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return fd(t).get(this.userId).next(function(t){return t||new Gd(e.userId,-1,"")})},t}();function sd(t,e,n){var r=Yd.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return hd(t).iterate({range:o,keysOnly:!0},function(t,n,r){var o=ti(t,3),s=o[0],u=o[1];o[2],s===e&&u===i&&(a=!0),r.done()}).next(function(){return a})}function ud(t,e,n){var r,i,o=t.store(zd.store),a=t.store(Yd.store),s=[],u=IDBKeyRange.only(n.batchId),c=0,l=o.iterate({range:u},function(t,e,n){return c++,n.delete()});s.push(l.next(function(){Rf(1===c,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));var h=[];try{for(var f=Zr(n.mutations),p=f.next();!p.done;p=f.next()){var d=p.value,y=Yd.key(e,d.key.path,n.batchId);s.push(a.delete(y)),h.push(d.key)}}catch(t){r={error:t}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}return od.waitFor(s).next(function(){return h})}function cd(t){return t instanceof Uint8Array?(Rf("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function ld(t){return Sy.getStore(t,zd.store)}function hd(t){return Sy.getStore(t,Yd.store)}function fd(t){return Sy.getStore(t,Gd.store)}(nd=ed||(ed={}))[nd.QueryCache=0]="QueryCache",nd[nd.SyncEngine=1]="SyncEngine";var pd=function(){function t(t,e){Rf((1&(this.generatorId=t))===t,"Generator ID "+t+" contains more than 1 reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=2,t},t.prototype.after=function(t){return this.seek(t+2),this.next()},t.prototype.seek=function(t){Rf((1&t)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forQueryCache=function(){return new t(ed.QueryCache,2)},t.forSyncEngine=function(){return new t(ed.SyncEngine)},t}(),dd="SimpleDb",yd=function(){function t(e){this.db=e,12.2===t.getIOSVersion(fi())&&Af("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.openOrCreate=function(e,n,r){return Rf(t.isAvailable(),"IndexedDB not supported in current environment."),Nf(dd,"Opening database:",e),new od(function(i,o){var a=window.indexedDB.open(e,n);a.onsuccess=function(e){var n=e.target.result;i(new t(n))},a.onblocked=function(){o(new Mf(Pf.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new Mf(Pf.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},a.onupgradeneeded=function(t){Nf(dd,'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result,i=new gd(a.transaction);r.createOrUpgrade(n,i,t.oldVersion,Wd).next(function(){Nf(dd,"Database upgrade to version "+Wd+" complete")})}}).toPromise()},t.delete=function(t){return Nf(dd,"Removing database:",t),bd(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===process.env.USE_MOCK_PERSISTENCE;var e=fi(),n=t.getIOSVersion(e),r=0<n&&n<10,i=t.getAndroidVersion(e),o=0<i&&i<4.5;return!(0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")||r||o)},t.getStore=function(t,e){return t.store(e)},t.getIOSVersion=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.getAndroidVersion=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.setVersionChangeListener=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){var r=gd.open(this.db,t,e),i=n(r).catch(function(t){return r.abort(t),od.reject(t)}).toPromise();return i.catch(function(){}),r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),md=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return bd(this.dbCursor.delete())},t}(),gd=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new Cp,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){var n=_d(t.target.error);e.completionDeferred.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(Nf(dd,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return Rf(!!e,"Object store not part of transaction: "+t),new vd(e)},t}(),vd=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){return bd(void 0!==e?(Nf(dd,"PUT",this.store.name,t,e),this.store.put(e,t)):(Nf(dd,"PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},t.prototype.add=function(t){return Nf(dd,"ADD",this.store.name,t,t),bd(this.store.add(t))},t.prototype.get=function(t){var e=this;return bd(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Nf(dd,"GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Nf(dd,"DELETE",this.store.name,t),bd(this.store.delete(t))},t.prototype.count=function(){return Nf(dd,"COUNT",this.store.name),bd(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){Nf(dd,"DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new od(function(n,r){e.onerror=function(t){var e=_d(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.iterateCursor=function(t,e){var n=[];return new od(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new md(i),a=e(i.primaryKey,i.value,o);if(a instanceof od){var s=a.catch(function(t){return o.done(),od.reject(t)});n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return od.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(Rf(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function bd(t){return new od(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=_d(t.target.error);n(e)}})}var wd=!1;function _d(t){var e=yd.getIOSVersion(fi());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Mf("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return wd||(wd=!0,setTimeout(function(){throw r},0)),r}}return t}var Td=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=pd.forQueryCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next(function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next(function(t){return Fp.fromTimestamp(new Lp(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return Cd(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)})},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.retrieveMetadata(t).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(e,r),n.saveMetadata(t,r)})})},t.prototype.updateQueryData=function(t,e){return this.saveQueryData(t,e)},t.prototype.removeQueryData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Ed(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return Rf(0<e.targetCount,"Removing from an empty query cache"),e.targetCount-=1,n.saveMetadata(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Ed(t).iterate(function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&void 0===n[u.targetId]&&(i++,o.push(r.removeQueryData(t,u)))}).next(function(){return od.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){var n=this;return Ed(t).iterate(function(t,r){var i=n.serializer.fromDbTarget(r);e(i)})},t.prototype.retrieveMetadata=function(t){return Sd(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,Sy.getStore(n,ny.store)).put(ny.key,e);var n},t.prototype.saveQueryData=function(t,e){return Ed(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getQueryCount=function(t){return this.retrieveMetadata(t).next(function(t){return t.targetCount})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Ed(t).iterate({range:i,index:ty.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Id(t);return e.forEach(function(e){var a=xp(e.path);i.push(o.put(new ey(n,a))),i.push(r.referenceDelegate.addReference(t,e))}),od.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Id(t);return od.forEach(e,function(e){var o=xp(e.path);return od.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Id(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Id(t),i=$p();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=Mp(t[1]),o=new Sp(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=xp(e.path),r=IDBKeyRange.bound([n],[up(n)],!1,!0),i=0;return Id(t).iterate({index:ey.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){var r=ti(t,2),o=r[0];r[1],0!==o&&(i++,n.done())}).next(function(){return 0<i})},t.prototype.getQueryDataForTarget=function(t,e){var n=this;return Ed(t).get(e).next(function(t){return t?n.serializer.fromDbTarget(t):null})},t}();function Ed(t){return Sy.getStore(t,ty.store)}function Sd(t){return yd.getStore(t,ny.store).get(ny.key).next(function(t){return Rf(null!==t,"Missing metadata row."),t})}function Cd(t){return Sd(t).next(function(t){return t.highestListenSequenceNumber})}function Id(t){return Sy.getStore(t,ey.store)}var Nd=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return Sp.comparator(t.key,e.key)},t}(),Ad=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n)||this;return a.data=r,a.proto=o,a.hasLocalMutations=!!i.hasLocalMutations,a.hasCommittedMutations=!!i.hasCommittedMutations,a}return Yr(e,t),e.prototype.field=function(t){return this.data.field(t)},e.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},e.prototype.value=function(){return this.data.value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.data.isEqual(t.data)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.compareTo(i):Df("Trying to compare documents on fields that don't exist")},e}(Nd),kd=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Yr(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Nd),Dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Nd),Rd=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e,n,r=this.mapKeyFn(t),i=this.inner[r];if(void 0!==i)try{for(var o=Zr(i),a=o.next();!a.done;a=o.next()){var s=ti(a.value,2),u=s[0],c=s[1];if(u.isEqual(t))return c}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Vf(this.inner,function(e,n){var r,i;try{for(var o=Zr(n),a=o.next();!a.done;a=o.next()){var s=ti(a.value,2),u=s[0],c=s[1];t(u,c)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}})},t.prototype.isEmpty=function(){return jf(this.inner)},t}(),xd=function(){function t(){this.changes=Qp(),this.documentSizes=new Rd(function(t){return t.toString()})}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this,r=this.assertChanges().get(e);return r?od.resolve(r):this.getFromCache(t,e).next(function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)})},t.prototype.getEntries=function(t,e){var n=this;return this.getAllFromCache(t,e).next(function(t){var e=t.maybeDocuments;return t.sizeMap.forEach(function(t,e){n.documentSizes.set(t,e)}),e})},t.prototype.apply=function(t){var e=this.applyChanges(t);return this.changes=null,e},t.prototype.assertChanges=function(){return Rf(null!==this.changes,"Changes have already been applied."),this.changes},t}(),Od="The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.",Pd=function(){function t(t,e,n){this.serializer=t,this.indexManager=e,this.keepDocumentChangeLog=n,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(t.prototype,"lastProcessedDocumentChangeId",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),t.prototype.start=function(t){var e=yd.getStore(t,sy.store);return this.synchronizeLastDocumentChangeId(e)},t.prototype.addEntries=function(t,e,n){var r,i,o=[];if(0<e.length){var a=Fd(t),s=$p();try{for(var u=Zr(e),c=u.next();!c.done;c=u.next()){var l=c.value,h=l.key,f=l.doc;o.push(a.put(qd(h),f)),s=s.add(h),o.push(this.indexManager.addToCollectionParentIndex(t,h.path.popLast()))}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}this.keepDocumentChangeLog&&o.push(Ud(t).put({changes:this.serializer.toDbResourcePaths(s)})),o.push(this.updateSize(t,n))}return od.waitFor(o)},t.prototype.removeEntry=function(t,e){var n=Fd(t),r=qd(e);return n.get(r).next(function(t){return t?n.delete(r).next(function(){return Vd(t)}):od.resolve(0)})},t.prototype.getEntry=function(t,e){var n=this;return Fd(t).get(qd(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getSizedEntry=function(t,e){var n=this;return Fd(t).get(qd(e)).next(function(t){return t?{maybeDocument:n.serializer.fromDbRemoteDocument(t),size:Vd(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Hp();return this.forEachDbEntry(t,e,function(t,e){r=e?r.insert(t,n.serializer.fromDbRemoteDocument(e)):r.insert(t,null)}).next(function(){return r})},t.prototype.getSizedEntries=function(t,e){var n=this,r=Hp(),i=new Up(Sp.comparator);return this.forEachDbEntry(t,e,function(t,e){i=e?(r=r.insert(t,n.serializer.fromDbRemoteDocument(e)),i.insert(t,Vd(e))):(r=r.insert(t,null),i.insert(t,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return od.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Fd(t).iterate({range:r},function(t,e,r){for(var a=Sp.fromSegments(t);o&&Sp.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this;Rf(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=zp(),i=e.path.length+1,o=e.path.toArray(),a=IDBKeyRange.lowerBound(o);return Fd(t).iterate({range:a},function(t,o,a){if(t.length===i){var s=n.serializer.fromDbRemoteDocument(o);e.path.isPrefixOf(s.key.path)?s instanceof Ad&&e.matches(s)&&(r=r.insert(s.key,s)):a.done()}}).next(function(){return r})},t.prototype.getNewDocumentChanges=function(t){var e=this;Rf(this.keepDocumentChangeLog,"Can only call getNewDocumentChanges() when document change log is enabled");var n=$p(),r=Qp(),i=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),o=!0,a=Ud(t);return a.iterate({range:i},function(t,r){if(o&&(o=!1,e._lastProcessedDocumentChangeId+1!==r.id))return e.synchronizeLastDocumentChangeId(a).next(function(){return od.reject(new Mf(Pf.DATA_LOSS,Od))});n=n.unionWith(e.serializer.fromDbResourcePaths(r.changes)),e._lastProcessedDocumentChangeId=r.id}).next(function(){var i=[];return n.forEach(function(n){i.push(e.getEntry(t,n).next(function(t){var e=t||new kd(n,Fp.forDeletedDoc());r=r.insert(n,e)}))}),od.waitFor(i)}).next(function(){return r})},t.prototype.removeDocumentChangesThroughChangeId=function(t,e){var n=IDBKeyRange.upperBound(e);return Ud(t).delete(n)},t.prototype.synchronizeLastDocumentChangeId=function(t){var e=this;return this._lastProcessedDocumentChangeId=0,t.iterate({keysOnly:!0,reverse:!0},function(t,n,r){e._lastProcessedDocumentChangeId=t,r.done()})},t.prototype.newChangeBuffer=function(){return new Ld(this)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Md(t).get(Zd.key).next(function(t){return Rf(!!t,"Missing document cache metadata"),t})},t.prototype.setMetadata=function(t,e){return Md(t).put(Zd.key,e)},t.prototype.updateSize=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.setMetadata(t,r)})},t}();function Md(t){return Sy.getStore(t,Zd.store)}var Ld=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return Yr(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentCache.serializer.toDbRemoteDocument(n),a=e.documentSizes.get(t);Rf(void 0!==a,"Attempting to change document "+t.toString()+" without having read it first");var s=Vd(o);r+=s-a,i.push({key:t,doc:o})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(xd);function Fd(t){return Sy.getStore(t,$d.store)}function Ud(t){return Sy.getStore(t,sy.store)}function qd(t){return t.path.toArray()}function Vd(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Df("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var jd=function(){function t(){this.collectionParentIndex=new Bd}return t.prototype.addToCollectionParentIndex=function(t,e){return this.collectionParentIndex.add(e),od.resolve()},t.prototype.getCollectionParents=function(t,e){return od.resolve(this.collectionParentIndex.getEntries(e))},t}(),Bd=function(){function t(){this.index={}}return t.prototype.add=function(t){Rf(t.length%2==1,"Expected a collection path.");var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Bp(_p.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.getEntries=function(t){return(this.index[t]||new Bp(_p.comparator)).toArray()},t}(),Wd=8,Kd=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i,o=this;Rf(n<r&&0<=n&&r<=Wd,"Unexpected schema upgrade from v"+n+" to v{toVersion}."),n<1&&1<=r&&(t.createObjectStore(Hd.store),(i=t).createObjectStore(Gd.store,{keyPath:Gd.keyPath}),i.createObjectStore(zd.store,{keyPath:zd.keyPath,autoIncrement:!0}).createIndex(zd.userMutationsIndex,zd.userMutationsKeyPath,{unique:!0}),i.createObjectStore(Yd.store),iy(t),t.createObjectStore($d.store));var a,s=od.resolve();return n<3&&3<=r&&(0!==n&&((a=t).deleteObjectStore(ey.store),a.deleteObjectStore(ty.store),a.deleteObjectStore(ny.store),iy(t)),s=s.next(function(){return t=e.store(ny.store),n=new ny(0,0,Fp.MIN.toTimestamp(),0),t.put(ny.key,n);var t,n})),n<4&&4<=r&&(0!==n&&(s=s.next(function(){return n=t,(r=e).store(zd.store).loadAll().next(function(t){n.deleteObjectStore(zd.store),n.createObjectStore(zd.store,{keyPath:zd.keyPath,autoIncrement:!0}).createIndex(zd.userMutationsIndex,zd.userMutationsKeyPath,{unique:!0});var e=r.store(zd.store),i=t.map(function(t){return e.put(t)});return od.waitFor(i)});var n,r})),s=s.next(function(){t.createObjectStore(uy.store,{keyPath:uy.keyPath}),t.createObjectStore(sy.store,{keyPath:"id",autoIncrement:!0})})),n<5&&5<=r&&(s=s.next(function(){return o.removeAcknowledgedMutations(e)})),n<6&&6<=r&&(s=s.next(function(){return t.createObjectStore(Zd.store),o.addDocumentGlobal(e)})),n<7&&7<=r&&(s=s.next(function(){return o.ensureSequenceNumbers(e)})),n<8&&8<=r&&(s=s.next(function(){return o.createCollectionParentIndex(t,e)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store($d.store).iterate(function(t,n){e+=Vd(n)}).next(function(){var n=new Zd(e);return t.store(Zd.store).put(Zd.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Gd.store),r=t.store(zd.store);return n.loadAll().next(function(n){return od.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(zd.userMutationsIndex,i).next(function(r){return od.forEach(r,function(r){Rf(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return ud(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(ey.store),n=t.store($d.store);return Cd(t).next(function(t){var r=[];return n.iterate(function(n,i){var o=new _p(n),a=[0,xp(o)];r.push(e.get(a).next(function(n){return n?od.resolve():(r=o,e.put(new ey(0,xp(r),t)));var r}))}).next(function(){return od.waitFor(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(ry.store,{keyPath:ry.keyPath});var n=e.store(ry.store),r=new Bd,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:xp(i)})}};return e.store($d.store).iterate({keysOnly:!0},function(t,e){var n=new _p(t);return i(n.popLast())}).next(function(){return e.store(Yd.store).iterate({keysOnly:!0},function(t,e){var n=ti(t,3),r=(n[0],n[1]),o=(n[2],Mp(r));return i(o.popLast())})})},t}(),Qd=function(t,e){this.seconds=t,this.nanoseconds=e},Hd=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}(),Gd=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),zd=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}(),Yd=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,xp(e)]},t.key=function(t,e,n){return[t,xp(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),Xd=function(t,e){this.path=t,this.readTime=e},Jd=function(t,e){this.path=t,this.version=e},$d=function(){function t(t,e,n,r){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r}return t.store="remoteDocuments",t}(),Zd=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}(),ty=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),ey=function(){function t(t,e,n){this.targetId=t,this.path=e,Rf(0===t==(void 0!==(this.sequenceNumber=n)),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),ny=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),ry=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function iy(t){t.createObjectStore(ey.store,{keyPath:ey.keyPath}).createIndex(ey.documentTargetsIndex,ey.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ty.store,{keyPath:ty.keyPath}).createIndex(ty.queryTargetsIndexName,ty.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ny.store)}var oy,ay,sy=function(){function t(t){this.changes=t}return t.store="remoteDocumentChanges",t.keyPath="id",t}(),uy=function(){function t(t,e,n,r,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=i}return t.store="clientMetadata",t.keyPath="clientId",t}(),cy=ei(ei(ei([Gd.store,zd.store,Yd.store,$d.store,ty.store,Hd.store,ny.store,ey.store],[uy.store,sy.store]),[Zd.store]),[ry.store]),ly=function(){function t(){this.collectionParentsCache=new Bd}return t.prototype.addToCollectionParentIndex=function(t,e){if(Rf(e.length%2==1,"Expected a collection path."),this.collectionParentsCache.add(e)){Rf(1<=e.length,"Invalid collection path.");var n=e.lastSegment(),r=e.popLast();return hy(t).put({collectionId:n,parent:xp(r)})}return od.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[up(e),""],!1,!0);return hy(t).loadAll(r).next(function(t){var r,i;try{for(var o=Zr(t),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.collectionId!==e)break;n.push(Mp(s.parent))}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return n})},t}();function hy(t){return Sy.getStore(t,ry.store)}(ay=oy||(oy={}))[ay.Listen=0]="Listen",ay[ay.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",ay[ay.LimboResolution=2]="LimboResolution";var fy=function(){function t(t,e,n,r,i,o){void 0===i&&(i=Fp.MIN),void 0===o&&(o=Of()),this.query=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.resumeToken=o}return t.prototype.copy=function(e){return new t(this.query,this.targetId,this.purpose,void 0===e.sequenceNumber?this.sequenceNumber:e.sequenceNumber,void 0===e.snapshotVersion?this.snapshotVersion:e.snapshotVersion,void 0===e.resumeToken?this.resumeToken:e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),py=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=Sp.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new kd(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}return t.unknownDocument?(e=Sp.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version),new Dd(e,n)):Df("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof Ad){var e=t.proto?t.proto:this.remoteSerializer.toDocument(t),n=t.hasCommittedMutations;return new $d(null,null,e,n)}if(t instanceof kd){var r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);return n=t.hasCommittedMutations,new $d(null,new Xd(r,i),null,n)}return t instanceof Dd?(r=t.key.path.toArray(),i=this.toDbTimestamp(t.version),new $d(new Jd(r,i),null,null,!0)):Df("Unexpected MaybeDocumment")},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new Qd(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new Lp(t.seconds,t.nanoseconds);return Fp.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.remoteSerializer.toMutation(t)}),i=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new zd(t,e.batchId,e.localWriteTime.toMillis(),r,i)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.remoteSerializer.fromMutation(t)}),r=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),i=Lp.fromMillis(t.localWriteTimeMs);return new rd(t.batchId,i,n,r)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach(function(t){e.push(xp(t.path))}),e},t.prototype.fromDbResourcePaths=function(t){var e,n,r=$p();try{for(var i=Zr(t),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.add(new Sp(Mp(a)))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime);return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new fy(e,t.targetId,oy.Listen,t.lastListenSequenceNumber,n,t.resumeToken)},t.prototype.toDbTarget=function(t){Rf(oy.Listen===t.purpose,"Only queries with purpose "+oy.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion);return e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),n=t.resumeToken instanceof Uint8Array?(Rf("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),t.resumeToken.toString()):t.resumeToken,new ty(t.targetId,t.query.canonicalId(),r,n,t.sequenceNumber,e)},t}();function dy(t,e){var n=ti(t,2),r=n[0],i=n[1],o=ti(e,2),a=o[0],s=o[1],u=ap(r,a);return 0===u?ap(i,s):u}var yy=function(){function t(t){this.maxElements=t,this.buffer=new Bp(dy),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();dy(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),my={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gy=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),vy=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.gcTask=null}return t.prototype.start=function(){Rf(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==gy.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;Rf(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;Nf("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(hp.LruGarbageCollection,e,function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then(function(){return t.scheduleGC()}).catch(Cy)})},t}(),by=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return od.resolve(vp.INVALID);var r=new yy(e);return this.delegate.forEachTarget(t,function(t){return r.addElement(t.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,function(t){return r.addElement(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===gy.COLLECTION_DISABLED?(Nf("LruGarbageCollector","Garbage collection skipped; disabled"),od.resolve(my)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Nf("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),my):n.runGarbageCollection(t,e)})},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,i,o,a,s,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return r=e>c.params.maximumSequenceNumbersToCollect?(Nf("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),c.params.maximumSequenceNumbersToCollect):e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,a=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,s=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),Cf()<=yf.DEBUG&&Nf("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+t+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms"),od.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),wy="IndexedDbPersistence",_y="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ty="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Ey=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return Yr(e,t),e}(function(){}),Sy=function(){function t(e,n,r,i,o,a,s){if(this.persistenceKey=e,this.clientId=n,this.queue=i,this.multiClientParams=s,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},!t.isAvailable())throw new Mf(Pf.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");if(this.referenceDelegate=new xy(this,a),this.dbName=e+t.MAIN_DATABASE,this.serializer=new py(o),this.document=r.document,this.allowTabSynchronization=void 0!==s,this.queryCache=new Td(this.referenceDelegate,this.serializer),this.indexManager=new ly,this.remoteDocumentCache=new Pd(this.serializer,this.indexManager,this.allowTabSynchronization),!r.window||!r.window.localStorage)throw new Mf(Pf.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof Ey)return yd.getStore(t.simpleDbTransaction,e);throw Df("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e,n,r,i,o,a){return Jr(this,void 0,void 0,function(){var s;return $r(this,function(u){switch(u.label){case 0:return[4,(s=new t(e,n,r,i,o,a)).start()];case 1:return u.sent(),[2,s]}})})},t.createMultiClientIndexedDbPersistence=function(e,n,r,i,o,a,s){return Jr(this,void 0,void 0,function(){var u;return $r(this,function(c){switch(c.label){case 0:return[4,(u=new t(e,n,r,i,o,a,s)).start()];case 1:return c.sent(),[2,u]}})})},t.prototype.start=function(){var t=this;return Rf(!this.started,"IndexedDbPersistence double-started!"),Rf(null!==this.window,"Expected 'window' to be defined"),yd.openOrCreate(this.dbName,Wd,new Kd(this.serializer)).then(function(e){return t.simpleDb=e,t.updateClientMetadataAndTryBecomePrimary()}).then(function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.scheduleClientMetadataAndPrimaryLeaseRefreshes(),t.startRemoteDocumentCache()}).then(function(){return t.simpleDb.runTransaction("readonly",[ny.store],function(e){return Cd(e).next(function(e){var n=t.multiClientParams?t.multiClientParams.sequenceNumberSyncer:void 0;t.listenSequence=new vp(e,n)})})}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},t.prototype.startRemoteDocumentCache=function(){var t=this;return this.simpleDb.runTransaction("readonly",cy,function(e){return t.remoteDocumentCache.start(e)})},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return Jr(e,void 0,void 0,function(){return $r(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.simpleDb.setVersionChangeListener(function(n){return Jr(e,void 0,void 0,function(){return $r(this,function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget(function(){return Jr(e,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite",cy,function(e){return Ny(e).put(new uy(t.clientId,Date.now(),t.networkEnabled,t.inForeground,t.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next(function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget(function(){return t.primaryStateListener(!1)}))})}).next(function(){return t.canActAsPrimary(e)}).next(function(n){var r=t.isPrimary;return t.isPrimary=n,r!==t.isPrimary&&t.queue.enqueueAndForget(function(){return t.primaryStateListener(t.isPrimary)}),r&&!t.isPrimary?t.releasePrimaryLeaseIfHeld(e):t.isPrimary?t.acquireOrExtendPrimaryLease(e):void 0})})},t.prototype.verifyPrimaryLease=function(t){var e=this;return Iy(t).get(Hd.key).next(function(t){return od.resolve(e.isLocalClient(t))})},t.prototype.removeClientMetadata=function(t){return Ny(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return Jr(this,void 0,void 0,function(){var e,n,r=this;return $r(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(i){var o=t.getStore(i,uy.store);return o.loadAll().next(function(t){e=r.filterActiveClients(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)})}).next(function(){return od.forEach(n,function(t){return o.delete(t.clientId)})}).next(function(){if(0<(e=e.filter(function(t){return t.clientId!==r.clientId})).length){var t=e.map(function(t){return t.lastProcessedDocumentChangeId||0}),n=Math.min.apply(Math,ei(t));return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(i,n)}})})]);case 1:i.sent(),n.forEach(function(t){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(t.clientId))}),i.label=2;case 2:return[2]}})})},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(hp.ClientMetadataRefresh,4e3,function(){return t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.maybeGarbageCollectMultiClientState()}).then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return Iy(t).get(Hd.key).next(function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new Mf(Pf.FAILED_PRECONDITION,Ty);return!1}}return!(!e.networkEnabled||!e.inForeground)||Ny(t).loadAll().next(function(t){return void 0===e.filterActiveClients(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&Nf(wy,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Jr(this,void 0,void 0,function(){var t=this;return $r(this,function(e){switch(e.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite",[Hd.store,uy.store],function(e){return t.releasePrimaryLeaseIfHeld(e).next(function(){return t.removeClientMetadata(e)})})];case 1:return e.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),[2]}})})},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter(function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)})},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly",[uy.store],function(e){return Ny(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(e){return Jr(this,void 0,void 0,function(){var n;return $r(this,function(r){switch(r.label){case 0:return t.isAvailable()?(n=e+t.MAIN_DATABASE,[4,yd.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}})})},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return Rf(this.started,"Cannot initialize MutationQueue before persistence is started."),ad.forUser(t,this.serializer,this.indexManager,this.referenceDelegate)},t.prototype.getQueryCache=function(){return Rf(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},t.prototype.getRemoteDocumentCache=function(){return Rf(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.getIndexManager=function(){return Rf(this.started,"Cannot initialize IndexManager before persistence is started."),this.indexManager},t.prototype.runTransaction=function(t,e,n){var r=this;return Nf(wy,"Starting transaction:",t),this.simpleDb.runTransaction("readonly"===e?"readonly":"readwrite",cy,function(i){return"readwrite-primary"===e?r.verifyPrimaryLease(i).next(function(e){if(!e)throw Af("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new Mf(Pf.FAILED_PRECONDITION,_y);return n(new Ey(i,r.listenSequence.next()))}).next(function(t){return r.acquireOrExtendPrimaryLease(i).next(function(){return t})}):r.verifyAllowTabSynchronization(i).next(function(){return n(new Ey(i,r.listenSequence.next()))})})},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return Iy(t).get(Hd.key).next(function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new Mf(Pf.FAILED_PRECONDITION,Ty)})},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new Hd(this.clientId,this.allowTabSynchronization,Date.now());return Iy(t).put(Hd.key,e)},t.isAvailable=function(){return yd.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=Iy(t);return n.get(Hd.key).next(function(t){return e.isLocalClient(t)?(Nf(wy,"Releasing primary lease."),n.delete(Hd.key)):od.resolve()})},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Af("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(Rf(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(Rf("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return Nf(wy,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Af(wy,"Failed to get zombied client id.",t),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){Af("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function Cy(t){return Jr(this,void 0,void 0,function(){return $r(this,function(e){if((n=t).code!==Pf.FAILED_PRECONDITION||n.message!==_y)throw t;var n;return Nf(wy,"Unexpectedly lost primary lease"),[2]})})}function Iy(t){return t.store(Hd.store)}function Ny(t){return t.store(uy.store)}var Ay,ky,Dy,Ry,xy=function(){function t(t,e){this.db=t,this.garbageCollector=new by(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getQueryCache().getQueryCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getQueryCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,function(t,n){return e(n)})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return Oy(t,e)},t.prototype.removeReference=function(t,e){return Oy(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getQueryCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return Oy(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?od.resolve(!0):(r=e,i=!1,fd(n=t).iterateSerial(function(t){return sd(n,t,r).next(function(t){return t&&(i=!0),od.resolve(!t)})}).next(function(){return i}));var n,r,i},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=0,o=[];return this.forEachOrphanedDocument(t,function(a,s){if(s<=e){var u=n.isPinned(t,a).next(function(e){if(!e)return r++,n.removeOrphanedDocument(t,a).next(function(t){i+=t})});o.push(u)}}).next(function(){return od.waitFor(o)}).next(function(){return n.db.getRemoteDocumentCache().updateSize(t,-i)}).next(function(){return r})},t.prototype.removeOrphanedDocument=function(t,e){var n,r=0,i=this.db.getRemoteDocumentCache();return od.waitFor([Id(t).delete((n=e,[0,xp(n.path)])),i.removeEntry(t,e).next(function(t){r+=t})]).next(function(){return r})},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Oy(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=Id(t),i=vp.INVALID;return r.iterate({index:ey.documentTargetsIndex},function(t,r){var o=ti(t,2),a=o[0],s=(o[1],r.path),u=r.sequenceNumber;0===a?(i!==vp.INVALID&&e(new Sp(Mp(n)),i),i=u,n=s):i=vp.INVALID}).next(function(){i!==vp.INVALID&&e(new Sp(Mp(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Oy(t,e){return Id(t).put((n=e,r=t.currentSequenceNumber,new ey(0,xp(n.path),r)));var n,r}(ky=Ay||(Ay={}))[ky.NullValue=0]="NullValue",ky[ky.BooleanValue=1]="BooleanValue",ky[ky.NumberValue=2]="NumberValue",ky[ky.TimestampValue=3]="TimestampValue",ky[ky.StringValue=4]="StringValue",ky[ky.BlobValue=5]="BlobValue",ky[ky.RefValue=6]="RefValue",ky[ky.GeoPointValue=7]="GeoPointValue",ky[ky.ArrayValue=8]="ArrayValue",ky[ky.ObjectValue=9]="ObjectValue",(Ry=Dy||(Dy={}))[Ry.Default=0]="Default",Ry[Ry.Estimate=1]="Estimate",Ry[Ry.Previous=2]="Previous";var Py=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(Dy.Estimate,n);case"previous":return new t(Dy.Previous,n);case"none":case void 0:return new t(Dy.Default,n);default:return Df("fromSnapshotOptions() called with invalid options.")}},t}(),My=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return Rf(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),ap(this.typeOrder,t.typeOrder)},t}(),Ly=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=Ay.NullValue,e.internalValue=null,e}return Yr(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(My),Fy=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Ay.BooleanValue,n}return Yr(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?ap(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(My),Uy=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Ay.NumberValue,n}return Yr(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue)<(r=t.internalValue)?-1:r<n?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1:this.defaultCompareTo(t);var n,r},e}(My);function qy(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var Vy,jy,By=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.prototype.isEqual=function(t){return t instanceof e&&qy(this.internalValue,t.internalValue)},e}(Uy),Wy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.prototype.isEqual=function(t){return t instanceof e&&qy(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(Uy),Ky=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Ay.StringValue,n}return Yr(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?ap(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(My),Qy=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Ay.TimestampValue,n}return Yr(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof Hy?-1:this.defaultCompareTo(t)},e}(My),Hy=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=Ay.TimestampValue,r}return Yr(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===Dy.Estimate?new Qy(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===Dy.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Qy?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(My),Gy=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Ay.BlobValue,n}return Yr(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(My),zy=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=Ay.RefValue,r}return Yr(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId)},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:Sp.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(My),Yy=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Ay.GeoPointValue,n}return Yr(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(My),Xy=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Ay.ObjectValue,n}return Yr(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=ap(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return ap(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(Rf(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(Rf(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return null!==this.field(t)},e.prototype.field=function(t){Rf(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e?n.internalValue.get(t):null}),n},e.prototype.fieldMask=function(){var t=new Bp(Ep.comparator);return this.internalValue.forEach(function(n,r){var i=new Ep([n]);if(r instanceof e){var o=r.fieldMask().fields;o.isEmpty()?t=t.add(i):o.forEach(function(e){t=t.add(i.child(e))})}else t=t.add(i)}),$y.fromSet(t)},e.prototype.toString=function(){return this.internalValue.toString()},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new Up(ap)),e}(My),Jy=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Ay.ArrayValue,n}return Yr(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.contains=function(t){var e,n;try{for(var r=Zr(this.internalValue),i=r.next();!i.done;i=r.next())if(i.value.isEqual(t))return!0}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!1},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return ap(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return"["+this.internalValue.map(function(t){return t.toString()}).join(",")+"]"},e}(My),$y=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new Bp(Ep.comparator);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach(function(n){n.isPrefixOf(t)&&(e=!0)}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),Zy=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),tm=function(t,e){this.version=t,this.transformResults=e};(jy=Vy||(Vy={}))[jy.Set=0]="Set",jy[jy.Patch=1]="Patch",jy[jy.Transform=2]="Transform",jy[jy.Delete=3]="Delete";var em=function(){function t(t,e){this.updateTime=t,this.exists=e,Rf(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof Ad&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof Ad:(Rf(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!=e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),nm=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&Rf(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof Ad?t.version:Fp.MIN},t}(),rm=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=Vy.Set,i}return Yr(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),Rf(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new Ad(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=nm.getPostMutationVersion(t);return new Ad(this.key,r,this.value,{hasLocalMutations:!0})},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(nm),im=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=Vy.Patch,o}return Yr(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),Rf(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new Dd(this.key,e.version);var n=this.patchDocument(t);return new Ad(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=nm.getPostMutationVersion(t),i=this.patchDocument(t);return new Ad(this.key,r,i,{hasLocalMutations:!0})},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof Ad?t.data:Xy.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t=null!==r?t.set(n,r):t.delete(n)}}),t},e}(nm),om=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=Vy.Transform,r.precondition=em.exists(!0),r}return Yr(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),Rf(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new Dd(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data,r);return new Ad(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,t,e),o=this.transformObject(r.data,i);return new Ad(this.key,r.version,o,{hasLocalMutations:!0})},e.prototype.extractBaseValue=function(t){var e,n,r=null;try{for(var i=Zr(this.fieldTransforms),o=i.next();!o.done;o=i.next()){var a=o.value,s=t instanceof Ad?t.field(a.field):void 0,u=a.transform.computeBaseValue(s||null);null!=u&&(r=null==r?Xy.EMPTY.set(a.field,u):r.set(a.field,u))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&sp(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){Rf(t instanceof Ad,"Unknown MaybeDocument type "+t);var e=t;return Rf(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.serverTransformResults=function(t,e){var n=[];Rf(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof Ad&&(a=t.field(i.field)),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e,n){var r,i,o=[];try{for(var a=Zr(this.fieldTransforms),s=a.next();!s.done;s=a.next()){var u=s.value,c=u.transform,l=null;e instanceof Ad&&(l=e.field(u.field)),null===l&&n instanceof Ad&&(l=n.field(u.field)),o.push(c.applyToLocalView(l,t))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o},e.prototype.transformObject=function(t,e){Rf(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},e}(nm),am=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=Vy.Delete,r}return Yr(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),Rf(null==e.transformResults,"Transform results received by DeleteMutation."),new kd(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&Rf(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new kd(this.key,Fp.forDeletedDoc())):t},e.prototype.extractBaseValue=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(nm),sm=function(){function t(t,e,n){this.remoteDocumentCache=t,this.mutationQueue=e,this.indexManager=n}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.getDocumentInternal(t,e,r)})},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next(function(t){var r,i;try{for(var o=Zr(n),a=o.next();!a.done;a=o.next())t=a.value.applyToLocalView(e,t)}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return t})},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=Hp();return e.forEach(function(t,e){var i,o;try{for(var a=Zr(n),s=a.next();!s.done;s=a.next())e=s.value.applyToLocalView(t,e)}catch(t){i={error:t}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}r=r.insert(t,e)}),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Qp();return i.forEach(function(t,e){e||(e=new kd(t,Fp.forDeletedDoc())),o=o.insert(t,e)}),o})},t.prototype.getDocumentsMatchingQuery=function(t,e){return e.isDocumentQuery()?this.getDocumentsMatchingDocumentQuery(t,e.path):e.isCollectionGroupQuery()?this.getDocumentsMatchingCollectionGroupQuery(t,e):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new Sp(e)).next(function(t){var e=zp();return t instanceof Ad&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionGroupQuery=function(t,e){var n=this;Rf(e.path.isEmpty(),"Currently we only support collection group queries at the root.");var r=e.collectionGroup,i=zp();return this.indexManager.getCollectionParents(t,r).next(function(o){return od.forEach(o,function(o){var a=e.asCollectionQueryAtPath(o.child(r));return n.getDocumentsMatchingCollectionQuery(t,a).next(function(t){t.forEach(function(t,e){i=i.insert(t,e)})})}).next(function(){return i})})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(t){var r,i,o,a;try{for(var s=Zr(t),u=s.next();!u.done;u=s.next()){var c=u.value;try{for(var l=Zr(c.mutations),h=l.next();!h.done;h=l.next()){var f=h.value,p=f.key;if(e.path.isImmediateParentOf(p.path)){var d=n.get(p),y=f.applyToLocalView(d,d,c.localWriteTime);n=y instanceof Ad?n.insert(p,y):n.remove(p)}}}catch(t){o={error:t}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t}(),um=function(){function t(){this.refsByKey=new Bp(cm.compareByKey),this.refsByTarget=new Bp(cm.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new cm(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new cm(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=Sp.EMPTY,r=new cm(n,t),i=new cm(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t),o.push(t.key)}),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=Sp.EMPTY,n=new cm(e,t),r=new cm(e,t+1),i=$p();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new cm(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),cm=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return Sp.comparator(t.key,e.key)||ap(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return ap(t.targetOrBatchId,e.targetOrBatchId)||Sp.comparator(t.key,e.key)},t}(),lm=function(){function t(t,e){this.persistence=t,this.localViewReferences=new um,this.queryDataByTarget={},Rf(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new sm(this.remoteDocuments,this.mutationQueue,this.persistence.getIndexManager())}return t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change","readonly",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.mutationQueue=e.persistence.getMutationQueue(t),e.localDocuments=new sm(e.remoteDocuments,e.mutationQueue,e.persistence.getIndexManager()),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){var i,o,a,s,u,c,l,h,f=[],p=[],d=$p();try{for(var y=Zr(r),m=y.next();!m.done;m=y.next()){var g=m.value;f.push(g.batchId);try{for(var v=Zr(g.mutations),b=v.next();!b.done;b=v.next()){var w=b.value;d=d.add(w.key)}}catch(t){a={error:t}}finally{try{b&&!b.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}}}catch(t){i={error:t}}finally{try{m&&!m.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}try{for(var _=Zr(t),T=_.next();!T.done;T=_.next()){g=T.value,p.push(g.batchId);try{for(var E=Zr(g.mutations),S=E.next();!S.done;S=E.next())w=S.value,d=d.add(w.key)}catch(t){l={error:t}}finally{try{S&&!S.done&&(h=E.return)&&h.call(E)}finally{if(l)throw l.error}}}}catch(t){u={error:t}}finally{try{T&&!T.done&&(c=_.return)&&c.call(_)}finally{if(u)throw u.error}}return e.localDocuments.getDocuments(n,d).next(function(t){return{affectedDocuments:t,removedBatchIds:f,addedBatchIds:p}})})})},t.prototype.localWrite=function(t){var e=this,n=Lp.now(),r=t.reduce(function(t,e){return t.add(e.key)},$p());return this.persistence.runTransaction("Locally write mutations","readwrite",function(i){return e.localDocuments.getDocuments(i,r).next(function(r){var o,a,s=[];try{for(var u=Zr(t),c=u.next();!c.done;c=u.next()){var l=c.value,h=l.extractBaseValue(r.get(l.key));null!=h&&s.push(new im(l.key,h,h.fieldMask(),em.exists(!0)))}}catch(a){o={error:a}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}return e.mutationQueue.addMutationBatch(i,n,s,t).next(function(t){var e=t.applyToLocalDocumentSet(r);return{batchId:t.batchId,changes:e}})})})},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return e.mutationQueue.lookupMutationKeys(n,t).next(function(t){return t?e.localDocuments.getDocuments(n,t):od.resolve(null)})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer();return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){return e.applyWriteToRemoteDocuments(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next(function(t){return Rf(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.queryCache.getLastRemoteSnapshotVersion(e)})},t.prototype.applyRemoteEvent=function(e){var n=this,r=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(i){var o=[],a=$p();qf(e.targetChanges,function(r,s){var u=n.queryDataByTarget[r];if(u){s.addedDocuments.forEach(function(t){a=a.add(t)}),s.modifiedDocuments.forEach(function(t){a=a.add(t)}),o.push(n.queryCache.removeMatchingKeys(i,s.removedDocuments,r).next(function(){return n.queryCache.addMatchingKeys(i,s.addedDocuments,r)}));var c=s.resumeToken;if(0<c.length){var l=u;u=u.copy({resumeToken:c,snapshotVersion:e.snapshotVersion}),n.queryDataByTarget[r]=u,t.shouldPersistQueryData(l,u,s)&&o.push(n.queryCache.updateQueryData(i,u))}}});var s=Qp(),u=$p();e.documentUpdates.forEach(function(t,e){u=u.add(t)}),o.push(r.getEntries(i,u).next(function(t){e.documentUpdates.forEach(function(u,c){var l=t.get(u);null==l||c.version.isEqual(Fp.MIN)||a.has(c.key)&&!l.hasPendingWrites||0<=c.version.compareTo(l.version)?(r.addEntry(c),s=s.insert(u,c)):Nf("LocalStore","Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version),e.resolvedLimboDocuments.has(u)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))})}));var c=e.snapshotVersion;if(!c.isEqual(Fp.MIN)){var l=n.queryCache.getLastRemoteSnapshotVersion(i).next(function(t){return Rf(0<=c.compareTo(t),"Watch stream reverted to previous snapshot?? "+c+" < "+t),n.queryCache.setTargetsMetadata(i,i.currentSequenceNumber,c)});o.push(l)}return od.waitFor(o).next(function(){return r.apply(i)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(i,s)})})},t.shouldPersistQueryData=function(t,e,n){return 0!==e.resumeToken.length&&(0===t.resumeToken.length||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||0<n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size)},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return od.forEach(t,function(t){return e.localViewReferences.addReferences(t.addedKeys,t.targetId),e.localViewReferences.removeReferences(t.removedKeys,t.targetId),od.forEach(t.removedKeys,function(t){return e.persistence.referenceDelegate.removeReference(n,t)})})})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query","readwrite",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){return i?(r=i,od.resolve()):e.queryCache.allocateTargetId(n).next(function(i){return r=new fy(t,i,oy.Listen,n.currentSequenceNumber),e.queryCache.addQueryData(n,r)})}).next(function(){return Rf(!e.queryDataByTarget[r.targetId],"Tried to allocate an already allocated query: "+t),e.queryDataByTarget[r.targetId]=r})})},t.prototype.releaseQuery=function(t,e){var n=this,r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release query",r,function(r){return n.queryCache.getQueryData(r,t).next(function(i){Rf(null!=i,"Tried to release nonexistent query: "+t);var o=i.targetId,a=n.queryDataByTarget[o],s=n.localViewReferences.removeReferencesForId(o);return delete n.queryDataByTarget[o],e?od.resolve():od.forEach(s,function(t){return n.persistence.referenceDelegate.removeReference(r,t)}).next(function(){return n.persistence.referenceDelegate.removeTarget(r,a)})})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query","readonly",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=od.resolve();return o.forEach(function(r){a=a.next(function(){return n.getEntry(t,r)}).next(function(t){var o=t,a=e.docVersions.get(r);Rf(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o):Rf(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))})}),a.next(function(){return r.mutationQueue.removeMutationBatch(t,i)})},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.queryDataByTarget)})},t.prototype.getQueryForTarget=function(t){var e=this;return this.queryDataByTarget[t]?Promise.resolve(this.queryDataByTarget[t].query):this.persistence.runTransaction("Get query data","readonly",function(n){return e.queryCache.getQueryDataForTarget(n,t).next(function(t){return t?t.query:null})})},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",function(e){return t.remoteDocuments.getNewDocumentChanges(e)})},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),hm=function(){function t(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=Of(),this.batchesByDocumentKey=new Bp(cm.compareByKey)}return t.prototype.checkEmpty=function(t){return od.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");Rf(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return Rf(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,od.resolve()},t.prototype.getLastStreamToken=function(t){return od.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,od.resolve()},t.prototype.addMutationBatch=function(t,e,n,r){var i,o;Rf(0!==r.length,"Mutation batches should not be empty");var a=this.nextBatchId;this.nextBatchId++,0<this.mutationQueue.length&&Rf(this.mutationQueue[this.mutationQueue.length-1].batchId<a,"Mutation batchIDs must be monotonically increasing order");var s=new rd(a,e,n,r);this.mutationQueue.push(s);try{for(var u=Zr(r),c=u.next();!c.done;c=u.next()){var l=c.value;this.batchesByDocumentKey=this.batchesByDocumentKey.add(new cm(l.key,a)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast())}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}return od.resolve(s)},t.prototype.lookupMutationBatch=function(t,e){return od.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return Rf(null!=n,"Failed to find local mutation batch."),od.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return od.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getAllMutationBatches=function(t){return od.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new cm(e,0),i=new cm(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){Rf(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);Rf(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),od.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Bp(ap);return e.forEach(function(t){var e=new cm(t,0),i=new cm(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],function(e){Rf(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)})}),od.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){Rf(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;Sp.isDocumentKey(i)||(i=i.child(""));var o=new cm(new Sp(i),0),a=new Bp(ap);return this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)},o),od.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Rf(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return od.forEach(e.mutations,function(i){var o=new cm(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)}).next(function(){n.batchesByDocumentKey=r})},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new cm(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return od.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&Rf(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),od.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return Rf(0<=n&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return Rf(n.batchId===t,"If found batch must match"),n},t}(),fm=function(){function t(t){this.persistence=t,this.queries=new Rd(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Fp.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new um,this.targetCount=0,this.targetIdGenerator=pd.forQueryCache()}return t.prototype.getTargetCount=function(t){return od.resolve(this.targetCount)},t.prototype.forEachTarget=function(t,e){return this.queries.forEach(function(t,n){return e(n)}),od.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return od.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return od.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,od.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),od.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addQueryData=function(t,e){return Rf(!this.queries.has(e.query),"Adding a query that already exists"),this.saveQueryData(e),this.targetCount+=1,od.resolve()},t.prototype.updateQueryData=function(t,e){return Rf(this.queries.has(e.query),"Updating a non-existent query"),this.saveQueryData(e),od.resolve()},t.prototype.removeQueryData=function(t,e){return Rf(0<this.targetCount,"Removing a target from an empty cache"),Rf(this.queries.has(e.query),"Removing a non-existent target from the cache"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,od.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.queries.forEach(function(a,s){s.sequenceNumber<=e&&!n[s.targetId]&&(r.queries.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)}),od.waitFor(o).next(function(){return i})},t.prototype.getQueryCount=function(t){return od.resolve(this.targetCount)},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return od.resolve(n)},t.prototype.getQueryDataForTarget=function(t,e){return Df("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.addReference(t,e))}),od.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.removeReference(t,e))}),od.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),od.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return od.resolve(n)},t.prototype.containsKey=function(t,e){return od.resolve(this.references.containsKey(e))},t}(),pm=function(){function t(t,e){this.indexManager=t,this.sizer=e,this.docs=new Up(Sp.comparator),this.newDocumentChanges=$p(),this.size=0}return t.prototype.addEntries=function(t,e,n){var r,i,o=[];try{for(var a=Zr(e),s=a.next();!s.done;s=a.next()){var u=s.value,c=u.maybeDocument.key;this.docs=this.docs.insert(c,u),this.newDocumentChanges=this.newDocumentChanges.add(c),o.push(this.indexManager.addToCollectionParentIndex(t,c.path.popLast()))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return this.size+=n,od.waitFor(o)},t.prototype.removeEntry=function(t,e){var n=this.docs.get(e);return n?(this.docs=this.docs.remove(e),this.size-=n.size,od.resolve(n.size)):od.resolve(0)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return od.resolve(n?n.maybeDocument:null)},t.prototype.getSizedEntry=function(t,e){return od.resolve(this.docs.get(e))},t.prototype.getEntries=function(t,e){var n=this,r=Hp();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)}),od.resolve(r)},t.prototype.getSizedEntries=function(t,e){var n=this,r=Hp(),i=new Up(Sp.comparator);return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null),i=i.insert(t,e?e.size:0)}),od.resolve({maybeDocuments:r,sizeMap:i})},t.prototype.getDocumentsMatchingQuery=function(t,e){Rf(!e.isCollectionGroupQuery(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var n=zp(),r=new Sp(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value.maybeDocument;if(!e.path.isPrefixOf(a.path))break;s instanceof Ad&&e.matches(s)&&(n=n.insert(s.key,s))}return od.resolve(n)},t.prototype.forEachDocumentKey=function(t,e){return od.forEach(this.docs,function(t){return e(t)})},t.prototype.getNewDocumentChanges=function(t){var e=this,n=Qp();return this.newDocumentChanges.forEach(function(t){var r=e.docs.get(t),i=r?r.maybeDocument:new kd(t,Fp.forDeletedDoc());n=n.insert(t,i)}),this.newDocumentChanges=$p(),od.resolve(n)},t.prototype.newChangeBuffer=function(){return new dm(this.sizer,this)},t.prototype.getSize=function(t){return od.resolve(this.size)},t}(),dm=function(t){function e(e,n){var r=t.call(this)||this;return r.sizer=e,r.documentCache=n,r}return Yr(e,t),e.prototype.applyChanges=function(t){var e=this,n=this.assertChanges(),r=0,i=[];return n.forEach(function(t,n){var o=e.documentSizes.get(t);Rf(void 0!==o,"Attempting to change document "+t.toString()+" without having read it first");var a=e.sizer(n);r+=a-o,i.push({maybeDocument:n,size:a})}),this.documentCache.addEntries(t,i,r)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(xd),ym=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new vp(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.queryCache=new fm(this),this.indexManager=new jd,this.remoteDocumentCache=new pm(this.indexManager,function(t){return n.referenceDelegate.documentSize(t)})}return t.createLruPersistence=function(e,n,r){return new t(e,function(t){return new vm(t,new py(n),r)})},t.createEagerPersistence=function(e){return new t(e,function(t){return new gm(t)})},t.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){return[2,[this.clientId]]})})},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(t){},t.prototype.getIndexManager=function(){return this.indexManager},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new hm(this.indexManager,this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;Nf("MemoryPersistence","Starting transaction:",t);var i=new mm(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(t){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return t})}).toPromise()},t.prototype.mutationQueuesContainKey=function(t,e){return od.or((n=this.mutationQueues,r=[],Vf(n,function(t,e){return r.push(e)}),r).map(function(n){return function(){return n.containsKey(t,e)}}));var n,r},t}(),mm=function(t){this.currentSequenceNumber=t},gm=function(){function t(t){this.persistence=t}return t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),od.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),od.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),od.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.orphanedDocuments.add(t)})}).next(function(){return r.removeQueryData(t,e)})},t.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache();return od.forEach(this.orphanedDocuments,function(r){return e.isReferenced(t,r).next(function(e){return e?od.resolve():n.removeEntry(t,r).next(function(){})})})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next(function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)})},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return od.or([function(){return n.persistence.getQueryCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return od.resolve(n.inMemoryPins.containsKey(e))}])},t}(),vm=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.orphanedSequenceNumbers=new Rd(function(t){return xp(t.path)}),this.garbageCollector=new by(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return od.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getQueryCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getQueryCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return od.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(t,r,i).next(function(t){return t?od.resolve():e(i)})})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getQueryCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache();return i.forEachDocumentKey(t,function(o){return n.isPinned(t,o,e).next(function(e){return e?od.resolve():(r++,i.removeEntry(t,o).next())})}).next(function(){return r})},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),od.resolve()},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),od.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),od.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),od.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Df("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return od.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return od.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getQueryCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return od.resolve(void 0!==t&&n<t)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),bm=Number,wm=bm.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),_m=bm.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Tm=bm.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function Em(t){return null==t}function Sm(t){return Tm(t)&&t<=_m&&wm<=t}var Cm,Im,Nm=function(){function t(t,e,n,r,i){this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);0<this.currentBaseMs&&Nf("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return e.lastAttemptTime=Date.now(),t()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}(),Am="PersistentStream";(Im=Cm||(Cm={}))[Im.Initial=0]="Initial",Im[Im.Starting=1]="Starting",Im[Im.Open=2]="Open",Im[Im.Error=3]="Error",Im[Im.Backoff=4]="Backoff";var km,Dm,Rm,xm,Om=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=Cm.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Nm(t,e,1e3,1.5,6e4)}return t.prototype.isStarted=function(){return this.state===Cm.Starting||this.state===Cm.Open||this.state===Cm.Backoff},t.prototype.isOpen=function(){return this.state===Cm.Open},t.prototype.start=function(){this.state!==Cm.Error?(Rf(this.state===Cm.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(Cm.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.inhibitBackoff=function(){Rf(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Cm.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){return this.isOpen()?[2,this.close(Cm.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return Jr(this,void 0,void 0,function(){return $r(this,function(n){switch(n.label){case 0:return Rf(this.isStarted(),"Only started streams should be closed."),Rf(t===Cm.Error||Em(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==Cm.Error?this.backoff.reset():e&&e.code===Pf.RESOURCE_EXHAUSTED?(Af(e.toString()),Af("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===Pf.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;Rf(this.state===Cm.Initial,"Must be in initial state to auth"),this.state=Cm.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(e){t.closeCount===n&&t.startStream(e)},function(n){e(function(){var e=new Mf(Pf.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)})})},t.prototype.startStream=function(t){var e=this;Rf(this.state===Cm.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return Rf(e.state===Cm.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=Cm.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.performBackoff=function(){var t=this;Rf(this.state===Cm.Error,"Should only perform backoff when in Error state"),this.state=Cm.Backoff,this.backoff.backoffAndRun(function(){return Jr(t,void 0,void 0,function(){return $r(this,function(t){return Rf(this.state===Cm.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=Cm.Initial,this.start(),Rf(this.isStarted(),"PersistentStream should have started"),[2]})})})},t.prototype.handleStreamClose=function(t){return Rf(this.isStarted(),"Can't handle server close on non-started stream"),Nf(Am,"close with error: "+t),this.stream=null,this.close(Cm.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget(function(){return e.closeCount===t?n():(Nf(Am,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Pm=function(t){function e(e,n,r,i,o){var a=t.call(this,e,hp.ListenStreamConnectionBackoff,hp.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return Yr(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(Om),Mm=function(t){function e(e,n,r,i,o){var a=t.call(this,e,hp.WriteStreamConnectionBackoff,hp.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a}return Yr(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(Rf(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return Rf(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){Rf(this.isOpen(),"Writing handshake requires an opened stream"),Rf(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;Rf(this.isOpen(),"Writing mutations requires an opened stream"),Rf(this.handshakeComplete_,"Handshake must be complete before writing mutations"),Rf(0<this.lastStreamToken.length,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(Om),Lm=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new Mm(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new Pm(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=Qp();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);Rf(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(t,e,r)}).catch(function(t){throw t.code===Pf.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(t,e,r)}).catch(function(t){throw t.code===Pf.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t}(),Fm=function(){function t(t){this.datastore=t,this.readVersions=Xp(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e;if(t instanceof Ad)e=t.version;else{if(!(t instanceof kd))throw Df("Document in a transaction was a "+t.constructor.name);e=Fp.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Mf(Pf.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new Mf(Pf.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return this.datastore.lookup(t).then(function(t){return t.forEach(function(t){t instanceof kd||t instanceof Ad?e.recordVersion(t):Df("Document in a transaction was a "+t.constructor.name)}),t})},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?em.updateTime(e):em.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.isEqual(Fp.forDeletedDoc()))throw new Mf(Pf.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return e?em.updateTime(e):em.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){try{this.write(e.toMutations(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}},t.prototype.delete=function(t){this.write([new am(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,Fp.forDeletedDoc())},t.prototype.commit=function(){var t=this;if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;var e=this.readVersions;if(this.mutations.forEach(function(t){e=e.remove(t.key)}),!e.isEmpty())throw new Mf(Pf.INVALID_ARGUMENT,"Every document read in a transaction must also be written.");return this.datastore.commit(this.mutations).then(function(){t.committed=!0})},t.prototype.ensureCommitNotCalled=function(){Rf(!this.committed,"A transaction object cannot be used after its update callback has been invoked.")},t}();(Dm=km||(km={}))[Dm.Unknown=0]="Unknown",Dm[Dm.Online=1]="Online",Dm[Dm.Offline=2]="Offline",(xm=Rm||(Rm={}))[xm.RemoteStore=0]="RemoteStore",xm[xm.SharedClientState=1]="SharedClientState";var Um,qm,Vm=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=km.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(km.Unknown),Rf(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(hp.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,Rf(t.state===km.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(km.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===km.Online?(this.setAndBroadcast(km.Unknown),Rf(0===this.watchStreamFailures,"watchStreamFailures must be 0"),Rf(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,1<=this.watchStreamFailures&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(km.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===km.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(Af(e),this.shouldWarnClientIsOffline=!1):Nf("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}();function jm(t){switch(t){case Pf.OK:return Df("Treated status OK as error");case Pf.CANCELLED:case Pf.UNKNOWN:case Pf.DEADLINE_EXCEEDED:case Pf.RESOURCE_EXHAUSTED:case Pf.INTERNAL:case Pf.UNAVAILABLE:case Pf.UNAUTHENTICATED:return!1;case Pf.INVALID_ARGUMENT:case Pf.NOT_FOUND:case Pf.ALREADY_EXISTS:case Pf.PERMISSION_DENIED:case Pf.FAILED_PRECONDITION:case Pf.ABORTED:case Pf.OUT_OF_RANGE:case Pf.UNIMPLEMENTED:case Pf.DATA_LOSS:return!0;default:return Df("Unknown status code: "+t)}}function Bm(t){if(void 0===t)return Af("GRPC error has no .code"),Pf.UNKNOWN;switch(t){case Um.OK:return Pf.OK;case Um.CANCELLED:return Pf.CANCELLED;case Um.UNKNOWN:return Pf.UNKNOWN;case Um.DEADLINE_EXCEEDED:return Pf.DEADLINE_EXCEEDED;case Um.RESOURCE_EXHAUSTED:return Pf.RESOURCE_EXHAUSTED;case Um.INTERNAL:return Pf.INTERNAL;case Um.UNAVAILABLE:return Pf.UNAVAILABLE;case Um.UNAUTHENTICATED:return Pf.UNAUTHENTICATED;case Um.INVALID_ARGUMENT:return Pf.INVALID_ARGUMENT;case Um.NOT_FOUND:return Pf.NOT_FOUND;case Um.ALREADY_EXISTS:return Pf.ALREADY_EXISTS;case Um.PERMISSION_DENIED:return Pf.PERMISSION_DENIED;case Um.FAILED_PRECONDITION:return Pf.FAILED_PRECONDITION;case Um.ABORTED:return Pf.ABORTED;case Um.OUT_OF_RANGE:return Pf.OUT_OF_RANGE;case Um.UNIMPLEMENTED:return Pf.UNIMPLEMENTED;case Um.DATA_LOSS:return Pf.DATA_LOSS;default:return Df("Unknown status code: "+t)}}(qm=Um||(Um={}))[qm.OK=0]="OK",qm[qm.CANCELLED=1]="CANCELLED",qm[qm.UNKNOWN=2]="UNKNOWN",qm[qm.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qm[qm.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qm[qm.NOT_FOUND=5]="NOT_FOUND",qm[qm.ALREADY_EXISTS=6]="ALREADY_EXISTS",qm[qm.PERMISSION_DENIED=7]="PERMISSION_DENIED",qm[qm.UNAUTHENTICATED=16]="UNAUTHENTICATED",qm[qm.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qm[qm.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qm[qm.ABORTED=10]="ABORTED",qm[qm.OUT_OF_RANGE=11]="OUT_OF_RANGE",qm[qm.UNIMPLEMENTED=12]="UNIMPLEMENTED",qm[qm.INTERNAL=13]="INTERNAL",qm[qm.UNAVAILABLE=14]="UNAVAILABLE",qm[qm.DATA_LOSS=15]="DATA_LOSS";var Wm,Km,Qm,Hm,Gm=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Sp.comparator(e.key,n.key)}:function(t,e){return Sp.comparator(t.key,e.key)},this.keyedMap=zp(),this.sortedSet=new Up(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();(Km=Wm||(Wm={}))[Km.Added=0]="Added",Km[Km.Removed=1]="Removed",Km[Km.Modified=2]="Modified",Km[Km.Metadata=3]="Metadata",(Hm=Qm||(Qm={}))[Hm.Local=0]="Local",Hm[Hm.Synced=1]="Synced";var zm,Ym,Xm=function(){function t(){this.changeMap=new Up(Sp.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Wm.Added&&n.type===Wm.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Wm.Metadata&&n.type!==Wm.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Wm.Modified&&n.type===Wm.Modified?this.changeMap=this.changeMap.insert(e,{type:Wm.Modified,doc:t.doc}):t.type===Wm.Modified&&n.type===Wm.Added?this.changeMap=this.changeMap.insert(e,{type:Wm.Added,doc:t.doc}):t.type===Wm.Removed&&n.type===Wm.Added?this.changeMap=this.changeMap.remove(e):t.type===Wm.Removed&&n.type===Wm.Modified?this.changeMap=this.changeMap.insert(e,{type:Wm.Removed,doc:n.doc}):t.type===Wm.Added&&n.type===Wm.Removed?this.changeMap=this.changeMap.insert(e,{type:Wm.Modified,doc:t.doc}):Df("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Jm=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:Wm.Added,doc:t})}),new t(e,n,Gm.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),$m=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=Zm.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(Fp.MIN,i,td(),Qp(),$p())},t}(),Zm=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Of(),n,$p(),$p(),$p())},t}(),tg=function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r},eg=function(t,e){this.targetId=t,this.existenceFilter=e};(Ym=zm||(zm={}))[Ym.NoChange=0]="NoChange",Ym[Ym.Added=1]="Added",Ym[Ym.Removed=2]="Removed",Ym[Ym.Current=3]="Current",Ym[Ym.Reset=4]="Reset";var ng=function(t,e,n,r){void 0===n&&(n=Of()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},rg=function(){function t(){this.pendingResponses=0,this.documentChanges=ag(),this._resumeToken=Of(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){0<t.length&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=$p(),e=$p(),n=$p();return this.documentChanges.forEach(function(r,i){switch(i){case Wm.Added:t=t.add(r);break;case Wm.Modified:e=e.add(r);break;case Wm.Removed:n=n.add(r);break;default:Df("Encountered invalid change type: "+i)}}),new Zm(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=ag()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),ig=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Qp(),this.pendingDocumentTargetMapping=og(),this.pendingTargetResets=new Bp(ap)}return t.prototype.handleDocumentChange=function(t){var e,n,r,i;try{for(var o=Zr(t.updatedTargetIds),a=o.next();!a.done;a=o.next()){var s=a.value;t.newDoc instanceof Ad?this.addDocumentToTarget(s,t.newDoc):t.newDoc instanceof kd&&this.removeDocumentFromTarget(s,t.key,t.newDoc)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}try{for(var u=Zr(t.removedTargetIds),c=u.next();!c.done;c=u.next())s=c.value,this.removeDocumentFromTarget(s,t.key,t.newDoc)}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.ensureTargetState(n);switch(t.state){case zm.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case zm.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case zm.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),Rf(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case zm.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case zm.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:Df("Unknown target watch change state: "+t.state)}})},t.prototype.forEachTarget=function(t,e){0<t.targetIds.length?t.targetIds.forEach(e):qf(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.queryDataForActiveTarget(e);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new Sp(i.path);this.removeDocumentFromTarget(e,o,new kd(o,Fp.forDeletedDoc()))}else Rf(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};qf(this.targetStates,function(r,i){var o=e.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var a=new Sp(o.query.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new kd(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=$p();this.pendingDocumentTargetMapping.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.queryDataForActiveTarget(t);return!n||n.purpose===oy.LimboResolution||(i=!1)}),i&&(r=r.add(t))});var i=new $m(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Qp(),this.pendingDocumentTargetMapping=og(),this.pendingTargetResets=new Bp(ap),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?Wm.Modified:Wm.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,Wm.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new rg),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new Bp(ap),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){return null!==this.queryDataForActiveTarget(t)},t.prototype.queryDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getQueryDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;Rf(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new rg,this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(n){e.removeDocumentFromTarget(t,n,null)})},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function og(){return new Up(Sp.comparator)}function ag(){return new Up(Sp.comparator)}var sg="RemoteStore",ug=function(){function t(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.connectivityMonitor=i,this.connectivityMonitor.addCallback(function(t){n.enqueueAndForget(function(){return Jr(o,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(Nf(sg,"Restarting streams for network reachability change."),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.onlineStateTracker=new Vm(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return Jr(this,void 0,void 0,function(){var t;return $r(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(km.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(km.Offline),[2]}})})},t.prototype.disableNetworkInternal=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),0<this.writePipeline.length&&(Nf(sg,"Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},t.prototype.shutdown=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return Nf(sg,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.connectivityMonitor.shutdown(),this.onlineStateTracker.set(km.Unknown),[2]}})})},t.prototype.listen=function(t){Rf(!Ff(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){Rf(Ff(this.listenTargets,t),"unlisten called without assigned target ID!"),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),jf(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(km.Unknown))},t.prototype.getQueryDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){Rf(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new ig(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!jf(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return Jr(this,void 0,void 0,function(){var t=this;return $r(this,function(e){return qf(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return Jr(this,void 0,void 0,function(){return $r(this,function(e){return void 0===t&&Rf(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(km.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return Jr(this,void 0,void 0,function(){var n;return $r(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(km.Online),t instanceof ng&&t.state===zm.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof tg?this.watchChangeAggregator.handleDocumentChange(t):t instanceof eg?this.watchChangeAggregator.handleExistenceFilter(t):(Rf(t instanceof ng,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(Fp.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),0<=e.compareTo(n)?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.raiseWatchSnapshot=function(t){var e=this;Rf(!t.isEqual(Fp.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return qf(n.targetChanges,function(n,r){if(0<r.resumeToken.length){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.copy({resumeToken:r.resumeToken,snapshotVersion:t}))}}),n.targetMismatches.forEach(function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.copy({resumeToken:Of()}),e.sendUnwatchRequest(t);var r=new fy(n.query,t,oy.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;Rf(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return Jr(e,void 0,void 0,function(){return $r(this,function(e){return Ff(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.fillWritePipeline=function(){return Jr(this,void 0,void 0,function(){var t,e;return $r(this,function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=0<this.writePipeline.length?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){Rf(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&0<this.writePipeline.length},t.prototype.startWriteStream=function(){Rf(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){var e,n;try{for(var r=Zr(t.writePipeline),i=r.next();!i.done;i=r.next()){var o=i.value;t.writeStream.writeMutations(o.mutations)}}catch(n){e={error:n}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}).catch(Cy)},t.prototype.onMutationResult=function(t,e){var n=this;Rf(0<this.writePipeline.length,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=id.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return Jr(this,void 0,void 0,function(){var e=this;return $r(this,function(n){return void 0===t&&Rf(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&0<this.writePipeline.length?[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})]:[2]})})},t.prototype.handleHandshakeError=function(t){return Jr(this,void 0,void 0,function(){return $r(this,function(e){return jm(t.code)?(Nf(sg,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=Of(),[2,this.localStore.setLastStreamToken(Of()).catch(Cy)]):[2]})})},t.prototype.handleWriteError=function(t){return Jr(this,void 0,void 0,function(){var e,n=this;return $r(this,function(r){return jm(i=t.code)&&i!==Pf.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2];var i})})},t.prototype.createTransaction=function(){return new Fm(this.datastore)},t.prototype.restartNetwork=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(km.Unknown),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.handleCredentialChange=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(Nf(sg,"RemoteStore restarting streams for new credential"),[4,this.restartNetwork()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.applyPrimaryState=function(t){return Jr(this,void 0,void 0,function(){return $r(this,function(e){switch(e.label){case 0:return(this.isPrimary=t)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(km.Unknown),e.label=4;case 4:return[2]}})})},t}(),cg=function(){function t(t,e){if(Wf("GeoPoint",arguments,2),Hf("GeoPoint","number",1,t),Hf("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Mf(Pf.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Mf(Pf.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return ap(this._lat,t._lat)||ap(this._long,t._long)},t}(),lg=function(){function t(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){var t,e;if(null===this.memoizedOrderBy){var n=this.getInequalityFilterField(),r=this.getFirstOrderByField();if(null!==n&&null===r)n.isKeyField()?this.memoizedOrderBy=[_g]:this.memoizedOrderBy=[new wg(n),_g];else{Rf(null===n||null!==r&&n.isEqual(r),"First orderBy should match inequality field.");var i=!(this.memoizedOrderBy=[]);try{for(var o=Zr(this.explicitOrderBy),a=o.next();!a.done;a=o.next()){var s=a.value;this.memoizedOrderBy.push(s),s.field.isKeyField()&&(i=!0)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}if(!i){var u=0<this.explicitOrderBy.length?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:vg.ASCENDING;this.memoizedOrderBy.push(u===vg.ASCENDING?_g:Tg)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){Rf(null==this.getInequalityFilterField()||!(e instanceof fg)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),Rf(!this.isDocumentQuery(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){Rf(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.collectionGroup,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.asCollectionQueryAtPath=function(e){return new t(e,null,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.canonicalId=function(){var t,e,n,r;if(null===this.memoizedCanonicalId){var i=this.path.canonicalString();this.isCollectionGroupQuery()&&(i+="|cg:"+this.collectionGroup),i+="|f:";try{for(var o=Zr(this.filters),a=o.next();!a.done;a=o.next())i+=a.value.canonicalId(),i+=","}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}i+="|ob:";try{for(var s=Zr(this.orderBy),u=s.next();!u.done;u=s.next())i+=u.value.canonicalId(),i+=","}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}Em(this.limit)||(i+="|l:",i+=this.limit),this.startAt&&(i+="|lb:",i+=this.startAt.canonicalId()),this.endAt&&(i+="|ub:",i+=this.endAt.canonicalId()),this.memoizedCanonicalId=i}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.isCollectionGroupQuery()&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Em(this.limit)||(t+=", limit: "+this.limit),0<this.explicitOrderBy.length&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.docComparator=function(t,e){var n,r,i=!1;try{for(var o=Zr(this.orderBy),a=o.next();!a.done;a=o.next()){var s=a.value,u=s.compare(t,e);if(0!==u)return u;i=i||s.field.isKeyField()}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return Rf(i,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesPathAndCollectionGroup(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!Em(this.limit)},t.prototype.getFirstOrderByField=function(){return 0<this.explicitOrderBy.length?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){var t,e;try{for(var n=Zr(this.filters),r=n.next();!r.done;r=n.next()){var i=r.value;if(i instanceof fg&&i.isInequality())return i.field}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t.prototype.findFilterOperator=function(t){var e,n;try{for(var r=Zr(this.filters),i=r.next();!i.done;i=r.next()){var o=i.value;if(o instanceof fg&&0<=t.indexOf(o.op))return o.op}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null},t.prototype.isDocumentQuery=function(){return Sp.isDocumentKey(this.path)&&null===this.collectionGroup&&0===this.filters.length},t.prototype.isCollectionGroupQuery=function(){return null!==this.collectionGroup},t.prototype.matchesPathAndCollectionGroup=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.hasCollectionId(this.collectionGroup)&&this.path.isPrefixOf(e):Sp.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isImmediateParentOf(e)},t.prototype.matchesOrderBy=function(t){var e,n;try{for(var r=Zr(this.explicitOrderBy),i=r.next();!i.done;i=r.next()){var o=i.value;if(!o.field.isKeyField()&&null===t.field(o.field))return!1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!0},t.prototype.matchesFilters=function(t){var e,n;try{for(var r=Zr(this.filters),i=r.next();!i.done;i=r.next())if(!i.value.matches(t))return!1}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){Rf(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),hg=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return Df("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),fg=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return Yr(e,t),e.create=function(t,n,r){if(t.isKeyField())return n===hg.IN?(Rf(r instanceof Jy,"Comparing on key with IN, but filter value not an ArrayValue"),Rf(r.internalValue.every(function(t){return t instanceof zy}),"Comparing on key with IN, but an array value was not a RefValue"),new dg(t,r)):(Rf(r instanceof zy,"Comparing on key, but filter value not a RefValue"),Rf(n!==hg.ARRAY_CONTAINS&&n!==hg.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new pg(t,n,r));if(r.isEqual(Ly.INSTANCE)){if(n!==hg.EQUAL)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new e(t,n,r)}if(r.isEqual(Wy.NAN)){if(n!==hg.EQUAL)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new e(t,n,r)}return n===hg.ARRAY_CONTAINS?new yg(t,r):n===hg.IN?(Rf(r instanceof Jy,"IN filter has invalid value: "+r.toString()),new mg(t,r)):n===hg.ARRAY_CONTAINS_ANY?(Rf(r instanceof Jy,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new gg(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case hg.LESS_THAN:return t<0;case hg.LESS_THAN_OR_EQUAL:return t<=0;case hg.EQUAL:return 0===t;case hg.GREATER_THAN:return 0<t;case hg.GREATER_THAN_OR_EQUAL:return 0<=t;default:return Df("Unknown FieldFilter operator: "+this.op)}},e.prototype.isInequality=function(){return 0<=[hg.LESS_THAN,hg.LESS_THAN_OR_EQUAL,hg.GREATER_THAN,hg.GREATER_THAN_OR_EQUAL].indexOf(this.op)},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value)},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(function(){}),pg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.prototype.matches=function(t){var e=this.value,n=Sp.comparator(t.key,e.key);return this.matchesComparison(n)},e}(fg),dg=function(t){function e(e,n){var r=t.call(this,e,hg.IN,n)||this;return r.value=n,r}return Yr(e,t),e.prototype.matches=function(t){return this.value.internalValue.some(function(e){return t.key.isEqual(e.key)})},e}(fg),yg=function(t){function e(e,n){return t.call(this,e,hg.ARRAY_CONTAINS,n)||this}return Yr(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof Jy&&e.contains(this.value)},e}(fg),mg=function(t){function e(e,n){var r=t.call(this,e,hg.IN,n)||this;return r.value=n,r}return Yr(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},e}(fg),gg=function(t){function e(e,n){var r=t.call(this,e,hg.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return Yr(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof Jy&&n.internalValue.some(function(t){return e.value.contains(t)})},e}(fg),vg=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),bg=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){var t,e,n=this.before?"b:":"a:";try{for(var r=Zr(this.position),i=r.next();!i.done;i=r.next())n+=i.value.toString()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.sortsBeforeDocument=function(t,e){Rf(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())Rf(o instanceof zy,"Bound has a non-key value where the key path is being used."),n=Sp.comparator(o.key,e.key);else{var a=e.field(i.field);Rf(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===vg.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},t}(),wg=function(){function t(t,e){this.field=t,void 0===e&&(e=vg.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?Ad.compareByKey(t,e):Ad.compareByField(this.field,t,e);switch(this.dir){case vg.ASCENDING:return n;case vg.DESCENDING:return-1*n;default:return Df("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),_g=new wg(Ep.keyField(),vg.ASCENDING),Tg=new wg(Ep.keyField(),vg.DESCENDING),Eg=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new Hy(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),Sg=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){var e,n,r=Ng(t),i=function(t){r.find(function(e){return e.isEqual(t)})||r.push(t)};try{for(var o=Zr(this.elements),a=o.next();!a.done;a=o.next())i(a.value)}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return new Jy(r)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&sp(e.elements,this.elements)},t}(),Cg=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){var e,n,r=Ng(t),i=function(t){r=r.filter(function(e){return!e.isEqual(t)})};try{for(var o=Zr(this.elements),a=o.next();!a.done;a=o.next())i(a.value)}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return new Jy(r)},t.prototype.computeBaseValue=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&sp(e.elements,this.elements)},t}(),Ig=function(){function t(t){this.operand=t}return t.prototype.applyToLocalView=function(t,e){var n=this.computeBaseValue(t);if(n instanceof By&&this.operand instanceof By){var r=n.internalValue+this.operand.internalValue;return new By(r)}return r=n.internalValue+this.operand.internalValue,new Wy(r)},t.prototype.applyToRemoteDocument=function(t,e){return Rf(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.computeBaseValue=function(t){return t instanceof Uy?t:new By(0)},t.prototype.isEqual=function(e){return e instanceof t&&this.operand.isEqual(e.operand)},t}();function Ng(t){return t instanceof Jy?t.internalValue.slice():[]}var Ag,kg,Dg=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}(),Rg=((Ag={})[vg.ASCENDING.name]="ASCENDING",Ag[vg.DESCENDING.name]="DESCENDING",Ag),xg=((kg={})[hg.LESS_THAN.name]="LESS_THAN",kg[hg.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",kg[hg.GREATER_THAN.name]="GREATER_THAN",kg[hg.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",kg[hg.EQUAL.name]="EQUAL",kg[hg.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",kg[hg.IN.name]="IN",kg[hg.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",kg),Og=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pg(t,e){Rf(!Em(t),e+" is missing")}function Mg(t){return"number"==typeof t?t:"string"==typeof t?Number(t):Df("can't parse "+t)}var Lg=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?Pf.UNKNOWN:Bm(t.code);return new Mf(e,t.message||"")},t.prototype.toInt32Value=function(t){return Em(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return Em(e="object"==typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);Rf(!!t,"Cannot deserialize null or undefined timestamp.");var e=Mg(t.seconds||"0"),n=t.nanos||0;return new Lp(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=Og.exec(t);if(Rf(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new Lp(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(Rf(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),pp.fromBase64String(t)):(Rf(!this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),pp.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return Rf(!!t,"Trying to deserialize version that isn't set"),Fp.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=_p.fromString(t);return Rf(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return Rf(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),Rf(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new Sp(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?_p.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new _p(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new _p(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return Rf(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Ly)return{nullValue:"NULL_VALUE"};if(t instanceof Fy)return{booleanValue:t.value()};if(t instanceof By)return{integerValue:""+t.value()};if(t instanceof Wy){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Ky?{stringValue:t.value()}:t instanceof Xy?{mapValue:this.toMapValue(t)}:t instanceof Jy?{arrayValue:this.toArrayValue(t)}:t instanceof Qy?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Yy?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Gy?{bytesValue:this.toBytes(t.value())}:t instanceof zy?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:Df("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this;if("nullValue"in t)return Ly.INSTANCE;if("booleanValue"in t)return Fy.of(t.booleanValue);if("integerValue"in t)return new By(Mg(t.integerValue));if("doubleValue"in t){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Wy.NAN;if("Infinity"===t.doubleValue)return Wy.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Wy.NEGATIVE_INFINITY}return new Wy(t.doubleValue)}if("stringValue"in t)return new Ky(t.stringValue);if("mapValue"in t)return this.fromFields(t.mapValue.fields||{});if("arrayValue"in t){Pg(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new Jy(n.map(function(t){return e.fromValue(t)}))}if("timestampValue"in t)return Pg(t.timestampValue,"timestampValue"),new Qy(this.fromTimestamp(t.timestampValue));if("geoPointValue"in t){Pg(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new Yy(new cg(r,i))}if("bytesValue"in t){Pg(t.bytesValue,"bytesValue");var o=this.fromBlob(t.bytesValue);return new Gy(o)}if("referenceValue"in t){Pg(t.referenceValue,"referenceValue");var a=this.fromResourceName(t.referenceValue),s=new gp(a.get(1),a.get(3)),u=new Sp(this.extractLocalPathFromResourceName(a));return new zy(s,u)}return Df("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return Rf(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){return new Ad(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasCommittedMutations:!!e})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=Xy.EMPTY;return Vf(n,function(t,n){r=r.set(new Ep([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){Rf(!!t.found,"Tried to deserialize a found document from a missing document."),Pg(t.found.name,"doc.found.name"),Pg(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new Ad(e,n,r,{},t.found)},t.prototype.fromMissing=function(t){Rf(!!t.missing,"Tried to deserialize a missing document from a found document."),Rf(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new kd(e,n)},t.prototype.fromMaybeDocument=function(t){return"found"in t?this.fromFound(t):"missing"in t?this.fromMissing(t):Df("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case zm.Added:return"ADD";case zm.Current:return"CURRENT";case zm.NoChange:return"NO_CHANGE";case zm.Removed:return"REMOVE";case zm.Reset:return"RESET";default:return Df("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof eg)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof tg){if(t.newDoc instanceof Ad){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof kd)return e=t.newDoc,{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}};if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof ng){var n=void 0;return t.cause&&(n={code:function(t){if(void 0===t)return Um.OK;switch(t){case Pf.OK:return Um.OK;case Pf.CANCELLED:return Um.CANCELLED;case Pf.UNKNOWN:return Um.UNKNOWN;case Pf.DEADLINE_EXCEEDED:return Um.DEADLINE_EXCEEDED;case Pf.RESOURCE_EXHAUSTED:return Um.RESOURCE_EXHAUSTED;case Pf.INTERNAL:return Um.INTERNAL;case Pf.UNAVAILABLE:return Um.UNAVAILABLE;case Pf.UNAUTHENTICATED:return Um.UNAUTHENTICATED;case Pf.INVALID_ARGUMENT:return Um.INVALID_ARGUMENT;case Pf.NOT_FOUND:return Um.NOT_FOUND;case Pf.ALREADY_EXISTS:return Um.ALREADY_EXISTS;case Pf.PERMISSION_DENIED:return Um.PERMISSION_DENIED;case Pf.FAILED_PRECONDITION:return Um.FAILED_PRECONDITION;case Pf.ABORTED:return Um.ABORTED;case Pf.OUT_OF_RANGE:return Um.OUT_OF_RANGE;case Pf.UNIMPLEMENTED:return Um.UNIMPLEMENTED;case Pf.DATA_LOSS:return Um.DATA_LOSS;default:return Df("Unknown status code: "+t)}}(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return Df("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e;if("targetChange"in t){Pg(t.targetChange,"targetChange");var n=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=t.targetChange.resumeToken||this.emptyByteString(),o=t.targetChange.cause,a=o&&this.fromRpcStatus(o);e=new ng(n,r,i,a||null)}else if("documentChange"in t){Pg(t.documentChange,"documentChange"),Pg(t.documentChange.document,"documentChange.name"),Pg(t.documentChange.document.name,"documentChange.document.name"),Pg(t.documentChange.document.updateTime,"documentChange.document.updateTime");var s=t.documentChange,u=this.fromName(s.document.name),c=this.fromVersion(s.document.updateTime),l=this.fromFields(s.document.fields||{}),h=new Ad(u,c,l,{},s.document),f=s.targetIds||[],p=s.removedTargetIds||[];e=new tg(f,p,h.key,h)}else if("documentDelete"in t){Pg(t.documentDelete,"documentDelete"),Pg(t.documentDelete.document,"documentDelete.document");var d=t.documentDelete;u=this.fromName(d.document),c=d.readTime?this.fromVersion(d.readTime):Fp.forDeletedDoc(),h=new kd(u,c),p=d.removedTargetIds||[],e=new tg([],p,h.key,h)}else if("documentRemove"in t){Pg(t.documentRemove,"documentRemove"),Pg(t.documentRemove.document,"documentRemove");var y=t.documentRemove;u=this.fromName(y.document),p=y.removedTargetIds||[],e=new tg([],p,u,null)}else{if(!("filter"in t))return Df("Unknown change type "+JSON.stringify(t));Pg(t.filter,"filter"),Pg(t.filter.targetId,"filter.targetId");var m=t.filter,g=m.count||0,v=new Dg(g),b=m.targetId;e=new eg(b,v)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?zm.NoChange:"ADD"===t?zm.Added:"REMOVE"===t?zm.Removed:"CURRENT"===t?zm.Current:"RESET"===t?zm.Reset:Df("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!("targetChange"in t))return Fp.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Fp.MIN:e.readTime?this.fromVersion(e.readTime):Fp.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof rm)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof am)e={delete:this.toName(t.key)};else if(t instanceof im)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof om))return Df("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):em.NONE;if(t.update){Pg(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new im(r,i,o,n)}return new rm(r,i,n)}if(t.delete)return r=this.fromName(t.delete),new am(r,n);if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return Rf(!0===n.exists,'Transforms only support precondition "exists == true"'),new om(r,a)}return Df("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return Rf(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Df("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?em.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?em.exists(t.exists):em.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e),i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults.map(function(t){return n.fromValue(t)})),new tm(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&0<t.length?(Rf(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.fromWriteResult(t,e)})):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof Eg)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Sg)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof Cg)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof Ig)return{fieldPath:t.field.canonicalString(),increment:this.toValue(n.operand)};throw Df("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=null;if("setToServerValue"in t)Rf("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=Eg.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Sg(r.map(function(t){return e.fromValue(t)}))}else if("removeAllFromArray"in t)r=t.removeAllFromArray.values||[],n=new Cg(r.map(function(t){return e.fromValue(t)}));else if("increment"in t){var i=this.fromValue(t.increment);Rf(i instanceof Uy,"NUMERIC_ADD transform requires a NumberValue"),n=new Ig(i)}else Df("Unknown transform proto: "+JSON.stringify(t));var o=Ep.fromServerFormat(t.fieldPath);return new Zy(o,n)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;Rf(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return lg.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(Rf(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.toQueryPath(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(Rf(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]);var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){Rf(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=this.fromFilter(n.where));var s=[];n.orderBy&&(s=this.fromOrder(n.orderBy));var u=null;n.limit&&(u=this.fromInt32Value(n.limit));var c=null;n.startAt&&(c=this.fromCursor(n.startAt));var l=null;return n.endAt&&(l=this.fromCursor(n.endAt)),new lg(e,i,s,a,u,c,l)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case oy.Listen:return null;case oy.ExistenceFilterMismatch:return"existence-filter-mismatch";case oy.LimboResolution:return"limbo-document";default:return Df("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,0<t.resumeToken.length&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof fg?e.toUnaryOrFieldFilter(t):Df("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromFieldFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):Df("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new bg(r,n)},t.prototype.toDirection=function(t){return Rg[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return vg.ASCENDING;case"DESCENDING":return vg.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return xg[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return hg.EQUAL;case"GREATER_THAN":return hg.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return hg.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return hg.LESS_THAN;case"LESS_THAN_OR_EQUAL":return hg.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return hg.ARRAY_CONTAINS;case"IN":return hg.IN;case"ARRAY_CONTAINS_ANY":return hg.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return Df("Unspecified operator");default:return Df("Unknown operator")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return Ep.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new wg(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.fromFieldFilter=function(t){return fg.create(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryOrFieldFilter=function(t){if(t.op===hg.EQUAL){if(t.value.isEqual(Wy.NAN))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}};if(t.value.isEqual(Ly.INSTANCE))return{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return fg.create(e,hg.EQUAL,Wy.NAN);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return fg.create(n,hg.EQUAL,Ly.INSTANCE);case"OPERATOR_UNSPECIFIED":return Df("Unspecified filter");default:return Df("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return Ep.fromServerFormat(t)});return $y.fromArray(e)},t}(),Fg=function(){this.listeners=[]},Ug=function(){function t(t){this.syncEngine=t,this.queries=new Rd(function(t){return t.canonicalId()}),this.onlineState=km.Unknown,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new Fg,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return Jr(this,void 0,void 0,function(){var e,n,r,i;return $r(this,function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&0<=(i=r.listeners.indexOf(t))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onWatchChange=function(t){var e,n,r,i;try{for(var o=Zr(t),a=o.next();!a.done;a=o.next()){var s=a.value,u=s.query,c=this.queries.get(u);if(c){try{for(var l=Zr(c.listeners),h=l.next();!h.done;h=l.next())h.value.onViewSnapshot(s)}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}c.viewSnap=s}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},t.prototype.onWatchError=function(t,e){var n,r,i=this.queries.get(t);if(i)try{for(var o=Zr(i.listeners),a=o.next();!a.done;a=o.next())a.value.onError(e)}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){var r,i;try{for(var o=Zr(n.listeners),a=o.next();!a.done;a=o.next())a.value.applyOnlineStateChange(t)}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}})},t}(),qg=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=km.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){var e,n;if(Rf(0<t.docChanges.length||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){var r=[];try{for(var i=Zr(t.docChanges),o=i.next();!o.done;o=i.next()){var a=o.value;a.type!==Wm.Metadata&&r.push(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}t=new Jm(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(Rf(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==km.Offline;return this.options.waitForSyncWhenOnline&&n?(Rf(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===km.Offline},t.prototype.shouldRaiseEvent=function(t){if(0<t.docChanges.length)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){Rf(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=Jm.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),Vg=function(){function t(t,e,n){this.targetId=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e,n){var r,i,o=$p(),a=$p();try{for(var s=Zr(n.docChanges),u=s.next();!u.done;u=s.next()){var c=u.value;switch(c.type){case Wm.Added:o=o.add(c.doc.key);break;case Wm.Removed:a=a.add(c.doc.key)}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return new t(e,o,a)},t}(),jg=function(t){this.key=t},Bg=function(t){this.key=t},Wg=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=$p(),this.mutatedKeys=$p(),this.documentSet=new Gm(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Xm,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var c=i.get(t),l=e instanceof Ad?e:null;l&&(Rf(t.isEqual(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null);var h=!!c&&n.mutatedKeys.has(c.key),f=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;c&&l?c.data.isEqual(l.data)?h!==f&&(r.track({type:Wm.Metadata,doc:l}),p=!0):n.shouldWaitForSyncedDocument(c,l)||(r.track({type:Wm.Modified,doc:l}),p=!0,u&&0<n.query.docComparator(l,u)&&(s=!0)):!c&&l?(r.track({type:Wm.Added,doc:l}),p=!0):c&&!l&&(r.track({type:Wm.Removed,doc:c}),p=!0,u&&(s=!0)),p&&(o=l?(a=a.add(l),f?o.add(t):o.delete(t)):(a=a.delete(t),o.delete(t)))}),this.query.hasLimit())for(;a.size>this.query.limit;){var c=a.last();a=a.delete(c.key),o=o.delete(c.key),r.track({type:Wm.Removed,doc:c})}return Rf(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;Rf(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort(function(t,e){return n=t.type,i=e.type,(o=function(t){switch(t){case Wm.Added:return 1;case Wm.Modified:case Wm.Metadata:return 2;case Wm.Removed:return 0;default:return Df("Unknown ChangeType: "+t)}})(n)-o(i)||r.query.docComparator(t.doc,e.doc);var n,i,o}),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?Qm.Synced:Qm.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new Jm(this.query,t.documentSet,i,o,t.mutatedKeys,s===Qm.Local,u,!1),limboChanges:a}:{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===km.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Xm,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.add(t)}),t.modifiedDocuments.forEach(function(t){return Rf(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")}),t.removedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)}),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=$p(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new Bg(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new jg(t))}),n},t.prototype.synchronizeWithPersistedState=function(t,e){this._syncedDocuments=e,this.limboDocuments=$p();var n=this.computeDocChanges(t);return this.applyChanges(n,!0)},t.prototype.computeInitialSnapshot=function(){return Jm.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===Qm.Local)},t}(),Kg="SyncEngine",Qg=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Hg=function(t){this.key=t},Gg=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Rd(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new Up(Sp.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new um,this.mutationUserCallbacks={},this.limboTargetIdGenerator=pd.forSyncEngine(),this.isPrimary=void 0,this.onlineState=km.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){Rf(null!==t,"SyncEngine listener cannot be null"),Rf(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return Jr(this,void 0,void 0,function(){var e,n,r,i,o;return $r(this,function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(t)];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}})})},t.prototype.initializeViewAndComputeSnapshot=function(t,e){var n=this,r=t.query;return this.localStore.executeQuery(r).then(function(i){return n.localStore.remoteDocumentKeys(t.targetId).then(function(o){var a=new Wg(r,o),s=a.computeDocChanges(i),u=Zm.createSynthesizedTargetChangeForCurrentChange(t.targetId,e&&n.onlineState!==km.Offline),c=a.applyChanges(s,!0===n.isPrimary,u);Rf(0===c.limboChanges.length,"View returned limbo docs before target ack from the server."),Rf(!!c.snapshot,"applyChanges for new view should always return a snapshot");var l=new Qg(r,t.targetId,a);return n.queryViewsByQuery.set(r,l),n.queryViewsByTarget[t.targetId]=l,c.snapshot})})},t.prototype.synchronizeViewAndComputeSnapshot=function(t){var e=this;return this.localStore.executeQuery(t.query).then(function(n){return e.localStore.remoteDocumentKeys(t.targetId).then(function(r){return Jr(e,void 0,void 0,function(){var e;return $r(this,function(i){return e=t.view.synchronizeWithPersistedState(n,r),this.isPrimary&&this.updateTrackedLimbos(t.targetId,e.limboChanges),[2,e]})})})})},t.prototype.unlisten=function(t){return Jr(this,void 0,void 0,function(){var e,n=this;return $r(this,function(r){switch(r.label){case 0:return this.assertSubscribed("unlisten()"),Rf(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseQuery(t,!1).then(function(){n.sharedClientState.clearQueryState(e.targetId),n.remoteStore.unlisten(e.targetId),n.removeAndCleanupQuery(e)}).catch(Cy)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(e),[4,this.localStore.releaseQuery(t,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.sharedClientState.addPendingMutation(t.batchId),n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),Rf(0<=e,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!Em(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(e){return Promise.reject(n.wrapUpdateFunctionError(e))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),this.localStore.applyRemoteEvent(t).then(function(n){return Vf(t.targetChanges,function(t,n){var r=e.limboResolutionsByTarget[Number(t)];r&&(Rf(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),0<n.addedDocuments.size?r.receivedDocument=!0:0<n.modifiedDocuments.size?Rf(r.receivedDocument,"Received change for limbo target document without add."):0<n.removedDocuments.size&&(Rf(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),e.emitNewSnapsAndNotifyLocalStore(n,t)}).catch(Cy)},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===Rm.RemoteStore||!this.isPrimary&&e===Rm.SharedClientState){var n=[];this.queryViewsByQuery.forEach(function(e,r){var i=r.view.applyOnlineStateChange(t);Rf(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return Jr(this,void 0,void 0,function(){var n,r,i,o,a,s,u=this;return $r(this,function(c){switch(c.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new Up(Sp.comparator)).insert(r,new kd(r,Fp.forDeletedDoc())),o=$p().add(r),a=new $m(Fp.MIN,{},new Bp(ap),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return Rf(!!(s=this.queryViewsByTarget[t]),"Unknown targetId: "+t),[4,this.localStore.releaseQuery(s.query,!1).then(function(){return u.removeAndCleanupQuery(s)}).catch(Cy)];case 2:c.sent(),this.syncEngineListener.onWatchError(s.query,e),c.label=3;case 3:return[2]}})})},t.prototype.applyBatchState=function(t,e,n){return Jr(this,void 0,void 0,function(){var r;return $r(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(Nf(Kg,"Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):Df("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},t.prototype.applySuccessfulWrite=function(t){var e=this;this.assertSubscribed("applySuccessfulWrite()");var n=t.batch.batchId;return this.processUserCallback(n,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.sharedClientState.updateMutationState(n,"acknowledged"),e.emitNewSnapsAndNotifyLocalStore(t)}).catch(Cy)},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(r){return n.sharedClientState.updateMutationState(t,"rejected",e),n.emitNewSnapsAndNotifyLocalStore(r)}).catch(Cy)},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Up(ap)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(Rf(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){var e=this;if(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(t.targetId);this.limboDocumentRefs.removeReferencesForId(t.targetId),n.forEach(function(t){e.limboDocumentRefs.containsKey(t)||e.removeLimboTarget(t)})}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){var n,r;try{for(var i=Zr(e),o=i.next();!o.done;o=i.next()){var a=o.value;a instanceof jg?(this.limboDocumentRefs.addReference(a.key,t),this.trackLimboChange(a)):a instanceof Bg?(Nf(Kg,"Document no longer in limbo: "+a.key),this.limboDocumentRefs.removeReference(a.key,t),this.limboDocumentRefs.containsKey(a.key)||this.removeLimboTarget(a.key)):Df("Unknown limbo change: "+JSON.stringify(a))}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){Nf(Kg,"New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=lg.atPath(e.path);this.limboResolutionsByTarget[n]=new Hg(e),this.remoteStore.listen(new fy(r,n,oy.LimboResolution,vp.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return Jr(this,void 0,void 0,function(){var n,r,i,o=this;return $r(this,function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(a,s){i.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=Vg.fromSnapshot(s.targetId,a.snapshot);r.push(u)}}))}),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}})})},t.prototype.assertSubscribed=function(t){Rf(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return Jr(this,void 0,void 0,function(){var e,n;return $r(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?[4,this.localStore.handleUserChange(t)]:[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},t.prototype.applyPrimaryState=function(t){return Jr(this,void 0,void 0,function(){var e,n,r,i,o,a,s,u,c,l=this;return $r(this,function(h){switch(h.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return h.sent(),r=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(r.toArray())];case 2:i=h.sent();try{for(o=Zr(i),a=o.next();!a.done;a=o.next())s=a.value,this.remoteStore.listen(s)}catch(h){e={error:h}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,u=[],c=Promise.resolve(),qf(this.queryViewsByTarget,function(t,e){l.sharedClientState.isLocalQueryTarget(t)?u.push(t):c=c.then(function(){return l.unlisten(e.query)}),l.remoteStore.unlisten(e.targetId)}),[4,c]);case 4:return h.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(u)];case 5:return h.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:h.sent(),h.label=7;case 7:return[2]}})})},t.prototype.resetLimboDocuments=function(){var t=this;qf(this.limboResolutionsByTarget,function(e){t.remoteStore.unlisten(e)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Up(Sp.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){var e,n,r=this,i=Promise.resolve(),o=[],a=[],s=function(t){i=i.then(function(){return Jr(r,void 0,void 0,function(){var e,n,r,i;return $r(this,function(s){switch(s.label){case 0:return(n=this.queryViewsByTarget[t])?[4,this.localStore.releaseQuery(n.query,!0)]:[3,4];case 1:return s.sent(),[4,this.localStore.allocateQuery(n.query)];case 2:return e=s.sent(),[4,this.synchronizeViewAndComputeSnapshot(n)];case 3:return(r=s.sent()).snapshot&&a.push(r.snapshot),[3,8];case 4:return Rf(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(t)];case 5:return Rf(!!(i=s.sent()),"Query data for target "+t+" not found"),[4,this.localStore.allocateQuery(i)];case 6:return e=s.sent(),[4,this.initializeViewAndComputeSnapshot(e,!1)];case 7:s.sent(),s.label=8;case 8:return o.push(e),[2]}})})})};try{for(var u=Zr(t),c=u.next();!c.done;c=u.next())s(c.value)}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return i.then(function(){return r.syncEngineListener.onWatchChange(a),o})},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return Jr(this,void 0,void 0,function(){var r,i=this;return $r(this,function(o){switch(o.label){case 0:if(this.isPrimary)return Nf(Kg,"Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[t])return[3,5];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,2]}return[3,4];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(n){return Jr(i,void 0,void 0,function(){var r;return $r(this,function(i){switch(i.label){case 0:return r=$m.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(n,r)];case 1:return i.sent(),[2]}})})},function(t){return Jr(i,void 0,void 0,function(){var e;return $r(this,function(n){switch(n.label){case 0:return(r=t).code!==Pf.DATA_LOSS||r.message!==Od?[3,2]:(e=[],qf(this.queryViewsByTarget,function(t){return e.push(t)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e)]);case 1:return n.sent(),[3,3];case 2:throw t;case 3:return[2]}var r})})})];case 2:return r=this.queryViewsByTarget[t],this.removeAndCleanupQuery(r),[4,this.localStore.releaseQuery(r.query,!0)];case 3:return o.sent(),this.syncEngineListener.onWatchError(r.query,n),[3,5];case 4:Df("Unexpected target state: "+e),o.label=5;case 5:return[2]}})})},t.prototype.applyActiveTargetsChange=function(t,e){return Jr(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,h,f,p,d,y,m,g=this;return $r(this,function(v){switch(v.label){case 0:if(!this.isPrimary)return[2];v.label=1;case 1:v.trys.push([1,8,9,10]),a=Zr(t),s=a.next(),v.label=2;case 2:return s.done?[3,7]:(y=s.value,Rf(!this.queryViewsByTarget[y],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(y)]);case 3:return Rf(!!(u=v.sent()),"Query data for active target "+y+" not found"),[4,this.localStore.allocateQuery(u)];case 4:return c=v.sent(),[4,this.initializeViewAndComputeSnapshot(c,!1)];case 5:v.sent(),this.remoteStore.listen(c),v.label=6;case 6:return s=a.next(),[3,2];case 7:return[3,10];case 8:return l=v.sent(),n={error:l},[3,10];case 9:try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}return[7];case 10:h=function(t){var e;return $r(this,function(n){switch(n.label){case 0:return(e=f.queryViewsByTarget[t])?[4,f.localStore.releaseQuery(e.query,!1).then(function(){g.remoteStore.unlisten(t),g.removeAndCleanupQuery(e)}).catch(Cy)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},f=this,v.label=11;case 11:v.trys.push([11,16,17,18]),p=Zr(e),d=p.next(),v.label=12;case 12:return d.done?[3,15]:(y=d.value,[5,h(y)]);case 13:v.sent(),v.label=14;case 14:return d=p.next(),[3,12];case 15:return[3,18];case 16:return m=v.sent(),i={error:m},[3,18];case 17:try{d&&!d.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}return[7];case 18:return[2]}})})},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];return e&&e.receivedDocument?$p().add(e.key):this.queryViewsByTarget[t]?this.queryViewsByTarget[t].view.syncedDocuments:$p()},t}(),zg=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Yg="SharedClientState",Xg="firestore_clients",Jg="firestore_mutations",$g="firestore_targets",Zg=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,Rf(void 0!==(this.error=r)==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new Mf(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(Af(Yg,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),tv=function(){function t(t,e,n){this.targetId=t,this.state=e,Rf(void 0!==(this.error=n)==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Mf(r.error.code,r.error.message)),i?new t(e,r.state,o):(Af(Yg,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ev=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=td(),a=0;i&&a<r.activeTargetIds.length;++a)i=Sm(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(Af(Yg,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),nv=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return"object"==typeof n&&n.onlineState in km&&"string"==typeof n.clientId?new t(n.clientId,km[n.onlineState]):(Af(Yg,"Failed to parse online state: "+e),null)},t}(),rv=function(){function t(){this.activeTargetIds=td()}return t.prototype.addQueryTarget=function(t){Rf(!this.activeTargetIds.has(t),"Target with ID '"+t+"' already active."),this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),iv=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new Mf(Pf.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey="firestore_sequence_number_"+r,this.activeClients[this.localClientId]=new rv,this.clientStateKeyRe=new RegExp("^"+Xg+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Jg+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+$g+"_"+a+"_(\\d+)$"),this.onlineStateKey="firestore_online_state_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return Jr(this,void 0,void 0,function(){var t,e,n,r,i,o,a,s,u,c,l,h,f,p,d,y=this;return $r(this,function(m){switch(m.label){case 0:return Rf(!this.started,"WebStorageSharedClientState already started"),Rf(null!==this.syncEngine,"syncEngine property must be set before calling start()"),Rf(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:i=m.sent();try{for(o=Zr(i),a=o.next();!a.done;a=o.next())(s=a.value)!==this.localClientId&&(u=this.getItem(this.toWebStorageClientStateKey(s)))&&(c=ev.fromWebStorageEntry(s,u))&&(this.activeClients[c.clientId]=c)}catch(m){t={error:m}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.persistClientState(),(l=this.storage.getItem(this.onlineStateKey))&&(h=this.fromWebStorageOnlineState(l))&&this.handleOnlineStateEvent(h);try{for(f=Zr(this.earlyEvents),p=f.next();!p.done;p=f.next())d=p.value,this.handleWebStorageEvent(d)}catch(m){n={error:m}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return y.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=td();return Vf(this.activeClients,function(e,n){t=t.unionWith(n.activeTargetIds)}),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=tv.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.removeMutationState(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Nf(Yg,"READ",t,e),e},t.prototype.setItem=function(t,e){Nf(Yg,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Nf(Yg,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(Nf(Yg,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void Af("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return Jr(e,void 0,void 0,function(){var e,n,r,i,o,a;return $r(this,function(s){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(Rf(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=function(t){var e=vp.INVALID;if(null!=t)try{var n=JSON.parse(t);Rf("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){Af(Yg,"Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==vp.INVALID&&this.sequenceNumberHandler(a));return[2]})})})}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Zg(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:km[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new tv(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.toWebStorageClientStateKey=function(t){return Rf(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),Xg+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageQueryTargetMetadataKey=function(t){return $g+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageMutationBatchKey=function(t){var e=Jg+"_"+this.persistenceKey+"_"+t;return this.currentUser.isAuthenticated()&&(e+="_"+this.currentUser.uid),e},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return Rf(null!==n,"Cannot parse client state key '"+t+"'"),ev.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);Rf(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Zg.fromWebStorageEntry(new zg(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);Rf(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return tv.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return nv.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return Jr(this,void 0,void 0,function(){return $r(this,function(e){return t.user.uid!==this.currentUser.uid?(Nf(Yg,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach(function(t){return Jr(n,void 0,void 0,function(){return $r(this,function(e){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return Jr(n,void 0,void 0,function(){return $r(this,function(e){return i.has(t)||a.push(t),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,a)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}(),ov=function(){function t(){this.localState=new rv,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new rv,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),av="FirestoreClient",sv=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.lruParams=function(){return gy.withCacheSize(this.cacheSizeBytes)},t}(),uv=function(){},cv=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=op.newId(),this._clientShutdown=!1}return t.prototype.start=function(t){var e=this;this.verifyNotShutdown();var n=new Cp,r=new Cp,i=!1;return this.credentials.setChangeListener(function(o){i?e.asyncQueue.enqueueAndForget(function(){return e.handleCredentialChange(o)}):(i=!0,e.initializePersistence(t,r,o).then(function(t){return e.initializeRest(o,t)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return t.syncEngine.enableNetwork()})},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof sv?this.startIndexedDbPersistence(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.startMemoryPersistence()}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof Mf?t.code===Pf.FAILED_PRECONDITION||t.code===Pf.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.verifyNotShutdown=function(){if(this._clientShutdown)throw new Mf(Pf.FAILED_PRECONDITION,"The client has already been shutdown.")},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=Sy.buildStoragePrefix(this.databaseInfo),i=new Lg(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return Jr(n,void 0,void 0,function(){var n,o;return $r(this,function(a){switch(a.label){case 0:if(e.synchronizeTabs&&!iv.isAvailable(this.platform))throw new Mf(Pf.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return o=e.lruParams(),e.synchronizeTabs?(this.sharedClientState=new iv(this.asyncQueue,this.platform,r,this.clientId,t),[4,Sy.createMultiClientIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return n=a.sent(),[3,4];case 2:return this.sharedClientState=new ov,[4,Sy.createIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o)];case 3:n=a.sent(),a.label=4;case 4:return[2,(this.persistence=n).referenceDelegate.garbageCollector]}})})})},t.prototype.startMemoryPersistence=function(){return this.persistence=ym.createEagerPersistence(this.clientId),this.sharedClientState=new ov,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return Nf(av,"Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return Jr(n,void 0,void 0,function(){var n,i,o,a,s,u=this;return $r(this,function(c){switch(c.label){case 0:return this.localStore=new lm(this.persistence,t),e&&(this.lruScheduler=new vy(e,this.asyncQueue,this.localStore)),n=this.platform.newConnectivityMonitor(),i=this.platform.newSerializer(this.databaseInfo.databaseId),o=new Lm(this.asyncQueue,r,this.credentials,i),a=function(t){return u.syncEngine.applyOnlineStateChange(t,Rm.RemoteStore)},s=function(t){return u.syncEngine.applyOnlineStateChange(t,Rm.SharedClientState)},this.remoteStore=new ug(this.localStore,o,this.asyncQueue,a,n),this.syncEngine=new Gg(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=s,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new Ug(this.syncEngine),[4,this.sharedClientState.start()];case 1:return c.sent(),[4,this.remoteStore.start()];case 2:return c.sent(),[4,this.persistence.setPrimaryStateListener(function(t){return Jr(u,void 0,void 0,function(){return $r(this,function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}})})})];case 3:return c.sent(),[4,this.persistence.setDatabaseDeletedListener(function(){return Jr(u,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return[4,this.shutdown()];case 1:return t.sent(),[2]}})})})];case 4:return c.sent(),[2]}})})})},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),Nf(av,"Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return t.syncEngine.disableNetwork()})},t.prototype.shutdown=function(){var t=this;return this.asyncQueue.enqueue(function(){return Jr(t,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this._clientShutdown?[3,4]:(this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()]);case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:t.sent(),this.credentials.removeChangeListener(),this._clientShutdown=!0,t.label=4;case 4:return[2]}})})})},t.prototype.listen=function(t,e,n){var r=this;this.verifyNotShutdown();var i=new qg(t,e,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.verifyNotShutdown(),this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof Ad)return t;if(t instanceof kd)return null;throw new Mf(Pf.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=$p(),r=new Wg(t,n),i=r.computeDocChanges(e);return r.applyChanges(i,!1).snapshot})},t.prototype.write=function(t){var e=this;this.verifyNotShutdown();var n=new Cp;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},Object.defineProperty(t.prototype,"clientShutdown",{get:function(){return this._clientShutdown},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;return this.verifyNotShutdown(),this.asyncQueue.enqueue(function(){return Jr(e,void 0,void 0,function(){return $r(this,function(t){return[2]})})}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),lv=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),hv=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new Mf(Pf.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+ip(1,"element")+".")}(0,t);for(var n=0;n<t.length;++n)if(Hf("FieldPath","string",n,t[n]),0===t[n].length)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ep(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw np("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(Ep.keyField().canonicalString()),t}(),fv=new RegExp("[~\\*/\\[\\]]"),pv=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}},dv=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){Rf(!this.changeListener,"Can only call setChangeListener() once."),(this.changeListener=t)(zg.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){Rf(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),yv=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(){var t=this;Rf(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(t.tokenCounter!==e)throw new Mf(Pf.ABORTED,"getToken aborted due to token change.");return n?(Rf("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new pv(n.accessToken,t.currentUser)):null})},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){Rf(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){Rf(null!=this.tokenListener,"removeChangeListener() called twice"),Rf(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return Rf(null===t||"string"==typeof t,"Received invalid UID: "+t),new zg(t)},t}(),mv=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=zg.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.sessionIndex},e=this.gapi.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),gv=function(){function t(t,e){this.gapi=t,this.sessionIndex=e}return t.prototype.getToken=function(){return Promise.resolve(new mv(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(zg.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function vv(t){return function(t,e){var n,r;if("object"!=typeof t||null===t)return!1;var i=t;try{for(var o=Zr(["next","error","complete"]),a=o.next();!a.done;a=o.next()){var s=a.value;if(s in i&&"function"==typeof i[s])return!0}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1}(t)}var bv,wv,_v=function(){function t(t){this._methodName=t}return t.delete=function(){return Bf("FieldValue.delete",arguments),Tv.instance},t.serverTimestamp=function(){return Bf("FieldValue.serverTimestamp",arguments),Ev.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kf("FieldValue.arrayUnion",arguments,1),new Sv(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kf("FieldValue.arrayRemove",arguments,1),new Cv(t)},t.increment=function(t){return Hf("FieldValue.increment","number",1,t),Wf("FieldValue.increment",arguments,1),new Iv(t)},t.prototype.isEqual=function(t){return this===t},t}(),Tv=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return Yr(e,t),e.instance=new e,e}(_v),Ev=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return Yr(e,t),e.instance=new e,e}(_v),Sv=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return Yr(e,t),e}(_v),Cv=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return Yr(e,t),e}(_v),Iv=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n._operand=e,n}return Yr(e,t),e}(_v),Nv=Lf(_v,"Use FieldValue.<field>() instead."),Av=/^__.*__$/,kv=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new im(t,this.data,this.fieldMask,e)):n.push(new rm(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new om(t,this.fieldTransforms)),n},t}(),Dv=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new im(t,this.data,this.fieldMask,e)];return 0<this.fieldTransforms.length&&n.push(new om(t,this.fieldTransforms)),n},t}();function Rv(t){switch(t){case bv.Set:case bv.MergeSet:case bv.Update:return!0;case bv.Argument:return!1;default:throw Df("Unexpected case for UserDataSource: "+t)}}(wv=bv||(bv={}))[wv.Set=0]="Set",wv[wv.Update=1]="Update",wv[wv.MergeSet=2]="MergeSet",wv[wv.Argument=3]="Argument";var xv=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new Mf(Pf.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(Rv(this.dataSource)&&Av.test(t))throw this.createError("Document fields cannot begin and end with __")},t}(),Ov=function(t,e){this.databaseId=t,this.key=e},Pv=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new xv(bv.Set,t,Ep.EMPTY_PATH);Lv("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new kv(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r,i,o=new xv(bv.MergeSet,t,Ep.EMPTY_PATH);Lv("Data must be an object, but it was:",o,e);var a,s,u=this.parseData(e,o);if(n){var c=new Bp(Ep.comparator);try{for(var l=Zr(n),h=l.next();!h.done;h=l.next()){var f=h.value,p=void 0;if(f instanceof hv)p=f._internalPath;else{if("string"!=typeof f)throw Df("Expected stringOrFieldPath to be a string or a FieldPath");p=Uv(t,f)}if(!o.contains(p))throw new Mf(Pf.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");c=c.add(p)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}a=$y.fromSet(c),s=o.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=$y.fromArray(o.fieldMask),s=o.fieldTransforms;return new kv(u,a,s)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new xv(bv.Update,t,Ep.EMPTY_PATH);Lv("Data must be an object, but it was:",r,e);var i=new Bp(Ep.comparator),o=Xy.EMPTY;Vf(e,function(e,a){var s=Uv(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof Tv)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}});var a=$y.fromSet(i);return new Dv(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new xv(bv.Update,t,Ep.EMPTY_PATH),o=[Fv(t,e)],a=[n];if(r.length%2!=0)throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Fv(t,r[s])),a.push(r[s+1]);var u=new Bp(Ep.comparator),c=Xy.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof Tv)u=u.add(l);else{var p=this.parseData(f,h);null!=p&&(u=u.add(l),c=c.set(l,p))}}var d=$y.fromSet(u);return new Dv(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new xv(bv.Argument,t,Ep.EMPTY_PATH),r=this.parseData(e,n);return Rf(null!=r,"Parsed data should not be null."),Rf(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=qv(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(Mv(t=this.runPreConverter(t,e)))return Lv("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof _v)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new Up(ap);return jf(t)?e.path&&0<e.path.length&&e.fieldMask.push(e.path):Vf(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new Xy(r)},t.prototype.parseArray=function(t,e){var n,r,i=[],o=0;try{for(var a=Zr(t),s=a.next();!s.done;s=a.next()){var u=s.value,c=this.parseData(u,e.childContextForArray(o));null==c&&(c=Ly.INSTANCE),i.push(c),o++}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return new Jy(i)},t.prototype.parseSentinelFieldValue=function(t,e){if(!Rv(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof Tv){if(e.dataSource!==bv.MergeSet)throw e.dataSource===bv.Update?(Rf(0<e.path.length,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof Ev)e.fieldTransforms.push(new Zy(e.path,Eg.instance));else if(t instanceof Sv){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new Sg(n);e.fieldTransforms.push(new Zy(e.path,r))}else if(t instanceof Cv){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new Cg(n);e.fieldTransforms.push(new Zy(e.path,i))}else if(t instanceof Iv){var o=this.parseQueryValue("FieldValue.increment",t._operand),a=new Ig(o);e.fieldTransforms.push(new Zy(e.path,a))}else Df("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Ly.INSTANCE;if("number"==typeof t)return Sm(t)?new By(t):new Wy(t);if("boolean"==typeof t)return Fy.of(t);if("string"==typeof t)return new Ky(t);if(t instanceof Date)return new Qy(Lp.fromDate(t));if(t instanceof Lp)return new Qy(new Lp(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof cg)return new Yy(t);if(t instanceof pp)return new Gy(t);if(t instanceof Ov)return new zy(t.databaseId,t.key);throw e.createError("Unsupported field value: "+Zf(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new xv(bv.Argument,t,Ep.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}();function Mv(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Lp||t instanceof cg||t instanceof pp||t instanceof Ov||t instanceof _v)}function Lv(t,e,n){if(!Mv(n)||!$f(n)){var r=Zf(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Fv(t,e){if(e instanceof hv)return e._internalPath;if("string"==typeof e)return Uv(t,e);throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Uv(t,e){try{return function(t){if(0<=t.search(fv))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(hv.bind.apply(hv,ei([void 0],t.split("."))))}catch(e){throw new Mf(Pf.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(e){var n=qv(e);throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function qv(t){return t instanceof Error?t.message:t.toString()}var Vv=gy.COLLECTION_DISABLED,jv=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new Mf(Pf.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else zf("settings","non-empty string","host",t.host),this.host=t.host,Yf("settings","boolean","ssl",t.ssl),this.ssl=Uf(t.ssl,!0);if(ep("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Yf("settings","object","credentials",t.credentials),this.credentials=t.credentials,Yf("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?Af("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&Af("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=Uf(t.timestampsInSnapshots,!0),Yf("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=gy.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Vv&&t.cacheSizeBytes<gy.MINIMUM_CACHE_SIZE_BYTES)throw new Mf(Pf.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+gy.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}Yf("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Bv=function(){},Wv=function(){function t(e){var n=this;this._queue=new Np,this.INTERNAL={delete:function(){return Jr(n,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this.ensureClientConfigured(),[4,this._firestoreClient.shutdown()];case 1:return t.sent(),[2]}})})}};var r=new Bv;if("object"==typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new yv(i)}else{var o=e;if(!o.projectId)throw new Mf(Pf.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new gp(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new dv}r.settings=new jv({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(Wf("Firestore.settings",arguments,1),Hf("Firestore.settings","object",1,t),Ff(t,"persistence"))throw new Mf(Pf.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new jv(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new Mf(Pf.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this._config.settings=e).credentials&&(this._config.credentials=function(t){if(!t)return new dv;switch(t.type){case"gapi":var e=t.client;return Rf(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new gv(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Mf(Pf.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new Mf(Pf.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&Af("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=Uf(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.configureClient(new sv(this._config.settings.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=Sy.buildStoragePrefix(this.makeDatabaseInfo()),n=new Cp;return this._queue.enqueueAndForget(function(){return Jr(t,void 0,void 0,function(){var t;return $r(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this._firestoreClient&&!this._firestoreClient.clientShutdown)throw new Mf(Pf.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,Sy.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}})})}),n.promise},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new uv),this._firestoreClient},t.prototype.makeDatabaseInfo=function(){return new yp(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl,this._config.settings.forceLongPolling)},t.prototype.configureClient=function(t){var e=this;Rf(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),Rf(!this._firestoreClient,"configureClient() called multiple times");var n=this.makeDatabaseInfo();return this._dataConverter=new Pv(function(t){if(t instanceof Hv){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new Mf(Pf.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Ov(e._config.databaseId,t._key)}return t}),this._firestoreClient=new cv(xf.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!Ff(e,"projectId"))throw new Mf(Pf.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new Mf(Pf.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new gp(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new Mf(Pf.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return Wf("Firestore.collection",arguments,1),Hf("Firestore.collection","non-empty string",1,t),this.ensureClientConfigured(),new $v(_p.fromString(t),this)},t.prototype.doc=function(t){return Wf("Firestore.doc",arguments,1),Hf("Firestore.doc","non-empty string",1,t),this.ensureClientConfigured(),Hv.forPath(_p.fromString(t),this)},t.prototype.collectionGroup=function(t){if(Wf("Firestore.collectionGroup",arguments,1),Hf("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ensureClientConfigured(),new Xv(new lg(_p.EMPTY_PATH,t),this)},t.prototype.runTransaction=function(t){var e=this;return Wf("Firestore.runTransaction",arguments,1),Hf("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new Kv(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new Qv(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(Cf()){case yf.DEBUG:return"debug";case yf.ERROR:return"error";case yf.SILENT:return"silent";default:return Df("Unknown log level: "+Cf())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(Wf("Firestore.setLogLevel",arguments,1),Hf("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":If(yf.DEBUG);break;case"error":If(yf.ERROR);break;case"silent":If(yf.SILENT);break;default:throw new Mf(Pf.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},t}(),Kv=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;Wf("Transaction.get",arguments,1);var n=nb("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Df("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof kd)return new zv(e._firestore,n._key,null,!1,!1);if(r instanceof Ad)return new zv(e._firestore,n._key,r,!1,!1);throw Df("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},t.prototype.set=function(t,e,n){Qf("Transaction.set",arguments,2,3);var r=nb("Transaction.set",t,this._firestore),i=(n=Zv("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return i="string"==typeof e||e instanceof hv?(Kf("Transaction.update",arguments,3),r=nb("Transaction.update",t,this._firestore),this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(Wf("Transaction.update",arguments,2),r=nb("Transaction.update",t,this._firestore),this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){Wf("Transaction.delete",arguments,1);var e=nb("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Qv=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){Qf("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=nb("WriteBatch.set",t,this._firestore),i=(n=Zv("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,em.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),i="string"==typeof e||e instanceof hv?(Kf("WriteBatch.update",arguments,3),r=nb("WriteBatch.update",t,this._firestore),this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(Wf("WriteBatch.update",arguments,2),r=nb("WriteBatch.update",t,this._firestore),this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,em.exists(!0))),this},t.prototype.delete=function(t){Wf("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=nb("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new am(e._key,em.NONE)),this},t.prototype.commit=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){return this.verifyNotCommitted(),this._committed=!0,0<this._mutations.length?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new Mf(Pf.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Hv=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new Sp(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new $v(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(Wf("DocumentReference.collection",arguments,1),Hf("DocumentReference.collection","non-empty string",1,t),!t)throw new Mf(Pf.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=_p.fromString(t);return new $v(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw np("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){Qf("DocumentReference.set",arguments,1,2);var n=(e=Zv("DocumentReference.set",e)).merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,em.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof hv?(Kf("DocumentReference.update",arguments,2),this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(Wf("DocumentReference.update",arguments,1),this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,em.exists(!0)))},t.prototype.delete=function(){return Wf("DocumentReference.delete",arguments,0),this._firestoreClient.write([new am(this._key,em.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Qf("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||vv(t[i])||(ep("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Yf("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return n=vv(t[i])?t[i]:(Hf("DocumentReference.onSnapshot","function",i,t[i]),Gf("DocumentReference.onSnapshot","function",i+1,t[i+1]),Gf("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new lv({next:function(t){if(e.next){Rf(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new zv(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(lg.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return Qf("DocumentReference.get",arguments,0,1),eb("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new zv(e.firestore,e._key,t,!0,t instanceof Ad&&t.hasLocalMutations))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new Mf(Pf.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new Mf(Pf.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),Gv=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),zv=function(){function t(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return t.prototype.data=function(t){return Qf("DocumentSnapshot.data",arguments,0,1),t=tb("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data,Py.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(Qf("DocumentSnapshot.get",arguments,1,2),e=tb("DocumentSnapshot.get",e),this._document){var n=this._document.data.field(Fv("DocumentSnapshot.get",t));if(null!==n)return this.convertValue(n,Py.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Hv(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Gv(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw np("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof Xy)return this.convertObject(t,e);if(t instanceof Jy)return this.convertArray(t,e);if(t instanceof zy){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||Af("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Hv(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),Yv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yr(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return Rf("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}(zv),Xv=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){var i,o,a;Wf("Query.where",arguments,3),tp("Query.where",3,r),"in"!==n&&"array-contains-any"!==n&&function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid value "+Zf(r)+" provided to function Query.where() for its "+rp(2)+" argument. Acceptable values: "+e.join(", "))}(0,["<","<=","==",">=",">","array-contains"],0,n);var s=Fv("Query.where",e),u=hg.fromString(n);if(s.isKeyField()){if(u===hg.ARRAY_CONTAINS||u===hg.ARRAY_CONTAINS_ANY)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+u.toString()+"' queries on FieldPath.documentId().");if(u===hg.IN){this.validateDisjunctiveFilterElements(r,u);var c=[];try{for(var l=Zr(r),h=l.next();!h.done;h=l.next()){var f=h.value;c.push(this.parseDocumentIdValue(f))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}a=new Jy(c)}else a=this.parseDocumentIdValue(r)}else u!==hg.IN&&u!==hg.ARRAY_CONTAINS_ANY||this.validateDisjunctiveFilterElements(r,u),a=this.firestore._dataConverter.parseQueryValue("Query.where",r);var p=fg.create(s,u,a);return this.validateNewFilter(p),new t(this._query.addFilter(p),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(Qf("Query.orderBy",arguments,1,2),Gf("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=vg.ASCENDING;else{if("desc"!==n)throw new Mf(Pf.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=vg.DESCENDING}if(null!==this._query.startAt)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Fv("Query.orderBy",e),o=new wg(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(Wf("Query.limit",arguments,1),Hf("Query.limit","number",1,e),e<=0)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Kf("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Kf("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Kf("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Kf("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw np("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(tp(t,1,e),e instanceof zv){if(0<n.length)throw new Mf(Pf.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new Mf(Pf.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){var r,i,o=[];try{for(var a=Zr(this._query.orderBy),s=a.next();!s.done;s=a.next()){var u=s.value;if(u.field.isKeyField())o.push(new zy(this.firestore._databaseId,e.key));else{var c=e.field(u.field);if(c instanceof Hy)throw new Mf(Pf.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return new bg(o,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new Mf(Pf.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(!this._query.isCollectionGroupQuery()&&-1!==a.indexOf("/"))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+a+"' contains a slash.");var s=this._query.path.child(_p.fromString(a));if(!Sp.isDocumentKey(s))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new Sp(s);i.push(new zy(this.firestore._databaseId,u))}else{var c=this.firestore._dataConverter.parseQueryValue(t,a);i.push(c)}}return new bg(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Qf("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||vv(t[i])||(ep("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Yf("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=vv(t[i])?t[i]:(Hf("Query.onSnapshot","function",i,t[i]),Gf("Query.onSnapshot","function",i+1,t[i+1]),Gf("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new lv({next:function(t){e.next&&e.next(new Jv(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(t){var e=this;return Qf("Query.get",arguments,0,1),eb("Query.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new Jv(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new Mf(Pf.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.parseDocumentIdValue=function(t){if("string"==typeof t){if(""===t)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this._query.isCollectionGroupQuery()&&-1!==t.indexOf("/"))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this._query.path.child(_p.fromString(t));if(!Sp.isDocumentKey(e))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new zy(this.firestore._databaseId,new Sp(e))}if(t instanceof Hv){var n=t;return new zy(this.firestore._databaseId,n._key)}throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Zf(t)+".")},t.prototype.validateDisjunctiveFilterElements=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.validateNewFilter=function(t){if(t instanceof fg){var e=[hg.ARRAY_CONTAINS,hg.ARRAY_CONTAINS_ANY],n=[hg.IN,hg.ARRAY_CONTAINS_ANY],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.isInequality()){var o=this._query.getInequalityFilterField();if(null!==o&&!o.isEqual(t.field))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var a=this._query.getFirstOrderByField();null!==a&&this.validateOrderByAndInequalityMatch(t.field,a)}else if(i||r){var s=null;if(i&&(s=this._query.findFilterOperator(n)),null===s&&r&&(s=this._query.findFilterOperator(e)),null!=s)throw s===t.op?new Mf(Pf.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Mf(Pf.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new Mf(Pf.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Jv=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new Gv(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;Qf("QuerySnapshot.forEach",arguments,1,2),Hf("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Xv(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(ep("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Yf("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new Mf(Pf.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(e){var o=new Yv(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return Rf(e.type===Wm.Added,"Invalid event type for first snapshot"),Rf(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==Wm.Metadata}).map(function(e){var r=new Yv(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,a=-1;return e.type!==Wm.Added&&(Rf(0<=(i=o.indexOf(e.doc.key)),"Index for document not found"),o=o.delete(e.doc.key)),e.type!==Wm.Removed&&(a=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case Wm.Added:return"added";case Wm.Modified:case Wm.Metadata:return"modified";case Wm.Removed:return"removed";default:return Df("Unknown change type: "+t)}}(e.type),doc:r,oldIndex:i,newIndex:a}})}(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw np("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Yv(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},t}();ei(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(Jv.prototype.docChanges,t,{get:function(){return function(){throw new Mf(Pf.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}});var $v=function(t){function e(e,n){var r=t.call(this,lg.atPath(e),n)||this;if(e.length%2!=1)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return Yr(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Hv(new Sp(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(Qf("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=op.newId()),Hf("CollectionReference.doc","non-empty string",1,t),""===t)throw new Mf(Pf.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=_p.fromString(t);return Hv.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){Wf("CollectionReference.add",arguments,1),Hf("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(Xv);function Zv(t,e){if(void 0===e)return{merge:!1};if(ep(t,e,["merge","mergeFields"]),Yf(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Zf(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new Mf(Pf.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+Zf(r[o]))}(t,e,n,r,i)}(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"==typeof t||t instanceof hv}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Mf(Pf.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function tb(t,e){return void 0===e?{}:(ep(t,e,["serverTimestamps"]),Xf(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function eb(t,e){Gf(t,"object",1,e),e&&(ep(t,e,["source"]),Xf(t,0,"source",e.source,["default","server","cache"]))}function nb(t,e,n){if(e instanceof Hv){if(e.firestore!==n)throw new Mf(Pf.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw np(t,"DocumentReference",1,e)}var rb=Lf(Wv,"Use firebase.firestore() instead."),ib=Lf(Kv,"Use firebase.firestore().runTransaction() instead."),ob=Lf(Qv,"Use firebase.firestore().batch() instead."),ab=Lf(Hv,"Use firebase.firestore().doc() instead."),sb=Lf(zv),ub=Lf(Yv),cb=Lf(Xv),lb=Lf(Jv),hb=Lf($v,"Use firebase.firestore().collection() instead."),fb={Firestore:rb,GeoPoint:cg,Timestamp:Lp,Blob:dp,Transaction:ib,WriteBatch:ob,DocumentReference:ab,DocumentSnapshot:sb,Query:cb,QueryDocumentSnapshot:ub,QuerySnapshot:lb,CollectionReference:hb,FieldPath:hv,FieldValue:Nv,setLogLevel:Wv.setLogLevel,CACHE_SIZE_UNLIMITED:Vv};var pb=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.shutdown=function(){},t}(),db="ConnectivityMonitor",yb=function(){function t(){var t=this;this.networkAvailableListener=function(){return t.onNetworkAvailable()},this.networkUnavailableListener=function(){return t.onNetworkUnavailable()},this.callbacks=[],this.configureNetworkMonitoring()}return t.prototype.addCallback=function(t){this.callbacks.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.networkAvailableListener),window.removeEventListener("offline",this.networkUnavailableListener)},t.prototype.configureNetworkMonitoring=function(){window.addEventListener("online",this.networkAvailableListener),window.addEventListener("offline",this.networkUnavailableListener)},t.prototype.onNetworkAvailable=function(){var t,e;Nf(db,"Network connectivity changed: AVAILABLE");try{for(var n=Zr(this.callbacks),r=n.next();!r.done;r=n.next())(0,r.value)(0)}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.onNetworkUnavailable=function(){var t,e;Nf(db,"Network connectivity changed: UNAVAILABLE");try{for(var n=Zr(this.callbacks),r=n.next();!r.done;r=n.next())(0,r.value)(1)}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.isAvailable=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),mb=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){Rf(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){Rf(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){Rf(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){Rf(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){Rf(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){Rf(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),gb="Connection",vb={BatchGetDocuments:"batchGet",Commit:"commit"},bb="gl-js/ fire/"+Ef,wb=function(){function t(t){this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=bb},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(o,a){var s=new Tf;s.listenOnce(wf.COMPLETE,function(){try{switch(s.getLastErrorCode()){case bf.NO_ERROR:var e=s.getResponseJson();Nf(gb,"XHR received:",JSON.stringify(e)),o(e);break;case bf.TIMEOUT:Nf(gb,'RPC "'+t+'" timed out'),a(new Mf(Pf.DEADLINE_EXCEEDED,"Request time out"));break;case bf.HTTP_ERROR:var n=s.getStatus();Nf(gb,'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),0<n?a(new Mf(function(t){switch(t){case 200:return Pf.OK;case 400:return Pf.INVALID_ARGUMENT;case 401:return Pf.UNAUTHENTICATED;case 403:return Pf.PERMISSION_DENIED;case 404:return Pf.NOT_FOUND;case 409:return Pf.ABORTED;case 416:return Pf.OUT_OF_RANGE;case 429:return Pf.RESOURCE_EXHAUSTED;case 499:return Pf.CANCELLED;case 500:return Pf.UNKNOWN;case 501:return Pf.UNIMPLEMENTED;case 503:return Pf.UNAVAILABLE;case 504:return Pf.DEADLINE_EXCEEDED;default:return 200<=t&&t<300?Pf.OK:400<=t&&t<500?Pf.FAILED_PRECONDITION:500<=t&&t<600?Pf.INTERNAL:Pf.UNKNOWN}}(n),"Server responded with status "+s.getStatusText())):(Nf(gb,'RPC "'+t+'" failed'),a(new Mf(Pf.UNAVAILABLE,"Connection failed.")));break;default:Df('RPC "'+t+'" failed with unanticipated webchannel error '+s.getLastErrorCode()+": "+s.getLastError()+", giving up.")}}finally{Nf(gb,'RPC "'+t+'" completed.')}});var u=JSON.stringify(e);Nf(gb,"XHR sending: ",i+" "+u);var c={"Content-Type":"text/plain"};r.modifyHeadersForRequest(c,n),s.send(i,"POST",u,c,15)})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=vf(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.modifyHeadersForRequest(i.initMessageHeaders,e),di()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");Nf(gb,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,u=!1,c=new mb({sendFn:function(t){u?Nf(gb,"Not sending because WebChannel is closed:",t):(s||(Nf(gb,"Opening WebChannel transport."),a.open(),s=!0),Nf(gb,"WebChannel sending:",t),a.send(t))},closeFn:function(){return a.close()}}),l=function(t,e){a.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(_f.EventType.OPEN,function(){u||Nf(gb,"WebChannel transport opened.")}),l(_f.EventType.CLOSE,function(){u||(u=!0,Nf(gb,"WebChannel transport closed"),c.callOnClose())}),l(_f.EventType.ERROR,function(t){u||(u=!0,Nf(gb,"WebChannel transport errored:",t),c.callOnClose(new Mf(Pf.UNAVAILABLE,"The operation could not be completed")))}),l(_f.EventType.MESSAGE,function(t){if(!u){var e=t.data[0];Rf(!!e,"Got a webchannel message without data.");var n=e,r=n.error||n[0]&&n[0].error;if(r){Nf(gb,"WebChannel received error:",r);var i=r.status,o=function(t){var e=Um[i];if(void 0!==e)return Bm(e)}(),s=r.message;void 0===o&&(o=Pf.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),u=!0,c.callOnClose(new Mf(o,s)),a.close()}else Nf(gb,"WebChannel received:",e),c.callOnMessage(e)}}),setTimeout(function(){c.callOnOpen()},0),c},t.prototype.makeUrl=function(t){var e=vb[t];Rf(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),_b=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new wb(t))},t.prototype.newConnectivityMonitor=function(){return yb.isAvailable()?new yb:new pb},t.prototype.newSerializer=function(t){return new Lg(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();xf.setPlatform(new _b),function(t){t.INTERNAL.registerService("firestore",function(t){return new Wv(t)},function(t){Rf(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(fb))}($i);var Tb={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Eb=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return Yr(e,t),e}(Error),Sb=function(){function t(t){this.app=t}return t.prototype.getAuthToken=function(){return Jr(this,void 0,void 0,function(){var t;return $r(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.app.INTERNAL.getToken()];case 1:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}})})},t.prototype.getInstanceIdToken=function(){return Jr(this,void 0,void 0,function(){var t;return $r(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.app.messaging?[4,this.app.messaging().getToken()]:[2,void 0];case 1:return(t=e.sent())?[2,t]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}})})},t.prototype.getContext=function(){return Jr(this,void 0,void 0,function(){var t,e;return $r(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}})})},t}();function Cb(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var Ib,Nb,Ab=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map(function(t){return e.encode(t)});if("function"==typeof t||"object"==typeof t)return Cb(t,function(t){return e.encode(t)});throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return e.decode(t)}):"function"==typeof t||"object"==typeof t?Cb(t,function(t){return e.decode(t)}):t},t}(),kb=function(){function t(t,e){var n=this;void 0===e&&(e="us-central1"),this.app_=t,this.region_=e,this.serializer=new Ab,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return n.deleteService()}},this.contextProvider=new Sb(t),this.cancelAllRequests=new Promise(function(t){n.deleteService=function(){return t()}})}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId,n=this.region_;return null===this.emulatorOrigin?"https://"+n+"-"+e+".cloudfunctions.net/"+t:this.emulatorOrigin+"/"+e+"/"+n+"/"+t},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Jr(this,void 0,void 0,function(){var r,i;return $r(this,function(o){switch(o.label){case 0:n.append("Content-Type","application/json"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}})})},t.prototype.call=function(t,e,n){return Jr(this,void 0,void 0,function(){var r,i,o,a,s,u,c,l;return $r(this,function(h){switch(h.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o=new Headers,[4,this.contextProvider.getContext()];case 1:return(a=h.sent()).authToken&&o.append("Authorization","Bearer "+a.authToken),a.instanceIdToken&&o.append("Firebase-Instance-ID-Token",a.instanceIdToken),s=n.timeout||7e4,[4,Promise.race([this.postJSON(r,i,o),(f=s,new Promise(function(t,e){setTimeout(function(){e(new Eb("deadline-exceeded","deadline-exceeded"))},f)})),this.cancelAllRequests])];case 2:if(!(u=h.sent()))throw new Eb("cancelled","Firebase Functions instance was deleted.");if(c=function(t,e,n){var r=function(t){if(200<=t&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"==typeof s){if(!Tb[s])return new Eb("internal","internal");r=Tb[s],i=s}var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new Eb(r,i,o)}(u.status,u.json,this.serializer))throw c;if(!u.json)throw new Eb("internal","Response is not valid JSON object.");if(void 0===(l=u.json.data)&&(l=u.json.result),void 0===l)throw new Eb("internal","Response is missing data field.");return[2,{data:this.serializer.decode(l)}]}var f})})},t}();Ib={Functions:kb},$i.INTERNAL.registerService("functions",function(t,e,n){return new kb(t,n)},Ib,void 0,!0);var Db,Rb,xb,Ob,Pb=((Nb={})["only-available-in-window"]="This method is available in a Window context.",Nb["only-available-in-sw"]="This method is available in a service worker context.",Nb["should-be-overriden"]="This method should be overriden by extended classes.",Nb["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",Nb["permission-default"]="The required permissions were not granted and dismissed instead.",Nb["permission-blocked"]="The required permissions were not granted and blocked instead.",Nb["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",Nb["notifications-blocked"]="Notifications have been blocked.",Nb["failed-serviceworker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",Nb["sw-registration-expected"]="A service worker registration was the expected input.",Nb["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",Nb["invalid-saved-token"]="Unable to access details of the saved token.",Nb["sw-reg-redundant"]="The service worker being used for push was made redundant.",Nb["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",Nb["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",Nb["token-subscribe-no-push-set"]="FCM returned an invalid response when getting an FCM token.",Nb["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",Nb["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",Nb["token-update-no-token"]="FCM returned no token when updating the user to push.",Nb["use-sw-before-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",Nb["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",Nb["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",Nb["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",Nb["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",Nb["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",Nb["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$errorInfo}",Nb["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",Nb["failed-to-delete-token"]="Unable to delete the currently saved token.",Nb["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",Nb["incorrect-gcm-sender-id"]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",Nb["bad-scope"]="The service worker scope must be a string with at least one character.",Nb["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",Nb["bad-subscription"]="The subscription must be a valid PushSubscription.",Nb["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",Nb["bad-push-set"]="The FCM push set used for storage / lookup was not not a valid push set string.",Nb["failed-delete-vapid-key"]="The VAPID key could not be deleted.",Nb["invalid-public-vapid-key"]="The public VAPID key must be a string.",Nb["use-public-key-before-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",Nb["public-vapid-key-decryption-failed"]="The public VAPID key did not equal 65 bytes when decrypted.",Nb),Mb=new gi("messaging","Messaging",Pb),Lb=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),Fb="https://fcm.googleapis.com";function Ub(t,e){if(null==t||null==e)return!1;if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(var n=new DataView(t),r=new DataView(e),i=0;i<t.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function qb(t){var e;return(e=new Uint8Array(t),btoa(String.fromCharCode.apply(String,ei(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(Rb=Db||(Db={})).TYPE_OF_MSG="firebase-messaging-msg-type",Rb.DATA="firebase-messaging-msg-data",(Ob=xb||(xb={})).PUSH_MSG_RECEIVED="push-msg-received",Ob.NOTIFICATION_CLICKED="notification-clicked";var Vb=function(){function t(){}return t.prototype.getToken=function(t,e,n){return Jr(this,void 0,void 0,function(){var r,i,o,a,s,u,c,l,h;return $r(this,function(f){switch(f.label){case 0:r=qb(e.getKey("p256dh")),i=qb(e.getKey("auth")),o="authorized_entity="+t+"&endpoint="+e.endpoint+"&encryption_key="+r+"&encryption_auth="+i,Ub(n.buffer,Lb.buffer)||(a=qb(n),o+="&application_pub_key="+a),(s=new Headers).append("Content-Type","application/x-www-form-urlencoded"),u={method:"POST",headers:s,body:o},f.label=1;case 1:return f.trys.push([1,4,,5]),[4,fetch(Fb+"/fcm/connect/subscribe",u)];case 2:return[4,f.sent().json()];case 3:return c=f.sent(),[3,5];case 4:throw l=f.sent(),Mb.create("token-subscribe-failed",{errorInfo:l});case 5:if(c.error)throw h=c.error.message,Mb.create("token-subscribe-failed",{errorInfo:h});if(!c.token)throw Mb.create("token-subscribe-no-token");if(!c.pushSet)throw Mb.create("token-subscribe-no-push-set");return[2,{token:c.token,pushSet:c.pushSet}]}})})},t.prototype.updateToken=function(t,e,n,r,i){return Jr(this,void 0,void 0,function(){var o,a,s,u,c,l,h,f,p;return $r(this,function(d){switch(d.label){case 0:o=qb(r.getKey("p256dh")),a=qb(r.getKey("auth")),s="push_set="+n+"&token="+e+"&authorized_entity="+t+"&endpoint="+r.endpoint+"&encryption_key="+o+"&encryption_auth="+a,Ub(i.buffer,Lb.buffer)||(u=qb(i),s+="&application_pub_key="+u),(c=new Headers).append("Content-Type","application/x-www-form-urlencoded"),l={method:"POST",headers:c,body:s},d.label=1;case 1:return d.trys.push([1,4,,5]),[4,fetch(Fb+"/fcm/connect/subscribe",l)];case 2:return[4,d.sent().json()];case 3:return h=d.sent(),[3,5];case 4:throw f=d.sent(),Mb.create("token-update-failed",{errorInfo:f});case 5:if(h.error)throw p=h.error.message,Mb.create("token-update-failed",{errorInfo:p});if(!h.token)throw Mb.create("token-update-no-token");return[2,h.token]}})})},t.prototype.deleteToken=function(t,e,n){return Jr(this,void 0,void 0,function(){var r,i,o,a,s,u;return $r(this,function(c){switch(c.label){case 0:r="authorized_entity="+t+"&token="+e+"&pushSet="+n,(i=new Headers).append("Content-Type","application/x-www-form-urlencoded"),o={method:"POST",headers:i,body:r},c.label=1;case 1:return c.trys.push([1,4,,5]),[4,fetch(Fb+"/fcm/connect/unsubscribe",o)];case 2:return[4,c.sent().json()];case 3:if((a=c.sent()).error)throw s=a.error.message,Mb.create("token-unsubscribe-failed",{errorInfo:s});return[3,5];case 4:throw u=c.sent(),Mb.create("token-unsubscribe-failed",{errorInfo:u});case 5:return[2]}})})},t}();function jb(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var Bb="undefined",Wb="fcm_token_object_Store";var Kb=function(){function t(){this.dbPromise=null}return t.prototype.get=function(t){return this.createTransaction(function(e){return e.get(t)})},t.prototype.getIndex=function(t,e){return this.createTransaction(function(n){return n.index(t).get(e)})},t.prototype.put=function(t){return this.createTransaction(function(e){return e.put(t)},"readwrite")},t.prototype.delete=function(t){return this.createTransaction(function(e){return e.delete(t)},"readwrite")},t.prototype.closeDatabase=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:t.sent().close(),this.dbPromise=null,t.label=2;case 2:return[2]}})})},t.prototype.createTransaction=function(t,e){return void 0===e&&(e="readonly"),Jr(this,void 0,void 0,function(){var n,r,i,o;return $r(this,function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,e),i=r.objectStore(this.objectStoreName),[4,(s=t(i),new Promise(function(t,e){s.onsuccess=function(){t(s.result)},s.onerror=function(){e(s.error)}}))];case 2:return o=a.sent(),[2,new Promise(function(t,e){r.oncomplete=function(){t(o)},r.onerror=function(){e(r.error)}})]}var s})})},t.prototype.getDb=function(){var t=this;return this.dbPromise||(this.dbPromise=new Promise(function(e,n){var r=indexedDB.open(t.dbName,t.dbVersion);r.onsuccess=function(){e(r.result)},r.onerror=function(){t.dbPromise=null,n(r.error)},r.onupgradeneeded=function(e){return t.onDbUpgrade(r,e)}})),this.dbPromise},t}(),Qb=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_token_details_db",e.dbVersion=3,e.objectStoreName="fcm_token_object_Store",e}return Yr(e,t),e.prototype.onDbUpgrade=function(t,e){var n=t.result;switch(e.oldVersion){case 0:(r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:!function(){var t=indexedDB.open(Bb);t.onerror=function(t){},t.onsuccess=function(e){!function(t){if(t.objectStoreNames.contains(Wb)){var e=t.transaction(Wb).objectStore(Wb),n=new Vb,r=e.openCursor();r.onerror=function(t){console.warn("Unable to cleanup old IDB.",t)},r.onsuccess=function(){var e=r.result;if(e){var i=e.value;n.deleteToken(i.fcmSenderId,i.fcmToken,i.fcmPushSet),e.continue()}else t.close(),indexedDB.deleteDatabase(Bb)}}}(t.result)}}();case 2:var r,i=(r=t.transaction.objectStore(this.objectStoreName)).openCursor();i.onsuccess=function(){var t=i.result;if(t){var e=t.value,n=Xr({},e);e.createTime||(n.createTime=Date.now()),"string"==typeof e.vapidKey&&(n.vapidKey=jb(e.vapidKey)),"string"==typeof e.auth&&(n.auth=jb(e.auth).buffer),"string"==typeof e.auth&&(n.p256dh=jb(e.p256dh).buffer),t.update(n),t.continue()}}}},e.prototype.getTokenDetailsFromToken=function(t){return Jr(this,void 0,void 0,function(){return $r(this,function(e){if(!t)throw Mb.create("bad-token");return Hb({fcmToken:t}),[2,this.getIndex("fcmToken",t)]})})},e.prototype.getTokenDetailsFromSWScope=function(t){return Jr(this,void 0,void 0,function(){return $r(this,function(e){if(!t)throw Mb.create("bad-scope");return Hb({swScope:t}),[2,this.get(t)]})})},e.prototype.saveTokenDetails=function(t){return Jr(this,void 0,void 0,function(){return $r(this,function(e){if(!t.swScope)throw Mb.create("bad-scope");if(!t.vapidKey)throw Mb.create("bad-vapid-key");if(!t.endpoint||!t.auth||!t.p256dh)throw Mb.create("bad-subscription");if(!t.fcmSenderId)throw Mb.create("bad-sender-id");if(!t.fcmToken)throw Mb.create("bad-token");if(!t.fcmPushSet)throw Mb.create("bad-push-set");return Hb(t),[2,this.put(t)]})})},e.prototype.deleteToken=function(t){return Jr(this,void 0,void 0,function(){var e;return $r(this,function(n){switch(n.label){case 0:return"string"!=typeof t||0===t.length?[2,Promise.reject(Mb.create("invalid-delete-token"))]:[4,this.getTokenDetailsFromToken(t)];case 1:if(!(e=n.sent()))throw Mb.create("delete-token-not-found");return[4,this.delete(e.swScope)];case 2:return n.sent(),[2,e]}})})},e}(Kb);function Hb(t){if(t.fcmToken&&("string"!=typeof t.fcmToken||0===t.fcmToken.length))throw Mb.create("bad-token");if(t.swScope&&("string"!=typeof t.swScope||0===t.swScope.length))throw Mb.create("bad-scope");if(t.vapidKey&&(!(t.vapidKey instanceof Uint8Array)||65!==t.vapidKey.length))throw Mb.create("bad-vapid-key");if(t.endpoint&&("string"!=typeof t.endpoint||0===t.endpoint.length))throw Mb.create("bad-subscription");if(t.auth&&!(t.auth instanceof ArrayBuffer))throw Mb.create("bad-subscription");if(t.p256dh&&!(t.p256dh instanceof ArrayBuffer))throw Mb.create("bad-subscription");if(t.fcmSenderId&&("string"!=typeof t.fcmSenderId||0===t.fcmSenderId.length))throw Mb.create("bad-sender-id");if(t.fcmPushSet&&("string"!=typeof t.fcmPushSet||0===t.fcmPushSet.length))throw Mb.create("bad-push-set")}var Gb=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}return Yr(e,t),e.prototype.onDbUpgrade=function(t){t.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},e.prototype.getVapidFromSWScope=function(t){return Jr(this,void 0,void 0,function(){var e;return $r(this,function(n){switch(n.label){case 0:if("string"!=typeof t||0===t.length)throw Mb.create("bad-scope");return[4,this.get(t)];case 1:return[2,(e=n.sent())?e.vapidKey:void 0]}})})},e.prototype.saveVapidDetails=function(t,e){return Jr(this,void 0,void 0,function(){var n;return $r(this,function(r){if("string"!=typeof t||0===t.length)throw Mb.create("bad-scope");if(null===e||65!==e.length)throw Mb.create("bad-vapid-key");return n={swScope:t,vapidKey:e},[2,this.put(n)]})})},e.prototype.deleteVapidDetails=function(t){return Jr(this,void 0,void 0,function(){var e;return $r(this,function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(t)];case 1:if(!(e=n.sent()))throw Mb.create("delete-scope-not-found");return[4,this.delete(t)];case 2:return n.sent(),[2,e]}})})},e}(Kb),zb="messagingSenderId",Yb=function(){function t(t){var e=this;if(!t.options[zb]||"string"!=typeof t.options[zb])throw Mb.create("bad-sender-id");this.messagingSenderId=t.options[zb],this.tokenDetailsModel=new Qb,this.vapidDetailsModel=new Gb,this.iidModel=new Vb,this.app=t,this.INTERNAL={delete:function(){return e.delete()}}}return t.prototype.getToken=function(){return Jr(this,void 0,void 0,function(){var t,e,n,r,i;return $r(this,function(o){switch(o.label){case 0:if("denied"===(t=this.getNotificationPermission_()))throw Mb.create("notifications-blocked");return"granted"!==t?[2,null]:[4,this.getSWRegistration_()];case 1:return e=o.sent(),[4,this.getPublicVapidKey_()];case 2:return n=o.sent(),[4,this.getPushSubscription(e,n)];case 3:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(e.scope)];case 4:return(i=o.sent())?[2,this.manageExistingToken(e,r,n,i)]:[2,this.getNewToken(e,r,n)]}})})},t.prototype.manageExistingToken=function(t,e,n,r){return Jr(this,void 0,void 0,function(){return $r(this,function(i){switch(i.label){case 0:return function(t,e,n){if(!n.vapidKey||!Ub(e.buffer,n.vapidKey.buffer))return!1;var r=t.endpoint===n.endpoint,i=Ub(t.getKey("auth"),n.auth),o=Ub(t.getKey("p256dh"),n.p256dh);return r&&i&&o}(e,n,r)?Date.now()<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(t,e,n,r)]:[4,this.deleteTokenFromDB(r.fcmToken)];case 1:return i.sent(),[2,this.getNewToken(t,e,n)]}})})},t.prototype.updateToken=function(t,e,n,r){return Jr(this,void 0,void 0,function(){var i,o,a;return $r(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,r.fcmToken,r.fcmPushSet,e,n)];case 1:return i=s.sent(),o={swScope:t.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:i,fcmPushSet:r.fcmPushSet,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}})})},t.prototype.getNewToken=function(t,e,n){return Jr(this,void 0,void 0,function(){var r,i;return $r(this,function(o){switch(o.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,e,n)];case 1:return r=o.sent(),i={swScope:t.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:r.token,fcmPushSet:r.pushSet,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return o.sent(),[2,r.token]}})})},t.prototype.deleteToken=function(t){return Jr(this,void 0,void 0,function(){var e,n;return $r(this,function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(t)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return(e=r.sent())?[4,e.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent())return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}})})},t.prototype.deleteTokenFromDB=function(t){return Jr(this,void 0,void 0,function(){var e;return $r(this,function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(t)];case 1:return e=n.sent(),[4,this.iidModel.deleteToken(e.fcmSenderId,e.fcmToken,e.fcmPushSet)];case 2:return n.sent(),[2]}})})},t.prototype.getPushSubscription=function(t,e){return t.pushManager.getSubscription().then(function(n){return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})})},t.prototype.requestPermission=function(){throw Mb.create("only-available-in-window")},t.prototype.useServiceWorker=function(t){throw Mb.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){throw Mb.create("only-available-in-window")},t.prototype.onMessage=function(t,e,n){throw Mb.create("only-available-in-window")},t.prototype.onTokenRefresh=function(t,e,n){throw Mb.create("only-available-in-window")},t.prototype.setBackgroundMessageHandler=function(t){throw Mb.create("only-available-in-sw")},t.prototype.delete=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return t.sent(),[2]}})})},t.prototype.getNotificationPermission_=function(){return Notification.permission},t.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},t.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},t.prototype.getIidModel=function(){return this.iidModel},t}(),Xb="FCM_MSG",Jb=function(t){function e(e){var n=t.call(this,e)||this;return n.bgMessageHandler=null,self.addEventListener("push",function(t){n.onPush(t)}),self.addEventListener("pushsubscriptionchange",function(t){n.onSubChange(t)}),self.addEventListener("notificationclick",function(t){n.onNotificationClick(t)}),n}return Yr(e,t),e.prototype.onPush=function(t){t.waitUntil(this.onPush_(t))},e.prototype.onSubChange=function(t){t.waitUntil(this.onSubChange_(t))},e.prototype.onNotificationClick=function(t){t.waitUntil(this.onNotificationClick_(t))},e.prototype.onPush_=function(t){return Jr(this,void 0,void 0,function(){var e,n,r,i,o,a;return $r(this,function(s){switch(s.label){case 0:if(!t.data)return[2];try{e=t.data.json()}catch(s){return[2]}return[4,this.hasVisibleClients_()];case 1:return s.sent()?[2,this.sendMessageToWindowClients_(e)]:(n=this.getNotificationData_(e))?(r=n.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return i=s.sent(),o=n.actions,a=Notification.maxActions,o&&a&&o.length>a&&console.warn("This browser only supports "+a+" actions.The remaining actions will not be displayed."),[2,i.showNotification(r,n)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(e)]:[3,5];case 4:return s.sent(),[2];case 5:return[2]}})})},e.prototype.onSubChange_=function(t){return Jr(this,void 0,void 0,function(){var t,e,n,r;return $r(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=i.sent(),[3,3];case 2:throw e=i.sent(),Mb.create("unable-to-resubscribe",{errorInfo:e});case 3:return i.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return i.sent(),[3,8];case 5:return n=i.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(t.scope)];case 6:if(!(r=i.sent()))throw n;return[4,this.deleteToken(r.fcmToken)];case 7:throw i.sent(),n;case 8:return[2]}})})},e.prototype.onNotificationClick_=function(t){return Jr(this,void 0,void 0,function(){var e,n,r,i;return $r(this,function(o){switch(o.label){case 0:return t.notification&&t.notification.data&&t.notification.data[Xb]?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(e=t.notification.data[Xb]).notification&&(n=e.fcmOptions&&e.fcmOptions.link||e.notification.click_action)?[4,this.getWindowClient_(n)]:[2]):[2];case 1:return(r=o.sent())?[3,3]:[4,self.clients.openWindow(n)];case 2:return r=o.sent(),[3,5];case 3:return[4,r.focus()];case 4:r=o.sent(),o.label=5;case 5:return r?(delete e.notification,delete e.fcmOptions,i=Zb(xb.NOTIFICATION_CLICKED,e),[2,this.attemptToMessageClient_(r,i)]):[2]}})})},e.prototype.getNotificationData_=function(t){var e;if(t&&"object"==typeof t.notification){var n=Xr({},t.notification);return n.data=Xr({},t.notification.data,((e={})[Xb]=t,e)),n}},e.prototype.setBackgroundMessageHandler=function(t){if(!t||"function"!=typeof t)throw Mb.create("bg-handler-function-expected");this.bgMessageHandler=t},e.prototype.getWindowClient_=function(t){return Jr(this,void 0,void 0,function(){var e,n,r,i;return $r(this,function(o){switch(o.label){case 0:return e=new URL(t,self.location.href).href,[4,$b()];case 1:for(n=o.sent(),r=null,i=0;i<n.length;i++)if(new URL(n[i].url,self.location.href).href===e){r=n[i];break}return[2,r]}})})},e.prototype.attemptToMessageClient_=function(t,e){return Jr(this,void 0,void 0,function(){return $r(this,function(n){if(!t)throw Mb.create("no-window-client-to-msg");return t.postMessage(e),[2]})})},e.prototype.hasVisibleClients_=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){switch(t.label){case 0:return[4,$b()];case 1:return[2,t.sent().some(function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")})]}})})},e.prototype.sendMessageToWindowClients_=function(t){return Jr(this,void 0,void 0,function(){var e,n,r=this;return $r(this,function(i){switch(i.label){case 0:return[4,$b()];case 1:return e=i.sent(),n=Zb(xb.PUSH_MSG_RECEIVED,t),[4,Promise.all(e.map(function(t){return r.attemptToMessageClient_(t,n)}))];case 2:return i.sent(),[2]}})})},e.prototype.getSWRegistration_=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){return[2,self.registration]})})},e.prototype.getPublicVapidKey_=function(){return Jr(this,void 0,void 0,function(){var t,e;return $r(this,function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(t=n.sent()))throw Mb.create("sw-registration-expected");return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return null==(e=n.sent())?[2,Lb]:[2,e]}})})},e}(Yb);function $b(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Zb(t,e){var n;return(n={})[Db.TYPE_OF_MSG]=t,n[Db.DATA]=e,n}var tw,ew=function(t){function e(e){var n=t.call(this,e)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.manifestCheckPromise=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=Ni(function(t){n.messageObserver=t}),n.onTokenRefreshInternal=Ni(function(t){n.tokenRefreshObserver=t}),n.setupSWMessageListener_(),n}return Yr(e,t),e.prototype.getToken=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(e){switch(e.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=function(){return Jr(this,void 0,void 0,function(){var t,e;return $r(this,function(n){switch(n.label){case 0:if(!(t=document.querySelector('link[rel="manifest"]')))return[2];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,fetch(t.href)];case 2:return[4,n.sent().json()];case 3:return e=n.sent(),[3,5];case 4:return n.sent(),[2];case 5:if(!e||!e.gcm_sender_id)return[2];if("103953800507"!==e.gcm_sender_id)throw Mb.create("incorrect-gcm-sender-id");return[2]}})})}()),[4,this.manifestCheckPromise];case 1:return e.sent(),[2,t.prototype.getToken.call(this)]}})})},e.prototype.requestPermission=function(){return Jr(this,void 0,void 0,function(){var t;return $r(this,function(e){switch(e.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?Mb.create("permission-blocked"):Mb.create("permission-default")}})})},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw Mb.create("sw-registration-expected");if(null!=this.registrationToUse)throw Mb.create("use-sw-before-get-token");this.registrationToUse=t},e.prototype.usePublicVapidKey=function(t){if("string"!=typeof t)throw Mb.create("invalid-public-vapid-key");if(null!=this.publicVapidKeyToUse)throw Mb.create("use-public-key-before-get-token");var e=jb(t);if(65!==e.length)throw Mb.create("public-vapid-key-decryption-failed");this.publicVapidKeyToUse=e},e.prototype.onMessage=function(t,e,n){return"function"==typeof t?this.onMessageInternal(t,e,n):this.onMessageInternal(t)},e.prototype.onTokenRefresh=function(t,e,n){return"function"==typeof t?this.onTokenRefreshInternal(t,e,n):this.onTokenRefreshInternal(t)},e.prototype.waitForRegistrationToActivate_=function(t){var e=t.installing||t.waiting||t.active;return new Promise(function(n,r){if(e)if("activated"!==e.state)if("redundant"!==e.state){var i=function(){if("activated"===e.state)n(t);else{if("redundant"!==e.state)return;r(Mb.create("sw-reg-redundant"))}e.removeEventListener("statechange",i)};e.addEventListener("statechange",i)}else r(Mb.create("sw-reg-redundant"));else n(t);else r(Mb.create("no-sw-in-reg"))})},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch(function(t){throw Mb.create("failed-serviceworker-registration",{browserErrorMessage:t.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return(t.registrationToUse=e).update(),e})}))},e.prototype.getPublicVapidKey_=function(){return Jr(this,void 0,void 0,function(){return $r(this,function(t){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,Lb]})})},e.prototype.setupSWMessageListener_=function(){var t=this;navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[Db.TYPE_OF_MSG]){var n=e.data;switch(n[Db.TYPE_OF_MSG]){case xb.PUSH_MSG_RECEIVED:case xb.NOTIFICATION_CLICKED:var r=n[Db.DATA];t.messageObserver&&t.messageObserver.next(r)}}},!1)},e}(Yb);function nw(){return self&&"ServiceWorkerGlobalScope"in self?"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}tw={isSupported:nw},$i.INTERNAL.registerService("messaging",function(t){if(!nw())throw Mb.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Jb(t):new ew(t)},tw);var rw="firebasestorage.googleapis.com",iw="storageBucket",ow=function(){function t(t,e){this.code_=sw(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return sw(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),aw={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function sw(t){return"storage/"+t}function uw(){return new ow(aw.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function cw(){return new ow(aw.CANCELED,"User canceled the upload/download.")}function lw(){return new ow(aw.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function hw(t,e,n){return new ow(aw.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function fw(){return new ow(aw.APP_DELETED,"The Firebase app was deleted.")}function pw(t,e){return new ow(aw.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function dw(t){throw new ow(aw.INTERNAL_ERROR,"Internal error: "+t)}var yw={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function mw(t){switch(t){case yw.RAW:case yw.BASE64:case yw.BASE64URL:case yw.DATA_URL:return;default:throw"Expected one of the event types: ["+yw.RAW+", "+yw.BASE64+", "+yw.BASE64URL+", "+yw.DATA_URL+"]."}}var gw=function(t,e){this.data=t,this.contentType=e||null};function vw(t,e){switch(t){case yw.RAW:return new gw(bw(e));case yw.BASE64:case yw.BASE64URL:return new gw(ww(t,e));case yw.DATA_URL:return new gw((n=new Ew(e)).base64?ww(yw.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw pw(yw.DATA_URL,"Malformed data URL.")}return bw(e)}(n.rest),new Ew(e).contentType)}var n;throw uw()}function bw(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function ww(t,e){switch(t){case yw.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw pw(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case yw.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw pw(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw pw(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var _w,Tw,Ew=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw pw(yw.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r,i=e[1]||null;null!=i&&(this.base64=(r=";base64",(n=i).length>=r.length&&n.substring(n.length-r.length)===r),this.contentType=this.base64?i.substring(0,i.length-";base64".length):i),this.rest=t.substring(t.indexOf(",")+1)},Sw={STATE_CHANGED:"state_changed"},Cw="running",Iw="pausing",Nw="paused",Aw="success",kw="canceling",Dw="canceled",Rw="error",xw={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Ow(t){switch(t){case Cw:case Iw:case kw:return xw.RUNNING;case Nw:return xw.PAUSED;case Aw:return xw.SUCCESS;case Dw:return xw.CANCELED;case Rw:default:return xw.ERROR}}function Pw(t){return null!=t}function Mw(t){return void 0!==t}function Lw(t){return"function"==typeof t}function Fw(t){return"object"==typeof t}function Uw(t){return"string"==typeof t||t instanceof String}function qw(t){return"number"==typeof t||t instanceof Number}function Vw(t){return jw()&&t instanceof Blob}function jw(){return"undefined"!=typeof Blob}(Tw=_w||(_w={}))[Tw.NO_ERROR=0]="NO_ERROR",Tw[Tw.NETWORK_ERROR=1]="NETWORK_ERROR",Tw[Tw.ABORT=2]="ABORT";var Bw=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=_w.NO_ERROR,this.sendPromise_=new Promise(function(e){t.xhr_.addEventListener("abort",function(){t.errorCode_=_w.ABORT,e(t)}),t.xhr_.addEventListener("error",function(){t.errorCode_=_w.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(){e(t)})})}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw dw("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),Pw(r))for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return Pw(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw dw("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw dw("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw dw("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){Pw(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){Pw(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Ww=function(){function t(){}return t.prototype.createXhrIo=function(){return new Bw},t}();var Kw=function(){function t(t,e){var n=0,r="";Vw(t)?(n=(this.data_=t).size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(Vw(this.data_)){var r=(o=e,a=n,(i=this.data_).webkitSlice?i.webkitSlice(o,a):i.mozSlice?i.mozSlice(o,a):i.slice?i.slice(o,a):null);return null===r?null:new t(r)}var i,o,a;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(jw()){var r=e.map(function(e){return e instanceof t?e.data_:e});return new t(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(jw())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}.apply(null,r))}var i=e.map(function(t){return Uw(t)?vw(yw.RAW,t).data:t.data_}),o=0;i.forEach(function(t){o+=t.byteLength});var a=new Uint8Array(o),s=0;return i.forEach(function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]}),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Qw=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n,r;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw r=e,new ow(aw.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")},t.makeFromUrl=function(e){for(var n,r=null,i="([A-Za-z0-9.\\-_]+)",o=new RegExp("^gs://"+i+"(/(.*))?$","i"),a=rw.replace(/[.]/g,"\\."),s=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+a+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(t){t.path_=decodeURIComponent(t.path)}}],u=0;u<s.length;u++){var c=s[u],l=c.regex.exec(e);if(l){var h=l[c.indices.bucket],f=l[c.indices.path];f||(f=""),r=new t(h,f),c.postModify(r);break}}if(null==r)throw n=e,new ow(aw.INVALID_URL,"Invalid URL '"+n+"'.");return r},t}();function Hw(t){var e,n;try{e=JSON.parse(t)}catch(t){return null}return Fw(n=e)&&!Array.isArray(n)?e:null}function Gw(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function zw(t){return"https://"+rw+"/v0"+t}function Yw(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}function Xw(t,e){return e}var Jw=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Xw},$w=null;function Zw(t,e,n){var r=Hw(e);return null===r?null:function(t,e,n){for(var r,i,o={type:"file"},a=n.length,s=0;s<a;s++){var u=n[s];o[u.local]=u.xform(o,e[u.server])}return r=o,i=t,Object.defineProperty(r,"ref",{get:function(){var t=r.bucket,e=r.fullPath,n=new Qw(t,e);return i.makeStorageReference(n)}}),o}(t,r,n)}function t_(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function e_(t){if(!Fw(t)||!t)throw"Expected Metadata object.";for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if("customMetadata"===e){if(!Fw(n))throw"Expected object for 'customMetadata' mapping."}else if(Fw(r=n)&&null!==r)throw"Mapping for '"+e+"' cannot be an object."}var r}var n_="maxResults",r_=1e3,i_="pageToken",o_="prefixes",a_="items";function s_(t){if(!Fw(t)||!t)throw"Expected ListOptions object.";for(var e in t)if(e===n_){if(!qw(n=t[n_])||!Number.isInteger(n)||t[n_]<=0)throw"Expected maxResults to be a positive number.";if(1e3<t[n_])throw"Expected maxResults to be less than or equal to "+r_+"."}else{if(e!==i_)throw"Unknown option: "+e;if(t[i_]&&!Uw(t[i_]))throw"Expected pageToken to be string."}var n}var u_=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function c_(t){if(!t)throw uw()}function l_(t,e){return function(n,r){var i=Zw(t,r,e);return c_(null!==i),i}}function h_(t){return function(e,n){var r,i,o=(r=t,null===(i=Hw(n))?null:function(t,e){var n,r,i,o,a={prefixes:[],items:[],nextPageToken:e.nextPageToken},s=t.bucket();if(null===s)throw new ow(aw.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+iw+"' property when initializing the app?");if(e[o_])try{for(var u=Zr(e[o_]),c=u.next();!c.done;c=u.next()){var l=c.value.replace(/\/$/,""),h=t.makeStorageReference(new Qw(s,l));a.prefixes.push(h)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}if(e[a_])try{for(var f=Zr(e[a_]),p=f.next();!p.done;p=f.next()){var d=p.value;h=t.makeStorageReference(new Qw(s,d.name)),a.items.push(h)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}return a}(r,i));return c_(null!==o),o}}function f_(t){return function(e,n){var r,i,o;return(r=401===e.getStatus()?new ow(aw.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,new ow(aw.QUOTA_EXCEEDED,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,new ow(aw.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):n).setServerResponseProp(n.serverResponseProp()),r}}function p_(t){var e=f_(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new ow(aw.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),o.setServerResponseProp(r.serverResponseProp()),o}}function d_(t,e,n){var r=zw(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new u_(r,"GET",l_(t,n),i);return o.errorHandler=p_(e),o}function y_(t,e,n){var r,i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=(r=e,null&&null.contentType||r&&r.type()||"application/octet-stream")),i}var m_=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function g_(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){c_(!1)}return c_(!!n&&-1!==(e||["active"]).indexOf(n)),n}var v_=function(t,e,n){if(Lw(t)||Pw(e)||Pw(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}},b_=function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o};function w_(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}var a,s,u,c,l,h;if(!(r<=n.length&&n.length<=i))throw a=r,s=i,u=t,c=n.length,h=a===s?1===(l=a)?"argument":"arguments":(l="between "+a+" and "+s,"arguments"),new ow(aw.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+u+"`: Expected "+l+" "+h+", received "+c+".");for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(e){throw e instanceof Error?hw(o,t,e.message):hw(o,t,e)}}var __=function(t,e){var n=this;this.validator=function(e){n.optional&&!Mw(e)||t(e)},this.optional=!!e};function T_(t,e){function n(t){if(!Uw(t))throw"Expected string."}var r,i,o;return r=t?(i=n,o=t,function(t){i(t),o(t)}):n,new __(r,e)}function E_(t){return new __(e_,t)}function S_(){return new __(function(t){if(!(qw(t)&&0<=t))throw"Expected a number 0 or greater."})}function C_(t,e){return new __(function(e){if(!(null===e||Pw(e)&&e instanceof Object))throw"Expected an Object.";null!=t&&t(e)},e)}function I_(t){return new __(function(t){if(null!==t&&!Lw(t))throw"Expected a Function."},t)}function N_(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then(function(){return t.apply(void 0,ei(e))})}}var A_=function(){function t(t,e,n,r,i,o){var a=this;void 0===o&&(o=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=Cw,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(aw.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(Rw))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(aw.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(Rw))},this.promise_=new Promise(function(t,e){a.resolve_=t,a.reject_=e,a.start_()}),this.promise_.then(null,function(){})}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n){return t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return 262144<t.size()},t.prototype.start_=function(){this.state_===Cw&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then(function(n){switch(e.state_){case Cw:t(n);break;case kw:e.transition_(Dw);break;case Iw:e.transition_(Nw)}})},t.prototype.createResumable_=function(){var t=this;this.resolveToken_(function(e){var n,r,i,o,a,s,u,c,l,h,f,p,d,y=(n=t.authWrapper_,r=t.location_,i=t.mappings_,o=t.blob_,a=t.metadata_,s=r.bucketOnlyServerUrl(),c={name:(u=y_(r,o,a)).fullPath},l=zw(s),h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":o.size(),"X-Goog-Upload-Header-Content-Type":u.contentType,"Content-Type":"application/json; charset=utf-8"},f=t_(u,i),p=n.maxUploadRetryTime(),(d=new u_(l,"POST",function(t){var e;g_(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){c_(!1)}return c_(Uw(e)),e},p)).urlParams=c,d.headers=h,d.body=f,d.errorHandler=f_(r),d),m=t.authWrapper_.makeRequest(y,e);(t.request_=m).getPromise().then(function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()},t.errorHandler_)})},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_(function(n){var r,i,o,a,s,u,c=(r=t.authWrapper_,i=t.location_,o=e,a=t.blob_,s=r.maxUploadRetryTime(),(u=new u_(o,"POST",function(t){var e=g_(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){c_(!1)}n||c_(!1);var r=Number(n);return c_(!isNaN(r)),new m_(r,a.size(),"final"===e)},s)).headers={"X-Goog-Upload-Command":"query"},u.errorHandler=f_(i),u),l=t.authWrapper_.makeRequest(c,n);(t.request_=l).getPromise().then(function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()},t.errorHandler_)})},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new m_(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=function(t,e,n,r,i,o,a,s){var u=new m_(0,0);if(u.total=a?(u.current=a.current,a.total):(u.current=0,r.size()),r.size()!==u.total)throw new ow(aw.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;0<i&&(l=Math.min(l,i));var h=u.current,f=h+l,p={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(h,f);if(null===d)throw lw();var y=e.maxUploadRetryTime(),m=new u_(n,"POST",function(t,n){var i,a=g_(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?l_(e,o)(t,n):null,new m_(s,c,"final"===a,i)},y);return m.headers=p,m.body=d.uploadData(),m.progressCallback=s||null,m.errorHandler=f_(t),m}(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(i){return t.error_=i,void t.transition_(Rw)}var a=t.authWrapper_.makeRequest(o,i);(t.request_=a).getPromise().then(function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(Aw)):t.completeTransitions_()},t.errorHandler_)})},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_(function(e){var n=d_(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);(t.request_=r).getPromise().then(function(e){t.request_=null,t.metadata_=e,t.transition_(Aw)},t.metadataErrorHandler_)})},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=y_(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+t_(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=Kw.getBlob(c,r,l);if(null===h)throw lw();var f={name:u.fullPath},p=zw(o),d=t.maxUploadRetryTime(),y=new u_(p,"POST",l_(t,n),d);return y.urlParams=f,y.headers=a,y.body=h.uploadData(),y.errorHandler=f_(e),y}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);(t.request_=r).getPromise().then(function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(Aw)},t.errorHandler_)})},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case kw:case Iw:this.state_=t,null!==this.request_&&this.request_.cancel();break;case Cw:var e=this.state_===Nw;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case Nw:this.state_=t,this.notifyObservers_();break;case Dw:this.error_=cw(),this.state_=t,this.notifyObservers_();break;case Rw:case Aw:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case Iw:this.transition_(Nw);break;case kw:this.transition_(Dw);break;case Cw:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=Ow(this.state_);return new b_(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){var i="Expected a function or an Object with one of `next`, `error`, `complete` properties.",o=I_(!0).validator,a=C_(null,!0).validator;function s(t){try{return void o(t)}catch(t){}try{if(a(t),!(Mw(t.next)||Mw(t.error)||Mw(t.complete)))throw"";return}catch(t){throw i}}w_("on",[T_(function(){if(t!==Sw.STATE_CHANGED)throw"Expected one of the event types: ["+Sw.STATE_CHANGED+"]."}),C_(s,!0),I_(!0),I_(!0)],arguments);var u=this;function c(t){return function(e,n,i){null!==t&&w_("on",t,arguments);var o=new v_(e,n,r);return u.addObserver_(o),function(){u.removeObserver_(o)}}}var l=[C_(function(t){if(null===t)throw i;s(t)}),I_(!0),I_(!0)];return Mw(e)||Mw(n)||Mw(r)?c(null)(e,n,r):c(l)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);-1!==e&&this.observers_.splice(e,1)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),this.observers_.slice().forEach(function(e){t.notifyObserver_(e)})},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(Ow(this.state_)){case xw.SUCCESS:N_(this.resolve_.bind(null,this.snapshot))();break;case xw.CANCELED:case xw.ERROR:N_(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(Ow(this.state_)){case xw.RUNNING:case xw.PAUSED:t.next&&N_(t.next.bind(t,this.snapshot))();break;case xw.SUCCESS:t.complete&&N_(t.complete.bind(t))();break;case xw.CANCELED:case xw.ERROR:t.error&&N_(t.error.bind(t,this.error_))();break;default:t.error&&N_(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){w_("resume",[],arguments);var t=this.state_===Nw||this.state_===Iw;return t&&this.transition_(Cw),t},t.prototype.pause=function(){w_("pause",[],arguments);var t=this.state_===Cw;return t&&this.transition_(Iw),t},t.prototype.cancel=function(){w_("cancel",[],arguments);var t=this.state_===Cw||this.state_===Iw;return t&&this.transition_(kw),t},t}(),k_=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof Qw?e:Qw.makeFromUrl(e)}return t.prototype.toString=function(){return w_("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return function(){if($w)return $w;var t=[];t.push(new Jw("bucket")),t.push(new Jw("generation")),t.push(new Jw("metageneration")),t.push(new Jw("name","fullPath",!0));var e=new Jw("name");e.xform=function(t,e){return!Uw(n=e)||n.length<2?n:Gw(n);var n},t.push(e);var n=new Jw("size");return n.xform=function(t,e){return Pw(e)?Number(e):e},t.push(n),t.push(new Jw("timeCreated")),t.push(new Jw("updated")),t.push(new Jw("md5Hash",null,!0)),t.push(new Jw("cacheControl",null,!0)),t.push(new Jw("contentDisposition",null,!0)),t.push(new Jw("contentEncoding",null,!0)),t.push(new Jw("contentLanguage",null,!0)),t.push(new Jw("contentType",null,!0)),t.push(new Jw("metadata","customMetadata",!0)),$w=t}()},t.prototype.child=function(t){w_("child",[T_()],arguments);var e,n,r=(e=this.location.path,n=t.split("/").filter(function(t){return 0<t.length}).join("/"),0===e.length?n:e+"/"+n),i=new Qw(this.location.bucket,r);return this.newRef(this.authWrapper,i)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new Qw(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new Qw(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Gw(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),w_("put",[new __(function(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||jw()&&t instanceof Blob))throw"Expected Blob or File."}),E_(!0)],arguments),this.throwIfRoot_("put"),new A_(this,this.authWrapper,this.location,this.mappings(),new Kw(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=yw.RAW),w_("putString",[T_(),T_(mw,!0),E_(!0)],arguments),this.throwIfRoot_("putString");var r=vw(e,t),i=Object.assign({},n);return!Pw(i.contentType)&&Pw(r.contentType)&&(i.contentType=r.contentType),new A_(this,this.authWrapper,this.location,this.mappings(),new Kw(r.data,!0),i)},t.prototype.delete=function(){var t=this;return w_("delete",[],arguments),this.throwIfRoot_("delete"),this.authWrapper.getAuthToken().then(function(e){var n,r,i,o,a,s=(n=t.authWrapper,i=zw((r=t.location).fullServerUrl()),o=n.maxOperationRetryTime(),(a=new u_(i,"DELETE",function(t,e){},o)).successCodes=[200,204],a.errorHandler=p_(r),a);return t.authWrapper.makeRequest(s,e).getPromise()})},t.prototype.listAll=function(){w_("listAll",[],arguments);var t={prefixes:[],items:[]};return this.listAllHelper(t).then(function(){return t})},t.prototype.listAllHelper=function(t,e){return Jr(this,void 0,void 0,function(){var n,r,i,o;return $r(this,function(a){switch(a.label){case 0:return i={pageToken:e},[4,this.list(i)];case 1:return o=a.sent(),(n=t.prefixes).push.apply(n,ei(o.prefixes)),(r=t.items).push.apply(r,ei(o.items)),null==o.nextPageToken?[3,3]:[4,this.listAllHelper(t,o.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.list=function(t){w_("list",[(!0,new __(s_,!0))],arguments);var e=this;return this.authWrapper.getAuthToken().then(function(n){var r=t||{},i=function(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",0<"/".length&&(o.delimiter="/"),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=zw(e.bucketOnlyServerUrl()),s=t.maxOperationRetryTime(),u=new u_(a,"GET",h_(t),s);return u.urlParams=o,u.errorHandler=f_(e),u}(e.authWrapper,e.location,0,r.pageToken,r.maxResults);return e.authWrapper.makeRequest(i,n).getPromise()})},t.prototype.getMetadata=function(){var t=this;return w_("getMetadata",[],arguments),this.throwIfRoot_("getMetadata"),this.authWrapper.getAuthToken().then(function(e){var n=d_(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){var e=this;return w_("updateMetadata",[E_()],arguments),this.throwIfRoot_("updateMetadata"),this.authWrapper.getAuthToken().then(function(n){var r,i,o,a,s,u,c,l,h=(r=e.authWrapper,i=e.location,o=t,a=e.mappings(),s=zw(i.fullServerUrl()),u=t_(o,a),c=r.maxOperationRetryTime(),(l=new u_(s,"PATCH",l_(r,a),c)).headers={"Content-Type":"application/json; charset=utf-8"},l.body=u,l.errorHandler=p_(i),l);return e.authWrapper.makeRequest(h,n).getPromise()})},t.prototype.getDownloadURL=function(){var t=this;return w_("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.authWrapper.getAuthToken().then(function(e){var n,r,i,o,a,s,u=(n=t.authWrapper,r=t.location,i=t.mappings(),o=zw(r.fullServerUrl()),a=n.maxOperationRetryTime(),(s=new u_(o,"GET",function(t,e){return function(n,r){var i=Zw(t,r,e);return c_(null!==i),function(t,e){var n=Hw(e);if(null===n)return null;if(!Uw(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map(function(e){var n=t.bucket,r=t.fullPath;return zw("/b/"+i(n)+"/o/"+i(r))+Yw({alt:"media",token:e})})[0]}(i,r)}}(n,i),a)).errorHandler=p_(r),s);return t.authWrapper.makeRequest(u,e).getPromise().then(function(t){if(null===t)throw new ow(aw.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return t})})},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw e=t,new ow(aw.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').");var e},t}(),D_=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){void 0===t&&(t=!1)},t}(),R_=function(){function t(){this.map=new Map,this.id=-9007199254740991}return t.prototype.addRequest=function(t){var e=this,n=this.id;this.id++,this.map.set(n,t),t.getPromise().then(function(){return e.map.delete(n)},function(){return e.map.delete(n)})},t.prototype.clear=function(){this.map.forEach(function(t){t&&t.cancel(!0)}),this.map.clear()},t}(),x_=function(){function t(e,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var a=this.app_.options;Pw(a)&&(this.bucket_=t.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=12e4,this.maxUploadRetryTime_=6e4,this.requestMap_=new R_}return t.extractBucket_=function(t){var e=t[iw]||null;return null==e?null:Qw.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){return null!==this.app_&&Pw(this.app_.INTERNAL)&&Pw(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(t){return null!==t?t.accessToken:null},function(){return null}):Promise.resolve(null)},t.prototype.bucket=function(){if(this.deleted_)throw fw();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new D_(fw());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}(),O_=function(){function t(t,e,n,r,i,o,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise(function(t,e){h.resolve_=t,h.reject_=e,h.start_()})}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());Mw(s)?i(s):i()}catch(e){o(e)}else null!==a?((r=uw()).setServerResponseProp(a.getResponseText()),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?fw():cw()):o(r=new ow(aw.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new P_(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,i=null,o=!1,a=0;function s(){return 2===a}var u=!1;function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u||(u=!0,e.apply(null,t))}function l(e){i=setTimeout(function(){i=null,t(h,s())},e)}function h(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];u||(t?c.call.apply(c,ei([null,t],e)):s()||o?c.call.apply(c,ei([null,t],e)):(r<64&&(r*=2),l(1===a?(a=2,0):1e3*(r+Math.random()))))}var f=!1;function p(t){f||(f=!0,u||(null!==i?(t||(a=2),clearTimeout(i),l(0)):t||(a=1)))}return l(0),setTimeout(function(){p(o=!0)},n),p}(function(e,n){if(n)e(!1,new P_(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then(function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===_w.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new P_(a,n))}else{var s=n.getErrorCode()===_w.ABORT;e(!1,new P_(!1,null,s))}})}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}},e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=500<=t&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),P_=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function M_(t,e,n){var r,i,o,a,s=Yw(t.urlParams),u=t.url+s,c=Object.assign({},t.headers);return r=c,null!==(i=e)&&0<i.length&&(r.Authorization="Firebase "+i),o=c,a=void 0!==$i?$i.SDK_VERSION:"AppManager",o["X-Firebase-Storage-Version"]="webjs/"+a,new O_(u,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}var L_,F_=function(){function t(t,e,n){if(this.bucket_=null,this.authWrapper_=new x_(t,function(t,e){return new k_(t,e)},M_,this,e),this.app_=t,null!=n)this.bucket_=Qw.makeFromBucketSpec(n);else{var r=this.authWrapper_.bucket();null!=r&&(this.bucket_=new Qw(r,""))}this.internals_=new U_(this)}return t.prototype.ref=function(t){if(w_("ref",[T_(function(t){if("string"!=typeof t)throw"Path is not a string.";if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new k_(this.authWrapper_,this.bucket_);return null!=t?e.child(t):e},t.prototype.refFromURL=function(t){return w_("refFromURL",[T_(function(t){if("string"!=typeof t)throw"Path is not a string.";if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{Qw.makeFromUrl(t)}catch(t){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new k_(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){w_("setMaxUploadRetryTime",[S_()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},t.prototype.setMaxOperationRetryTime=function(t){w_("setMaxOperationRetryTime",[S_()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),U_=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),Promise.resolve()},t}();function q_(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function V_(t,e,n){var r,i=new Promise(function(i,o){q_(r=t[e].apply(t,n)).then(i,o)});return i.request=r,i}function j_(t,e,n){n.forEach(function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})})}function B_(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return V_(this[e],r,arguments)})})}function W_(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})})}function K_(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return t=this[e],(n=V_(t,r,arguments)).then(function(t){if(t)return new H_(t,n.request)});var t,n})})}function Q_(t){this._index=t}function H_(t,e){this._cursor=t,this._request=e}function G_(t){this._store=t}function z_(t){this._tx=t,this.complete=new Promise(function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}})}function Y_(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new z_(n)}function X_(t){this._db=t}L_={TaskState:xw,TaskEvent:Sw,StringFormat:yw,Storage:F_,Reference:k_},$i.INTERNAL.registerService("storage",function(t,e,n){return new F_(t,new Ww,n)},L_,void 0,!0),j_(Q_,"_index",["name","keyPath","multiEntry","unique"]),B_(Q_,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),K_(Q_,"_index",IDBIndex,["openCursor","openKeyCursor"]),j_(H_,"_cursor",["direction","key","primaryKey","value"]),B_(H_,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(H_.prototype[t]=function(){var e=this,n=arguments;return Promise.resolve().then(function(){return e._cursor[t].apply(e._cursor,n),q_(e._request).then(function(t){if(t)return new H_(t,e._request)})})})}),G_.prototype.createIndex=function(){return new Q_(this._store.createIndex.apply(this._store,arguments))},G_.prototype.index=function(){return new Q_(this._store.index.apply(this._store,arguments))},j_(G_,"_store",["name","keyPath","indexNames","autoIncrement"]),B_(G_,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),K_(G_,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),W_(G_,"_store",IDBObjectStore,["deleteIndex"]),z_.prototype.objectStore=function(){return new G_(this._tx.objectStore.apply(this._tx,arguments))},j_(z_,"_tx",["objectStoreNames","mode"]),W_(z_,"_tx",IDBTransaction,["abort"]),Y_.prototype.createObjectStore=function(){return new G_(this._db.createObjectStore.apply(this._db,arguments))},j_(Y_,"_db",["name","version","objectStoreNames"]),W_(Y_,"_db",IDBDatabase,["deleteObjectStore","close"]),X_.prototype.transaction=function(){return new z_(this._db.transaction.apply(this._db,arguments))},j_(X_,"_db",["name","version","objectStoreNames"]),W_(X_,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[G_,Q_].forEach(function(e){t in e.prototype&&(e.prototype[t.replace("open","iterate")]=function(){var e,n=(e=arguments,Array.prototype.slice.call(e)),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})})}),[Q_,G_].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise(function(i){n.iterateCursor(t,function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)})})})});var J_,$_=1e4,Z_="w:0.2.0",tT="FIS_v2",eT="https://firebaseinstallations.googleapis.com/v1",nT=36e5,rT=((J_={})["missing-app-config-values"]="Missing App configuration values.",J_["create-installation-failed"]="Could not register Firebase Installation.",J_["generate-token-failed"]="Could not generate Auth Token.",J_["not-registered"]="Firebase Installation is not registered.",J_["installation-not-found"]="Firebase Installation not found.",J_["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',J_["app-offline"]="Could not process request. Application offline.",J_["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",J_),iT=new gi("installations","Installations",rT);function oT(t){return t instanceof mi&&t.code.includes("request-failed")}function aT(t){if(!t||!t.options)throw iT.create("missing-app-config-values");var e=t.name,n=t.options,r=n.projectId,i=n.apiKey,o=n.appId;if(!(e&&r&&i&&o))throw iT.create("missing-app-config-values");return{appName:e,projectId:r,apiKey:i,appId:o}}function sT(t){var e=t.projectId;return eT+"/projects/"+e+"/installations"}function uT(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function cT(t,e){return Jr(this,void 0,void 0,function(){var n,r;return $r(this,function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,iT.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}})})}function lT(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function hT(t,e){var n=e.refreshToken,r=lT(t);return r.append("Authorization",tT+" "+n),r}function fT(t){return Jr(this,void 0,void 0,function(){var e;return $r(this,function(n){switch(n.label){case 0:return[4,t()];case 1:return 500<=(e=n.sent()).status&&e.status<600?[2,t()]:[2,e]}})})}function pT(t){return new Promise(function(e){setTimeout(e,t)})}var dT=/^[cdef][\w-]{21}$/,yT="";var mT="firebase-installations-database",gT=1,vT="firebase-installations-store",bT=null;function wT(){var t,e,n;return bT||(t=function(t){switch(t.oldVersion){case 0:t.createObjectStore(vT)}},e=V_(indexedDB,"open",[mT,gT]),(n=e.request)&&(n.onupgradeneeded=function(e){t&&t(new Y_(n.result,e.oldVersion,n.transaction))}),bT=e.then(function(t){return new X_(t)})),bT}function _T(t,e){return Jr(this,void 0,void 0,function(){var n,r,i;return $r(this,function(o){switch(o.label){case 0:return n=ST(t),[4,wT()];case 1:return r=o.sent(),[4,(i=r.transaction(vT,"readwrite")).objectStore(vT).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}})})}function TT(t){return Jr(this,void 0,void 0,function(){var e,n,r;return $r(this,function(i){switch(i.label){case 0:return e=ST(t),[4,wT()];case 1:return n=i.sent(),[4,(r=n.transaction(vT,"readwrite")).objectStore(vT).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}})})}function ET(t,e){return Jr(this,void 0,void 0,function(){var n,r,i,o,a,s;return $r(this,function(u){switch(u.label){case 0:return n=ST(t),[4,wT()];case 1:return r=u.sent(),i=r.transaction(vT,"readwrite"),[4,(o=i.objectStore(vT)).get(n)];case 2:return a=u.sent(),(s=e(a))===a?[2,s]:void 0!==s?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),[2,s]}})})}function ST(t){return t.appName+"!"+t.appId}function CT(t){return Jr(this,void 0,void 0,function(){var e,n,r;return $r(this,function(i){switch(i.label){case 0:return[4,ET(t,function(n){var r=function(t){var e=t||{fid:function(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=(n=t,btoa(String.fromCharCode.apply(String,ei(n))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);return dT.test(e)?e:yT}catch(t){return yT}var n}(),registrationStatus:0};return NT(e)?{fid:e.fid,registrationStatus:0}:e}(n),i=function(t,e){if(0!==e.registrationStatus)return 1===e.registrationStatus?{installationEntry:e,registrationPromise:function(t){return Jr(this,void 0,void 0,function(){var e;return $r(this,function(n){switch(n.label){case 0:return[4,IT(t)];case 1:e=n.sent(),n.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,pT(100)];case 3:return n.sent(),[4,IT(t)];case 4:return e=n.sent(),[3,2];case 5:if(0===e.registrationStatus)throw iT.create("create-installation-failed");return[2,e]}})})}(t)}:{installationEntry:e};if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(iT.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=function(t,e){return Jr(this,void 0,void 0,function(){var n,r;return $r(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,function(t,n){var r=e.fid;return Jr(this,void 0,void 0,function(){var e,n,i,o,a,s;return $r(this,function(u){switch(u.label){case 0:return e=sT(t),n=lT(t),i={fid:r,authVersion:tT,appId:t.appId,sdkVersion:Z_},o={method:"POST",headers:n,body:JSON.stringify(i)},[4,fT(function(){return fetch(e,o)})];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,{fid:(s=u.sent()).fid||r,registrationStatus:2,refreshToken:s.refreshToken,authToken:uT(s.authToken)}];case 3:return[4,cT("Create Installation",a)];case 4:throw u.sent()}})})}(t)];case 1:return n=i.sent(),[2,_T(t,n)];case 2:return oT(r=i.sent())&&409===r.serverCode?[4,TT(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,_T(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}})})}(t,n);return{installationEntry:n,registrationPromise:r}}(t,r);return e=i.registrationPromise,i.installationEntry})];case 1:return(n=i.sent()).fid!==yT?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}})})}function IT(t){return ET(t,function(t){if(!t)throw iT.create("installation-not-found");return NT(t)?{fid:t.fid,registrationStatus:0}:t})}function NT(t){return 1===t.registrationStatus&&t.registrationTime+$_<Date.now()}function AT(t){return Jr(this,void 0,void 0,function(){var e,n,r;return $r(this,function(i){switch(i.label){case 0:return[4,ET(t,function(n){if(!DT(n))throw iT.create("not-registered");var r,i,o,a,s,u=n.authToken;if(2!==(o=u).requestStatus||(a=o,(s=Date.now())<a.creationTime||a.creationTime+a.expiresIn<s+nT)){if(1===u.requestStatus)return e=function(t){return Jr(this,void 0,void 0,function(){var e,n;return $r(this,function(r){switch(r.label){case 0:return[4,kT(t)];case 1:e=r.sent(),r.label=2;case 2:return 1!==e.authToken.requestStatus?[3,5]:[4,pT(100)];case 3:return r.sent(),[4,kT(t)];case 4:return e=r.sent(),[3,2];case 5:if(0===(n=e.authToken).requestStatus)throw iT.create("generate-token-failed");return[2,n]}})})}(t),n;if(!navigator.onLine)throw iT.create("app-offline");var c=(r=n,i={requestStatus:1,requestTime:Date.now()},Xr({},r,{authToken:i}));return e=function(t,e){return Jr(this,void 0,void 0,function(){var n,r,i;return $r(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,function(t,e){return Jr(this,void 0,void 0,function(){var n,r,i,o,a;return $r(this,function(s){switch(s.label){case 0:return u=t,c=e.fid,n=sT(u)+"/"+c+"/authTokens:generate",r=hT(t,e),i={installation:{sdkVersion:Z_}},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,fT(function(){return fetch(n,o)})];case 1:return(a=s.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,uT(s.sent())];case 3:return[4,cT("Generate Auth Token",a)];case 4:throw s.sent()}var u,c})})}(t,e)];case 1:return n=o.sent(),i=Xr({},e,{authToken:n}),[4,_T(t,i)];case 2:return o.sent(),[2,n];case 3:return!oT(r=o.sent())||401!==r.serverCode&&404!==r.serverCode?[3,5]:[4,TT(t)];case 4:return o.sent(),[3,7];case 5:return i=Xr({},e,{authToken:{requestStatus:0}}),[4,_T(t,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}})})}(t,c),c}return n})];case 1:return n=i.sent(),e?[4,e]:[3,3];case 2:return r=i.sent(),[3,4];case 3:r=n.authToken,i.label=4;case 4:return[2,r.token]}})})}function kT(t){return ET(t,function(t){if(!DT(t))throw iT.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+$_<Date.now()?Xr({},t,{authToken:{requestStatus:0}}):t})}function DT(t){return void 0!==t&&2===t.registrationStatus}$i.INTERNAL.registerService("installations",function(t){return aT(t),{app:t,getId:function(){return function(t){return Jr(this,void 0,void 0,function(){var e,n,r,i;return $r(this,function(o){switch(o.label){case 0:return[4,CT(e=aT(t))];case 1:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)&&i.catch(function(){}),2===r.registrationStatus&&AT(e).catch(function(){}),[2,r.fid]}})})}(t)},getToken:function(){return function(t){return Jr(this,void 0,void 0,function(){var e;return $r(this,function(n){switch(n.label){case 0:return[4,function(t){return Jr(this,void 0,void 0,function(){var e,n,r;return $r(this,function(i){switch(i.label){case 0:return[4,CT(t)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?[4,r]:[3,3];case 2:return i.sent(),[3,4];case 3:if(2!==n.registrationStatus)throw iT.create("create-installation-failed");i.label=4;case 4:return[2]}})})}(e=aT(t))];case 1:return n.sent(),[2,AT(e)]}})})}(t)},delete:function(){return function(t){return Jr(this,void 0,void 0,function(){var e,n;return $r(this,function(r){switch(r.label){case 0:return[4,ET(e=aT(t),function(t){if(!t||0!==t.registrationStatus)return t})];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw iT.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw iT.create("app-offline");case 3:return[4,function(t,e){return Jr(this,void 0,void 0,function(){var n,r,i,o;return $r(this,function(a){switch(a.label){case 0:return s=t,u=e.fid,n=sT(s)+"/"+u,r=hT(t,e),i={method:"DELETE",headers:r},[4,fT(function(){return fetch(n,i)})];case 1:return(o=a.sent()).ok?[3,3]:[4,cT("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}var s,u})})}(e,n)];case 4:return r.sent(),[4,TT(e)];case 5:r.sent(),r.label=6;case 6:return[2]}})})}(t)}}});var RT,xT,OT,PT,MT,LT,FT,UT="0.2.11",qT="FB-PERF-TRACE-MEASURE",VT="@firebase/performance/config",jT="@firebase/performance/configexpire",BT="Performance",WT=((RT={})["trace started"]="Trace {$traceName} was started before.",RT["trace stopped"]="Trace {$traceName} is not running.",RT["no window"]="Window is not available.",RT["no app id"]="App id is not available.",RT["no project id"]="Project id is not available.",RT["no api key"]="Api key is not available.",RT["invalid cc log"]="Attempted to queue invalid cc event",RT["FB not default"]="Performance can only start when Firebase app instance is the default one.",RT["RC response not ok"]="RC response is not ok",RT),KT=new gi("performance",BT,WT),QT=function(){function t(t){if(!t)throw KT.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return!!(fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver(function(t){var n,r;try{for(var i=Zr(t.getEntries()),o=i.next();!o.done;o=i.next()){var a=o.value;e(a)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===xT&&(xT=new t(OT)),xT},t}(),HT=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw KT.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw KT.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw KT.create("no api key");return t},t.getInstance=function(){return void 0===PT&&(PT=new t),PT},t}();function GT(){return MT}function zT(){switch(QT.getInstance().document.visibilityState){case"visible":return LT.VISIBLE;case"hidden":return LT.HIDDEN;case"prerender":return LT.PRERENDER;default:return LT.UNKNOWN}}(FT=LT||(LT={}))[FT.UNKNOWN=0]="UNKNOWN",FT[FT.VISIBLE=1]="VISIBLE",FT[FT.HIDDEN=2]="HIDDEN",FT[FT.PRERENDER=3]="PRERENDER",FT[FT.UNLOADED=4]="UNLOADED";var YT=new Bi(BT);YT.logLevel=Pi.INFO;var XT="0.0.1",JT={loggingEnabled:!0},$T="FIREBASE_INSTALLATIONS_AUTH";var ZT="Could not fetch config, will use default configs";function tE(t){if(!t)return t;var e=HT.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=JT.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=eE(e.tracesSamplingRate),e.logNetworkAfterSampling=eE(e.networkRequestsSamplingRate),t}function eE(t){return Math.random()<=t}var nE,rE=1;function iE(){var t;return rE=2,nE=nE||(t=QT.getInstance().document,new Promise(function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})).then(function(){return(t=HT.getInstance().firebaseAppInstance.installations().getId()).then(function(t){MT=t}),t;var t}).then(function(t){return function(t){var e,n,r=function(){var t=QT.getInstance().localStorage,e=t.getItem(jT);if(e&&Number(e)>Date.now()){var n=t.getItem(VT);if(n)try{return JSON.parse(n)}catch(t){return}}}();return r?(tE(r),Promise.resolve()):(e=t,(n=HT.getInstance().firebaseAppInstance.installations().getToken(),n.then(function(t){}),n).then(function(t){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+HT.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+HT.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:$T+" "+t},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:HT.getInstance().getAppId(),app_version:UT,sdk_version:XT})});return fetch(r).then(function(t){if(t.ok)return t.json();throw KT.create("RC response not ok")})}).catch(function(){YT.info(ZT)})).then(function(t){return tE(t)}).then(function(t){return function(t){if(t){var e=QT.getInstance().localStorage;e.setItem(VT,JSON.stringify(t)),e.setItem(jT,String(Date.now()+60*HT.getInstance().configTimeToLive*60*1e3))}}(t)},function(){})}(t)}).then(function(){return oE()},function(){return oE()})}function oE(){rE=3}var aE,sE=3,uE=[];function cE(){if(aE)return aE;var t,e=(t=fE,function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];!function(t){if(!t.eventTime||!t.message)throw KT.create("invalid cc log");uE=ei(uE,[t])}({message:t.apply(void 0,ei(r)),eventTime:Date.now()})});return(aE=new Bi("@firebase/performance/cc")).logHandler=e,aE}function lE(t){var e=HT.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&QT.getInstance().requiredApisAvailable()&&(t.isAuto&&zT()!==LT.VISIBLE||e.loggingEnabled&&e.logTraceAfterSampling&&(3===rE?hE(t):iE().then(function(){return hE(t)},function(){return hE(t)})))}function hE(t){GT()&&setTimeout(function(){return cE().log(t,1)},0)}function fE(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:pE(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=dE(t.counters));var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=dE(n));var r={application_info:pE(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function pE(){return{google_app_id:HT.getInstance().getAppId(),app_instance_id:GT(),web_app_info:{sdk_version:UT,page_url:QT.getInstance().getUrl(),service_worker_status:(t=QT.getInstance().navigator,"serviceWorker"in t?t.serviceWorker.controller?2:3:1),visibility_state:zT(),effective_connection_type:function(){var t=QT.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0};var t}function dE(t){return Object.keys(t).map(function(e){return{key:e,value:t[e]}})}!function t(e){setTimeout(function(){if(0!==sE){if(!uE.length)return t(1e4);var e=ei(uE);uE=[];var n=e.map(function(t){return{source_extension_json:t.message,event_time_ms:String(t.eventTime)}}),r={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:HT.getInstance().logSource,log_event:n};fetch(HT.getInstance().logEndPointUrl,{method:"POST",body:JSON.stringify(r)}).then(function(t){return t.ok||YT.info("Call to Firebase backend failed."),t.json()}).then(function(e){var n=Number(e.next_request_wait_millis),r=isNaN(n)?1e4:Math.max(1e4,n);sE=3,t(r)}).catch(function(){uE=ei(e,uE),sE--,YT.info("Tries left: "+sE+"."),t(1e4)})}},e)}(5500);var yE=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=QT.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||qT+"-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw KT.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw KT.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),lE(this)},t.prototype.record=function(t,e,n){var r,i;if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Xr({},n.attributes)),n&&n.metrics)try{for(var o=Zr(Object.keys(n.metrics)),a=o.next();!a.done;a=o.next()){var s=a.value;isNaN(Number(n.metrics[s]))||(this.counters[s]=Number(Math.floor(n.metrics[s])))}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}lE(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]&&(this.counters[t]=0),this.counters[t]+=e},t.prototype.putMetric=function(t,e){this.counters[t]=e},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){this.customAttributes[t]=e},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return Xr({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=QT.getInstance().getUrl();if(i){var o=new t("_wt_"+i,!0),a=Math.floor(1e3*QT.getInstance().getTimeOrigin());if(o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.incrementMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.incrementMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.incrementMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var s=n.find(function(t){return"first-paint"===t.name});s&&s.startTime&&o.incrementMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find(function(t){return"first-contentful-paint"===t.name});u&&u.startTime&&o.incrementMetric("_fcp",Math.floor(1e3*u.startTime)),r&&o.incrementMetric("_fid",Math.floor(1e3*r))}lE(o)}},t.createUserTimingTrace=function(e){lE(new t(e,!1,e))},t}();function mE(t){var e=t;if(e&&void 0!==e.responseStart){var n,r,i=QT.getInstance().getTimeOrigin(),o=Math.floor(1e3*(e.startTime+i)),a=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,s=Math.floor(1e3*(e.responseEnd-e.startTime)),u={url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:o,timeToResponseInitiatedUs:a,timeToResponseCompletedUs:s};n=u,(r=HT.getInstance()).instrumentationEnabled&&n.url!==r.logEndPointUrl.split("?")[0]&&r.loggingEnabled&&r.logNetworkAfterSampling&&setTimeout(function(){return cE().log(n,0)},0)}}var gE=5e3;function vE(){GT()&&(setTimeout(function(){return function(){var t=QT.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout(function(){yE.createOobTrace(e,n),r=void 0},gE);t.onFirstInputDelay(function(t){r&&(clearTimeout(r),yE.createOobTrace(e,n,t))})}else yE.createOobTrace(e,n)}()},0),setTimeout(function(){return function(){var t,e,n=QT.getInstance(),r=n.getEntriesByType("resource");try{for(var i=Zr(r),o=i.next();!o.done;o=i.next()){mE(o.value)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}n.setupObserver("resource",mE)}()},0),setTimeout(function(){return function(){var t,e,n=QT.getInstance(),r=n.getEntriesByType("measure");try{for(var i=Zr(r),o=i.next();!o.done;o=i.next()){bE(o.value)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}n.setupObserver("measure",bE)}()},0))}function bE(t){var e=t.name;e.substring(0,qT.length)!==qT&&yE.createUserTimingTrace(e)}var wE,_E=function(){function t(t){this.app=t,QT.getInstance().requiredApisAvailable()?iE().then(vE,vE):YT.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled.")}return t.prototype.trace=function(t){return new yE(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return HT.getInstance().instrumentationEnabled},set:function(t){HT.getInstance().instrumentationEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return HT.getInstance().dataCollectionEnabled},set:function(t){HT.getInstance().dataCollectionEnabled=t},enumerable:!0,configurable:!0}),t}();return wE=window,OT=wE,$i.INTERNAL.registerService("performance",function(t){if("[DEFAULT]"!==t.name)throw KT.create("FB not default");return HT.getInstance().firebaseAppInstance=t,new _E(t)},{}),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),$i});const CATALOG_URL="https://languagelearningwithnetflix.com/catalogue.html",INSTRUCTIONS_URL="https://languagelearningwithnetflix.com/instructions.html";function doUpdateStuff(){$.getJSON("https://languagelearningwithnetflix.com/v.json",function(t){if(t.webstoreVersion){var e=t.webstoreVersion.split("."),n=chrome.runtime.getManifest().version.split(".");if(3===e.length)if(3===n.length){var r=100*parseInt(e[0])+10*parseInt(e[1])+parseInt(e[2]),i=100*parseInt(n[0])+10*parseInt(n[1])+parseInt(n[2]);r>i?(console.log(`BACKGROUND: Requesting update from ${i} to ${r}`),chrome.runtime.requestUpdateCheck(function(t){"update_available"==t?console.log("BACKGROUND: update_available"):"no_update"==t?console.log("BACKGROUND: no_update"):"throttled"==t&&console.log("BACKGROUND: throttled")})):console.log(`BACKGROUND: No update. Local version: ${i} Remote version: ${r}`)}else console.log("BACKGROUND: Local version string badly formatted.");else console.log("BACKGROUND: Remote version string badly formatted.")}})}chrome.browserAction.onClicked.addListener(function(t){chrome.storage.sync.set({lingoActive:!0});chrome.tabs.create({url:"https://languagelearningwithnetflix.com/catalogue.html"})}),chrome.runtime.onInstalled.addListener(function(t){"install"==t.reason&&chrome.tabs.create({url:INSTRUCTIONS_URL},function(t){})}),chrome.runtime.onStartup.addListener(function(t){}),chrome.runtime.onUpdateAvailable.addListener(function(t){console.log("BACKGROUND: onUpdateAvailable, updating to version "+t.version),chrome.runtime.reload()}),chrome.extension.onMessage.addListener(function(t,e){t.topic.startsWith("bg_")&&(console.log(`Received message: ${t.topic} ${t.functionName?"function: "+t.functionName:""}`),t.senderId=e.tab.id),"checkForUpdate"==t.topic&&doUpdateStuff(),"bg_cloudFunctionRPC_request"==t.topic&&cloudFunctionRPC(t)}),chrome.runtime.onInstalled.addListener(function(t){if("install"==t.reason)chrome.cookies.get({url:"https://languagelearningwithnetflix.com",name:"ref"},function(t){var e;e=t?t.value:"none",console.log("referer: "+e),chrome.storage.sync.set({referer:e},function(){})});else if("update"==t.reason){var e=chrome.runtime.getManifest().version;console.log("Updated from "+t.previousVersion+" to "+e+"!")}});var config={apiKey:"AIzaSyC457-gC0a0NqwoWhSrEp-VFgcVnBrKy3w",authDomain:"nlle-b0128.firebaseapp.com",databaseURL:"https://nlle-b0128.firebaseio.com",projectId:"nlle-b0128",storageBucket:"nlle-b0128.appspot.com",messagingSenderId:"177081285221",appId:"1:177081285221:web:17ceca2562a38d7b"};const app=firebase.initializeApp(config);let provider=new firebase.auth.GoogleAuthProvider;var functions=firebase.functions(),CF={};CF.g2=firebase.functions().httpsCallable("g2"),CF.g10=firebase.functions().httpsCallable("g10"),CF.getNLP=firebase.functions().httpsCallable("getNLP"),CF.getItems=firebase.functions().httpsCallable("getItems"),CF.saveItem=firebase.functions().httpsCallable("saveItem"),CF.setItemPracticeInterval=firebase.functions().httpsCallable("setItemPracticeInterval"),CF.removeItem=firebase.functions().httpsCallable("removeItem"),CF.dictLookup=firebase.functions().httpsCallable("dictLookup"),CF.getUserData=firebase.functions().httpsCallable("getUserData"),CF.googleSubscriptionActive=firebase.functions().httpsCallable("googleSubscriptionActive"),CF.googleSubscriptionNotActive=firebase.functions().httpsCallable("googleSubscriptionNotActive"),CF.activateTrial=firebase.functions().httpsCallable("activateTrial"),CF.bm=firebase.functions().httpsCallable("bm");var logout_list=[];function cloudFunctionRPC(t){t.functionName in CF&&(0,CF[t.functionName])(t.data).then(function(e){sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success",data:e.data},callIdentifier:t.callIdentifier})}).catch(function(e){sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"failure",data:e},callIdentifier:t.callIdentifier})});if("login"===t.functionName){logout_list.includes(t.senderId)||logout_list.push(t.senderId);var e=firebase.auth().currentUser;if(e)return void sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success",data:{loginSuccess:!0,email:e.email}},callIdentifier:t.callIdentifier});t.data?firebase.auth().signInWithPopup(provider).then(e=>{console.log("Firebase login succeeded."),sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success",data:{loginSuccess:!0,email:e.user.email}},callIdentifier:t.callIdentifier})}).catch(function(e){var n=e.code;e.message,e.email,e.credential;"auth/account-exists-with-different-credential"===n?console.log("Email already associated with another account."):console.error(e),sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success",data:{loginSuccess:!1,error:`firebase.auth().signInWithPopup(credential) errored. error.code: ${e.code}, error.message: ${e.message}`}},callIdentifier:t.callIdentifier})}):sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success",data:{loginSuccess:!1,error:"silent login fail."}},callIdentifier:t.callIdentifier})}"signOut"===t.functionName&&(firebase.auth().signOut(),sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success"},callIdentifier:t.callIdentifier})),"showOnUpdateMessage"===t.functionName&&chrome.storage.sync.get({showOnUpdateMessage:!1},function(e){chrome.storage.sync.set({showOnUpdateMessage:!1},function(){}),sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success",data:{showOnUpdateMessage:e.showOnUpdateMessage}},callIdentifier:t.callIdentifier})}),"chromeStorageSet"===t.functionName&&chrome.storage.sync.set(t.data,function(){sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success",data:{}},callIdentifier:t.callIdentifier})}),"chromeStorageGet"===t.functionName&&chrome.storage.sync.get(t.data,function(e){sendToContent(t.senderId,{topic:"ps_cloudFunctionRPC_response",result:{status:"success",data:e},callIdentifier:t.callIdentifier})})}var userData={};function sendToContent(t,e){if(!e.topic)throw"No message topic!";chrome.tabs.sendMessage(t,e)}firebase.auth().onAuthStateChanged(function(t){if(t);else{console.log("Sending logout messages.");for(let t of logout_list)sendToContent(t,{topic:"ps_logout"});logout_list=[]}}),function(){var t=this,e=function(e,n){var r,i=e.split("."),o=window||t;i[0]in o||!o.execScript||o.execScript("var "+i[0]);for(;i.length&&(r=i.shift());)i.length||void 0===n?o=o[r]?o[r]:o[r]={}:o[r]=n},n=function(t){var e=chrome.runtime.connect("nmmhkkegccagdldgiimedpiccmgmieda",{}),n=!1;e.onMessage.addListener(function(e){n=!0,"response"in e&&!("errorType"in e.response)?t.success&&t.success(e):t.failure&&t.failure(e)}),e.onDisconnect.addListener(function(){!n&&t.failure&&t.failure({request:{},response:{errorType:"INTERNAL_SERVER_ERROR"}})}),e.postMessage(t)};e("google.payments.inapp.buy",function(t){t.method="buy",n(t)}),e("google.payments.inapp.consumePurchase",function(t){t.method="consumePurchase",n(t)}),e("google.payments.inapp.getPurchases",function(t){t.method="getPurchases",n(t)}),e("google.payments.inapp.getSkuDetails",function(t){t.method="getSkuDetails",n(t)})}();